exports.id=148,exports.ids=[148],exports.modules={2163:e=>{"use strict";var t=function(){this.clear()};t.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"],t.prototype.clear=function(){this._sent={},this._lines=[]},t.prototype.set=function(e,t){if(void 0!==t){e=this._strip(e),t=this._strip(t);var i=e.toLowerCase();(!this._sent.hasOwnProperty(i)||this.ALLOWED_DUPLICATES.indexOf(i)>=0)&&(this._sent[i]=!0,this._lines.push(e+": "+t+"\r\n"))}},t.prototype.toString=function(){return this._lines.join("")},t.prototype._strip=function(e){return e.toString().replace(/^ */,"").replace(/ *$/,"")},e.exports=t},3589:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},4015:(e,t,i)=>{"use strict";var n=i(7984).Buffer,r=i(55511),s=i(28354),o=i(63630),a=i(37196),l=i(47413),h=i(33595),c=function(e,t,i){if(a.apply(this,arguments),this._extensions=new o,this._stage=0,this._masking=this._options.masking,this._protocols=this._options.protocols||[],this._requireMasking=this._options.requireMasking,this._pingCallbacks={},"string"==typeof this._protocols&&(this._protocols=this._protocols.split(/ *, */)),this._request){var n=this._request.headers["sec-websocket-protocol"],r=this._protocols;void 0!==n&&("string"==typeof n&&(n=n.split(/ *, */)),this.protocol=n.filter(function(e){return r.indexOf(e)>=0})[0]),this.version="hybi-"+c.VERSION}};s.inherits(c,a),c.VERSION="13",c.mask=function(e,t,i){if(!t||0===t.length)return e;i=i||0;for(var n=0,r=e.length-i;n<r;n++)e[i+n]=e[i+n]^t[n%4];return e},c.generateAccept=function(e){var t=r.createHash("sha1");return t.update(e+c.GUID),t.digest("base64")},c.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";var u={FIN:128,MASK:128,RSV1:64,RSV2:32,RSV3:16,OPCODE:15,LENGTH:127,OPCODES:{continuation:0,text:1,binary:2,close:8,ping:9,pong:10},OPCODE_CODES:[0,1,2,8,9,10],MESSAGE_OPCODES:[0,1,2],OPENING_OPCODES:[1,2],ERRORS:{normal_closure:1e3,going_away:1001,protocol_error:1002,unacceptable:1003,encoding_error:1007,policy_violation:1008,too_large:1009,extension_error:1010,unexpected_condition:1011},ERROR_CODES:[1e3,1001,1002,1003,1007,1008,1009,1010,1011],DEFAULT_ERROR_CODE:1e3,MIN_RESERVED_ERROR:3e3,MAX_RESERVED_ERROR:4999,UTF8_MATCH:/^([\x00-\x7F]|[\xC2-\xDF][\x80-\xBF]|\xE0[\xA0-\xBF][\x80-\xBF]|[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}|\xED[\x80-\x9F][\x80-\xBF]|\xF0[\x90-\xBF][\x80-\xBF]{2}|[\xF1-\xF3][\x80-\xBF]{3}|\xF4[\x80-\x8F][\x80-\xBF]{2})*$/,addExtension:function(e){return this._extensions.add(e),!0},parse:function(e){this._reader.put(e);for(var t=!0;t;)switch(this._stage){case 0:(t=this._reader.read(1))&&this._parseOpcode(t[0]);break;case 1:(t=this._reader.read(1))&&this._parseLength(t[0]);break;case 2:(t=this._reader.read(this._frame.lengthBytes))&&this._parseExtendedLength(t);break;case 3:(t=this._reader.read(4))&&(this._stage=4,this._frame.maskingKey=t);break;case 4:(t=this._reader.read(this._frame.length))&&(this._stage=0,this._emitFrame(t));break;default:t=null}},text:function(e){return!(this.readyState>1)&&this.frame(e,"text")},binary:function(e){return!(this.readyState>1)&&this.frame(e,"binary")},ping:function(e,t){return!(this.readyState>1)&&(e=e||"",t&&(this._pingCallbacks[e]=t),this.frame(e,"ping"))},pong:function(e){return!(this.readyState>1)&&(e=e||"",this.frame(e,"pong"))},close:function(e,t){return(e=e||"",t=t||this.ERRORS.normal_closure,this.readyState<=0)?(this.readyState=3,this.emit("close",new a.CloseEvent(t,e)),!0):1===this.readyState&&(this.readyState=2,this._extensions.close(function(){this.frame(e,"close",t)},this),!0)},frame:function(e,t,i){if(this.readyState<=0)return this._queue([e,t,i]);if(this.readyState>2)return!1;e instanceof Array&&(e=n.from(e)),"number"==typeof e&&(e=e.toString());var s,o,a=new h,c="string"==typeof e;a.rsv1=a.rsv2=a.rsv3=!1,a.opcode=this.OPCODES[t||(c?"text":"binary")],s=c?n.from(e,"utf8"):e,i&&(o=s,(s=n.allocUnsafe(2+o.length)).writeUInt16BE(i,0),o.copy(s,2)),a.data=s;var u=function(e){var t=new l;t.final=!0,t.rsv1=e.rsv1,t.rsv2=e.rsv2,t.rsv3=e.rsv3,t.opcode=e.opcode,t.masked=!!this._masking,t.length=e.data.length,t.payload=e.data,t.masked&&(t.maskingKey=r.randomBytes(4)),this._sendFrame(t)};return this.MESSAGE_OPCODES.indexOf(a.opcode)>=0?this._extensions.processOutgoingMessage(a,function(e,t){if(e)return this._fail("extension_error",e.message);u.call(this,t)},this):u.call(this,a),!0},_sendFrame:function(e){var t=e.length,i=t<=125?2:t<=65535?4:10,r=i+4*!!e.masked,s=n.allocUnsafe(r+t),o=e.masked?this.MASK:0;s[0]=(e.final?this.FIN:0)|(e.rsv1?this.RSV1:0)|(e.rsv2?this.RSV2:0)|(e.rsv3?this.RSV3:0)|e.opcode,t<=125?s[1]=o|t:t<=65535?(s[1]=126|o,s.writeUInt16BE(t,2)):(s[1]=127|o,s.writeUInt32BE(Math.floor(t/0x100000000),2),s.writeUInt32BE(t%0x100000000,6)),e.payload.copy(s,r),e.masked&&(e.maskingKey.copy(s,i),c.mask(s,e.maskingKey,r)),this._write(s)},_handshakeResponse:function(){var e=this._request.headers["sec-websocket-key"],t=this._request.headers["sec-websocket-version"];if(t!==c.VERSION)throw Error("Unsupported WebSocket version: "+t);if("string"!=typeof e)throw Error("Missing handshake request header: Sec-WebSocket-Key");this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Accept",c.generateAccept(e)),this.protocol&&this._headers.set("Sec-WebSocket-Protocol",this.protocol);var i=this._extensions.generateResponse(this._request.headers["sec-websocket-extensions"]);i&&this._headers.set("Sec-WebSocket-Extensions",i);var r=["HTTP/1.1 101 Switching Protocols",this._headers.toString(),""];return n.from(r.join("\r\n"),"utf8")},_shutdown:function(e,t,i){delete this._frame,delete this._message,this._stage=5;var n=1===this.readyState;this.readyState=2,this._extensions.close(function(){n&&this.frame(t,"close",e),this.readyState=3,i&&this.emit("error",Error(t)),this.emit("close",new a.CloseEvent(e,t))},this)},_fail:function(e,t){this.readyState>1||this._shutdown(this.ERRORS[e],t,!0)},_parseOpcode:function(e){var t=[this.RSV1,this.RSV2,this.RSV3].map(function(t){return(e&t)===t}),i=this._frame=new l;return(i.final=(e&this.FIN)===this.FIN,i.rsv1=t[0],i.rsv2=t[1],i.rsv3=t[2],i.opcode=e&this.OPCODE,this._stage=1,this._extensions.validFrameRsv(i))?0>this.OPCODE_CODES.indexOf(i.opcode)?this._fail("protocol_error","Unrecognized frame opcode: "+i.opcode):0>this.MESSAGE_OPCODES.indexOf(i.opcode)&&!i.final?this._fail("protocol_error","Received fragmented control frame: opcode = "+i.opcode):this._message&&this.OPENING_OPCODES.indexOf(i.opcode)>=0?this._fail("protocol_error","Received new data frame but previous continuous frame is unfinished"):void 0:this._fail("protocol_error","One or more reserved bits are on: reserved1 = "+ +!!i.rsv1+", reserved2 = "+ +!!i.rsv2+", reserved3 = "+ +!!i.rsv3)},_parseLength:function(e){var t=this._frame;if(t.masked=(e&this.MASK)===this.MASK,t.length=e&this.LENGTH,t.length>=0&&t.length<=125){if(this._stage=t.masked?3:4,!this._checkFrameLength())return}else this._stage=2,t.lengthBytes=126===t.length?2:8;if(this._requireMasking&&!t.masked)return this._fail("unacceptable","Received unmasked frame but masking is required")},_parseExtendedLength:function(e){var t=this._frame;if(t.length=this._readUInt(e),this._stage=t.masked?3:4,0>this.MESSAGE_OPCODES.indexOf(t.opcode)&&t.length>125)return this._fail("protocol_error","Received control frame having too long payload: "+t.length);if(!this._checkFrameLength())return},_checkFrameLength:function(){return!((this._message?this._message.length:0)+this._frame.length>this._maxLength)||(this._fail("too_large","WebSocket frame length too large"),!1)},_emitFrame:function(e){var t,i,n,r,s,o=this._frame,l=o.payload=c.mask(e,o.maskingKey),u=o.opcode;if(delete this._frame,u===this.OPCODES.continuation){if(!this._message)return this._fail("protocol_error","Received unexpected continuation frame");this._message.pushFrame(o)}if((u===this.OPCODES.text||u===this.OPCODES.binary)&&(this._message=new h,this._message.pushFrame(o)),o.final&&this.MESSAGE_OPCODES.indexOf(u)>=0)return this._emitMessage(this._message);u===this.OPCODES.close&&(i=l.length>=2?l.readUInt16BE(0):null,n=l.length>2?this._encode(l.slice(2)):null,0!==l.length&&!(null!==i&&i>=this.MIN_RESERVED_ERROR&&i<=this.MAX_RESERVED_ERROR)&&0>this.ERROR_CODES.indexOf(i)&&(i=this.ERRORS.protocol_error),(l.length>125||l.length>2&&!n)&&(i=this.ERRORS.protocol_error),this._shutdown(i||this.DEFAULT_ERROR_CODE,n||"")),u===this.OPCODES.ping&&(this.frame(l,"pong"),this.emit("ping",new a.PingEvent(l.toString()))),u===this.OPCODES.pong&&(s=(r=this._pingCallbacks)[t=this._encode(l)],delete r[t],s&&s(),this.emit("pong",new a.PongEvent(l.toString())))},_emitMessage:function(e){var e=this._message;e.read(),delete this._message,this._extensions.processIncomingMessage(e,function(e,t){if(e)return this._fail("extension_error",e.message);var i=t.data;if(t.opcode===this.OPCODES.text&&(i=this._encode(i)),null===i)return this._fail("encoding_error","Could not decode a text frame as UTF-8");this.emit("message",new a.MessageEvent(i))},this)},_encode:function(e){try{var t=e.toString("binary",0,e.length);if(!this.UTF8_MATCH.test(t))return null}catch(e){}return e.toString("utf8",0,e.length)},_readUInt:function(e){return 2===e.length?e.readUInt16BE(0):0x100000000*e.readUInt32BE(0)+e.readUInt32BE(4)}};for(var d in u)c.prototype[d]=u[d];e.exports=c},7723:(e,t,i)=>{"use strict";var n=i(7984).Buffer,r=function(){this._queue=[],this._queueSize=0,this._offset=0};r.prototype.put=function(e){e&&0!==e.length&&(n.isBuffer(e)||(e=n.from(e)),this._queue.push(e),this._queueSize+=e.length)},r.prototype.read=function(e){if(e>this._queueSize)return null;if(0===e)return n.alloc(0);this._queueSize-=e;var t,i,r=this._queue,s=e,o=r[0];if(o.length>=e)if(o.length===e)return r.shift();else return i=o.slice(0,e),r[0]=o.slice(e),i;for(var a=0,l=r.length;a<l&&!(s<r[a].length);a++)s-=r[a].length;return t=r.splice(0,a),s>0&&r.length>0&&(t.push(r[0].slice(0,s)),r[0]=r[0].slice(s)),n.concat(t,e)},r.prototype.eachByte=function(e,t){for(var i,n,r;this._queue.length>0;){for(n=(i=this._queue[0]).length;this._offset<n;)r=this._offset,this._offset+=1,e.call(t,i[r]);this._offset=0,this._queue.shift()}},e.exports=r},7984:(e,t,i)=>{var n=i(79428),r=n.Buffer;function s(e,t){for(var i in e)t[i]=e[i]}function o(e,t,i){return r(e,t,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=o),o.prototype=Object.create(r.prototype),s(r,o),o.from=function(e,t,i){if("number"==typeof e)throw TypeError("Argument must not be a number");return r(e,t,i)},o.alloc=function(e,t,i){if("number"!=typeof e)throw TypeError("Argument must be a number");var n=r(e);return void 0!==t?"string"==typeof i?n.fill(t,i):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return r(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n.SlowBuffer(e)}},11860:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},12941:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]])},19621:(e,t,i)=>{"use strict";var n=i(93841),r=i(70376),s=function(e){this._cells=e.map(function(e){return new n(e)}),this._stopped={incoming:!1,outgoing:!1}};s.prototype.processIncomingMessage=function(e,t,i){this._stopped.incoming||this._loop("incoming",this._cells.length-1,-1,-1,e,t,i)},s.prototype.processOutgoingMessage=function(e,t,i){this._stopped.outgoing||this._loop("outgoing",0,this._cells.length,1,e,t,i)},s.prototype.close=function(e,t){this._stopped={incoming:!0,outgoing:!0};var i=this._cells.map(function(e){return e.close()});e&&r.all(i).then(function(){e.call(t)})},s.prototype._loop=function(e,t,i,n,r,s,o){for(var a=this._cells,l=a.length,h=this;l--;)a[l].pending(e);var c=function(t,r,l){if(t===i)return s.call(o,r,l);a[t][e](r,l,function(i,r){i&&(h._stopped[e]=!0),c(t+n,i,r)})};c(t,null,r)},e.exports=s},22915:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]])},23518:(e,t)=>{function i(e){if(void 0!==e&&e!==i.REQUEST&&e!==i.RESPONSE)throw Error("type must be REQUEST or RESPONSE");void 0===e||this.initialize(e),this.maxHeaderSize=i.maxHeaderSize}t.e=i,i.prototype.initialize=function(e,t){if(e!==i.REQUEST&&e!==i.RESPONSE)throw Error("type must be REQUEST or RESPONSE");this.type=e,this.state=e+"_LINE",this.info={headers:[],upgrade:!1},this.trailers=[],this.line="",this.isChunked=!1,this.connection="",this.headerSize=0,this.body_bytes=null,this.isUserCall=!1,this.hadError=!1},i.encoding="ascii",i.maxHeaderSize=81920,i.REQUEST="REQUEST",i.RESPONSE="RESPONSE";var n=i.kOnHeaders=1,r=i.kOnHeadersComplete=2,s=i.kOnBody=3,o=i.kOnMessageComplete=4;i.prototype[n]=i.prototype[r]=i.prototype[s]=i.prototype[o]=function(){};var a=!0;Object.defineProperty(i,"kOnExecute",{get:function(){return a=!1,99}});var l=i.methods=["DELETE","GET","HEAD","POST","PUT","CONNECT","OPTIONS","TRACE","COPY","LOCK","MKCOL","MOVE","PROPFIND","PROPPATCH","SEARCH","UNLOCK","BIND","REBIND","UNBIND","ACL","REPORT","MKACTIVITY","CHECKOUT","MERGE","M-SEARCH","NOTIFY","SUBSCRIBE","UNSUBSCRIBE","PATCH","PURGE","MKCALENDAR","LINK","UNLINK","SOURCE"],h=l.indexOf("CONNECT");i.prototype.reinitialize=i,i.prototype.close=i.prototype.pause=i.prototype.resume=i.prototype.remove=i.prototype.free=function(){},i.prototype._compatMode0_11=!1,i.prototype.getAsyncId=function(){return 0};var c={REQUEST_LINE:!0,RESPONSE_LINE:!0,HEADER:!0};i.prototype.execute=function(e,t,n){if(!(this instanceof i))throw TypeError("not a HTTPParser");t=t||0,n="number"==typeof n?n:e.length,this.chunk=e,this.offset=t;var r=this.end=t+n;try{for(;this.offset<r&&!this[this.state](););}catch(e){if(this.isUserCall)throw e;return this.hadError=!0,e}return(this.chunk=null,n=this.offset-t,c[this.state]&&(this.headerSize+=n,this.headerSize>(this.maxHeaderSize||i.maxHeaderSize)))?Error("max header size exceeded"):n};var u={REQUEST_LINE:!0,RESPONSE_LINE:!0,BODY_RAW:!0};i.prototype.finish=function(){if(!this.hadError){if(!u[this.state])return Error("invalid state for EOF");"BODY_RAW"===this.state&&this.userCall()(this[o]())}},i.prototype.consume=i.prototype.unconsume=i.prototype.getCurrentBuffer=function(){},i.prototype.userCall=function(){this.isUserCall=!0;var e=this;return function(t){return e.isUserCall=!1,t}},i.prototype.nextRequest=function(){this.userCall()(this[o]()),this.reinitialize(this.type)},i.prototype.consumeLine=function(){for(var e=this.end,t=this.chunk,n=this.offset;n<e;n++)if(10===t[n]){var r=this.line+t.toString(i.encoding,this.offset,n);return"\r"===r.charAt(r.length-1)&&(r=r.substr(0,r.length-1)),this.line="",this.offset=n+1,r}this.line+=t.toString(i.encoding,this.offset,this.end),this.offset=this.end};var d=/^([^: \t]+):[ \t]*((?:.*[^ \t])|)/,p=/^[ \t]+(.*[^ \t])/;i.prototype.parseHeader=function(e,t){if(-1!==e.indexOf("\r"))throw g("HPE_LF_EXPECTED");var i=d.exec(e),n=i&&i[1];if(n)t.push(n),t.push(i[2]);else{var r=p.exec(e);r&&t.length&&(t[t.length-1]&&(t[t.length-1]+=" "),t[t.length-1]+=r[1])}};var f=/^([A-Z-]+) ([^ ]+) HTTP\/(\d)\.(\d)$/;i.prototype.REQUEST_LINE=function(){var e=this.consumeLine();if(e){var t=f.exec(e);if(null===t)throw g("HPE_INVALID_CONSTANT");if(this.info.method=this._compatMode0_11?t[1]:l.indexOf(t[1]),-1===this.info.method)throw Error("invalid request method");this.info.url=t[2],this.info.versionMajor=+t[3],this.info.versionMinor=+t[4],this.body_bytes=0,this.state="HEADER"}};var _=/^HTTP\/(\d)\.(\d) (\d{3}) ?(.*)$/;function g(e){var t=Error("Parse Error");return t.code=e,t}i.prototype.RESPONSE_LINE=function(){var e=this.consumeLine();if(e){var t=_.exec(e);if(null===t)throw g("HPE_INVALID_CONSTANT");this.info.versionMajor=+t[1],this.info.versionMinor=+t[2];var i=this.info.statusCode=+t[3];this.info.statusMessage=t[4],((i/100|0)==1||204===i||304===i)&&(this.body_bytes=0),this.state="HEADER"}},i.prototype.shouldKeepAlive=function(){if(this.info.versionMajor>0&&this.info.versionMinor>0){if(-1!==this.connection.indexOf("close"))return!1}else if(-1===this.connection.indexOf("keep-alive"))return!1;return null!==this.body_bytes||!!this.isChunked},i.prototype.HEADER=function(){var e=this.consumeLine();if(void 0!==e){var t=this.info;if(e)this.parseHeader(e,t.headers);else{for(var n,s,o=t.headers,l=!1,c=!1,u=0;u<o.length;u+=2)switch(o[u].toLowerCase()){case"transfer-encoding":this.isChunked="chunked"===o[u+1].toLowerCase();break;case"content-length":if(n=+o[u+1],l){if(n!==this.body_bytes)throw g("HPE_UNEXPECTED_CONTENT_LENGTH")}else l=!0,this.body_bytes=n;break;case"connection":this.connection+=o[u+1].toLowerCase();break;case"upgrade":c=!0}if(this.isChunked&&l&&(l=!1,this.body_bytes=null),c&&-1!=this.connection.indexOf("upgrade")?t.upgrade=this.type===i.REQUEST||101===t.statusCode:t.upgrade=t.method===h,this.isChunked&&t.upgrade&&(this.isChunked=!1),t.shouldKeepAlive=this.shouldKeepAlive(),2===(s=a?this.userCall()(this[r](t)):this.userCall()(this[r](t.versionMajor,t.versionMinor,t.headers,t.method,t.url,t.statusCode,t.statusMessage,t.upgrade,t.shouldKeepAlive))))return this.nextRequest(),!0;if(this.isChunked&&!s)this.state="BODY_CHUNKHEAD";else{if(s||0===this.body_bytes)return this.nextRequest(),t.upgrade;null===this.body_bytes?this.state="BODY_RAW":this.state="BODY_SIZED"}}}},i.prototype.BODY_CHUNKHEAD=function(){var e=this.consumeLine();void 0!==e&&(this.body_bytes=parseInt(e,16),this.body_bytes?this.state="BODY_CHUNK":this.state="BODY_CHUNKTRAILERS")},i.prototype.BODY_CHUNK=function(){var e=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[s](this.chunk.slice(this.offset,this.offset+e),0,e)),this.offset+=e,this.body_bytes-=e,this.body_bytes||(this.state="BODY_CHUNKEMPTYLINE")},i.prototype.BODY_CHUNKEMPTYLINE=function(){var e=this.consumeLine();if(void 0!==e){if(""!==e)throw Error("Expected empty line");this.state="BODY_CHUNKHEAD"}},i.prototype.BODY_CHUNKTRAILERS=function(){var e=this.consumeLine();void 0!==e&&(e?this.parseHeader(e,this.trailers):(this.trailers.length&&this.userCall()(this[n](this.trailers,"")),this.nextRequest()))},i.prototype.BODY_RAW=function(){this.userCall()(this[s](this.chunk.slice(this.offset,this.end),0,this.end-this.offset)),this.offset=this.end},i.prototype.BODY_SIZED=function(){var e=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[s](this.chunk.slice(this.offset,this.offset+e),0,e)),this.offset+=e,this.body_bytes-=e,this.body_bytes||this.nextRequest()},["Headers","HeadersComplete","Body","MessageComplete"].forEach(function(e){var t=i["kOn"+e];Object.defineProperty(i.prototype,"on"+e,{get:function(){return this[t]},set:function(e){return this._compatMode0_11=!0,h="CONNECT",this[t]=e}})})},27728:(e,t,i)=>{"use strict";let n,r;i.d(t,{MF:()=>F,j6:()=>P,xZ:()=>x,om:()=>A,Sx:()=>H,Dk:()=>q,Wp:()=>U,KO:()=>W});var s=i(35545),o=i(88060),a=i(52122);let l=(e,t)=>t.some(t=>e instanceof t),h=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,p=new WeakMap,f={get(e,t,i){if(e instanceof IDBTransaction){if("done"===t)return c.get(e);if("objectStoreNames"===t)return e.objectStoreNames||u.get(e);if("store"===t)return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return _(e[t])},set:(e,t,i)=>(e[t]=i,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function _(e){if(e instanceof IDBRequest){let t=new Promise((t,i)=>{let n=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(_(e.result)),n()},s=()=>{i(e.error),n()};e.addEventListener("success",r),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&h.set(t,e)}).catch(()=>{}),p.set(t,e),t}if(d.has(e))return d.get(e);let t=function(e){if("function"==typeof e)return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(g(this),t),_(h.get(this))}:function(...t){return _(e.apply(g(this),t))}:function(t,...i){let n=e.call(g(this),t,...i);return u.set(n,t.sort?t.sort():[t]),_(n)};return(e instanceof IDBTransaction&&function(e){if(c.has(e))return;let t=new Promise((t,i)=>{let n=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),n()},s=()=>{i(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)});c.set(e,t)}(e),l(e,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,f):e}(e);return t!==e&&(d.set(e,t),p.set(t,e)),t}let g=e=>p.get(e),m=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],y=new Map;function E(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(y.get(t))return y.get(t);let i=t.replace(/FromIndex$/,""),n=t!==i,r=v.includes(i);if(!(i in(n?IDBIndex:IDBObjectStore).prototype)||!(r||m.includes(i)))return;let s=async function(e,...t){let s=this.transaction(e,r?"readwrite":"readonly"),o=s.store;return n&&(o=o.index(t.shift())),(await Promise.all([o[i](...t),r&&s.done]))[0]};return y.set(t,s),s}f=(e=>({...e,get:(t,i,n)=>E(t,i)||e.get(t,i,n),has:(t,i)=>!!E(t,i)||e.has(t,i)}))(f);class C{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(!function(e){let t=e.getComponent();return(null==t?void 0:t.type)==="VERSION"}(e))return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let w="@firebase/app",b="0.13.1",I=new o.Vy("@firebase/app"),S="[DEFAULT]",T={[w]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},k=new Map,N=new Map,R=new Map;function O(e,t){try{e.container.addComponent(t)}catch(i){I.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,i)}}function A(e){let t=e.name;if(R.has(t))return I.debug(`There were multiple attempts to register component ${t}.`),!1;for(let i of(R.set(t,e),k.values()))O(i,e);for(let t of N.values())O(t,e);return!0}function P(e,t){let i=e.container.getProvider("heartbeat").getImmediate({optional:!0});return i&&i.triggerHeartbeat(),e.container.getProvider(t)}function x(e){return null!=e&&void 0!==e.settings}let D=new a.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class L{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new s.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw D.create("app-deleted",{appName:this._name})}}function M(e,t){let i=(0,a.u)(e.split(".")[1]);if(null===i)return void console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`);if(void 0===JSON.parse(i).exp)return void console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`);let n=1e3*JSON.parse(i).exp;n-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}let F="11.9.0";function U(e,t={}){let i=e;"object"!=typeof t&&(t={name:t});let n=Object.assign({name:S,automaticDataCollectionEnabled:!0},t),r=n.name;if("string"!=typeof r||!r)throw D.create("bad-app-name",{appName:String(r)});if(i||(i=(0,a.T9)()),!i)throw D.create("no-options");let o=k.get(r);if(o)if((0,a.bD)(i,o.options)&&(0,a.bD)(n,o.config))return o;else throw D.create("duplicate-app",{appName:r});let l=new s.h1(r);for(let e of R.values())l.addComponent(e);let h=new L(i,n,l);return k.set(r,h),h}function H(e=S){let t=k.get(e);if(!t&&e===S&&(0,a.T9)())return U();if(!t)throw D.create("no-app",{appName:e});return t}function q(){return Array.from(k.values())}async function B(e){let t=!1,i=e.name;k.has(i)?(t=!0,k.delete(i)):N.has(i)&&0>=e.decRefCount()&&(N.delete(i),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function W(e,t,i){var n;let r=null!=(n=T[e])?n:e;i&&(r+=`-${i}`);let o=r.match(/\s|\//),a=t.match(/\s|\//);if(o||a){let e=[`Unable to register library "${r}" with version "${t}":`];o&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),I.warn(e.join(" "));return}A(new s.uA(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}let j="firebase-heartbeat-store",V=null;function z(){return V||(V=(function(e,t,{blocked:i,upgrade:n,blocking:r,terminated:s}={}){let o=indexedDB.open(e,1),a=_(o);return n&&o.addEventListener("upgradeneeded",e=>{n(_(o.result),e.oldVersion,e.newVersion,_(o.transaction),e)}),i&&o.addEventListener("blocked",e=>i(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a})("firebase-heartbeat-database",0,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(j)}catch(e){console.warn(e)}}}).catch(e=>{throw D.create("idb-open",{originalErrorMessage:e.message})})),V}async function K(e){try{let t=(await z()).transaction(j),i=await t.objectStore(j).get(G(e));return await t.done,i}catch(e){if(e instanceof a.g)I.warn(e.message);else{let t=D.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});I.warn(t.message)}}}async function $(e,t){try{let i=(await z()).transaction(j,"readwrite"),n=i.objectStore(j);await n.put(t,G(e)),await i.done}catch(e){if(e instanceof a.g)I.warn(e.message);else{let t=D.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});I.warn(t.message)}}}function G(e){return`${e.name}!${e.options.appId}`}class Y{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new J(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Q();if((null==(e=this._heartbeatsCache)?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null==(t=this._heartbeatsCache)?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(e=>e.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:i}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let t=0,i=e[0].date;for(let n=1;n<e.length;n++)e[n].date<i&&(i=e[n].date,t=n);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){I.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let t=Q(),{heartbeatsToSend:i,unsentEntries:n}=function(e,t=1024){let i=[],n=e.slice();for(let r of e){let e=i.find(e=>e.agent===r.agent);if(e){if(e.dates.push(r.date),Z(i)>t){e.dates.pop();break}}else if(i.push({agent:r.agent,dates:[r.date]}),Z(i)>t){i.pop();break}n=n.slice(1)}return{heartbeatsToSend:i,unsentEntries:n}}(this._heartbeatsCache.heartbeats),r=(0,a.Uj)(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return I.warn(e),""}}}function Q(){return new Date().toISOString().substring(0,10)}class J{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,a.zW)()&&(0,a.eX)().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await K(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return $(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return $(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}}}function Z(e){return(0,a.Uj)(JSON.stringify({version:2,heartbeats:e})).length}A(new s.uA("platform-logger",e=>new C(e),"PRIVATE")),A(new s.uA("heartbeat",e=>new Y(e),"PRIVATE")),W(w,b,""),W(w,b,"esm2017"),W("fire-js","")},29409:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("chart-no-axes-column",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]])},33595:(e,t,i)=>{"use strict";var n=i(7984).Buffer,r=function(){this.rsv1=!1,this.rsv2=!1,this.rsv3=!1,this.opcode=null,this.length=0,this._chunks=[]},s={read:function(){return this.data=this.data||n.concat(this._chunks,this.length)},pushFrame:function(e){this.rsv1=this.rsv1||e.rsv1,this.rsv2=this.rsv2||e.rsv2,this.rsv3=this.rsv3||e.rsv3,null===this.opcode&&(this.opcode=e.opcode),this._chunks.push(e.payload),this.length+=e.length}};for(var o in s)r.prototype[o]=s[o];e.exports=r},34364:(e,t,i)=>{"use strict";var n=i(28354),r=i(91645),s=i(34631),o=i(79551),a=i(74366),l=i(92139);i(64492);var h={"http:":80,"https:":443,"ws:":80,"wss:":443},c=["https:","wss:"],u=function(e,t,i){i=i||{},this.url=e,this._driver=a.client(this.url,{maxLength:i.maxLength,protocols:t}),["open","error"].forEach(function(e){this._driver.on(e,function(){v.headers=v._driver.headers,v.statusCode=v._driver.statusCode})},this);var n=i.proxy||{},u=o.parse(n.origin||this.url),d=u.port||h[u.protocol],p=c.indexOf(u.protocol)>=0,f=function(){v._onConnect()},_=i.net||{},g=i.tls||{},m=n.origin?n.tls||{}:g,v=this;_.host=m.host=u.hostname,_.port=m.port=d,g.ca=g.ca||i.ca,m.servername=m.servername||u.hostname,this._stream=p?s.connect(m,f):r.connect(_,f),n.origin&&this._configureProxy(n,g),l.call(this,i)};n.inherits(u,l),u.prototype._onConnect=function(){(this._proxy||this._driver).start()},u.prototype._configureProxy=function(e,t){var i,n=o.parse(this.url),r=c.indexOf(n.protocol)>=0,a=this;if(this._proxy=this._driver.proxy(e.origin),e.headers)for(i in e.headers)this._proxy.setHeader(i,e.headers[i]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(r){var e={socket:a._stream,servername:n.hostname};for(i in t)e[i]=t[i];a._stream=s.connect(e),a._configureStream()}a._driver.io.pipe(a._stream),a._stream.pipe(a._driver.io),a._driver.start()}),this._proxy.on("error",function(e){a._driver.emit("error",e)})},e.exports=u},35545:(e,t,i)=>{"use strict";i.d(t,{h1:()=>a,uA:()=>r});var n=i(52122);class r{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let s="[DEFAULT]";class o{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new n.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&e.resolve(i)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let i=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),n=null!=(t=null==e?void 0:e.optional)&&t;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(e){if(n)return null;throw e}if(n)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:s})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:i});t.resolve(e)}catch(e){}}}}clearInstance(e=s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=s){return this.instances.has(e)}getOptions(e=s){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let n=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[e,t]of this.instancesDeferred.entries())i===this.normalizeInstanceIdentifier(e)&&t.resolve(n);return n}onInit(e,t){var i;let n=this.normalizeInstanceIdentifier(t),r=null!=(i=this.onInitCallbacks.get(n))?i:new Set;r.add(e),this.onInitCallbacks.set(n,r);let s=this.instances.get(n);return s&&e(s,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let n of i)try{n(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){var i;let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e)===s?void 0:i,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}return n||null}normalizeInstanceIdentifier(e=s){return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},37030:(e,t,i)=>{"use strict";var n=i(64492);e.exports={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(e,t,i){this.on(e,t)},removeEventListener:function(e,t,i){this.removeListener(e,t)},dispatchEvent:function(e){e.target=e.currentTarget=this,e.eventPhase=n.AT_TARGET,this["on"+e.type]&&this["on"+e.type](e),this.emit(e.type,e)}}},37196:(e,t,i)=>{"use strict";var n=i(7984).Buffer,r=i(94735).EventEmitter,s=i(28354),o=i(57427),a=i(2163),l=i(7723),h=function(e,t,i){r.call(this),h.validateOptions(i||{},["maxLength","masking","requireMasking","protocols"]),this._request=e,this._reader=new l,this._options=i||{},this._maxLength=this._options.maxLength||this.MAX_LENGTH,this._headers=new a,this.__queue=[],this.readyState=0,this.url=t,this.io=new o.IO(this),this.messages=new o.Messages(this),this._bindEventListeners()};s.inherits(h,r),h.isWebSocket=function(e){var t=e.headers.connection||"",i=e.headers.upgrade||"";return"GET"===e.method&&t.toLowerCase().split(/ *, */).indexOf("upgrade")>=0&&"websocket"===i.toLowerCase()},h.validateOptions=function(e,t){for(var i in e)if(0>t.indexOf(i))throw Error("Unrecognized option: "+i)};var c={MAX_LENGTH:0x3ffffff,STATES:["connecting","open","closing","closed"],_bindEventListeners:function(){var e=this;this.messages.on("error",function(){}),this.on("message",function(t){var i=e.messages;i.readable&&i.emit("data",t.data)}),this.on("error",function(t){var i=e.messages;i.readable&&i.emit("error",t)}),this.on("close",function(){var t=e.messages;t.readable&&(t.readable=t.writable=!1,t.emit("end"))})},getState:function(){return this.STATES[this.readyState]||null},addExtension:function(e){return!1},setHeader:function(e,t){return!(this.readyState>0)&&(this._headers.set(e,t),!0)},start:function(){var e;if(0!==this.readyState)return!1;if(!h.isWebSocket(this._request))return this._failHandshake(Error("Not a WebSocket request"));try{e=this._handshakeResponse()}catch(e){return this._failHandshake(e)}return this._write(e),-1!==this._stage&&this._open(),!0},_failHandshake:function(e){var t=new a;return t.set("Content-Type","text/plain"),t.set("Content-Length",n.byteLength(e.message,"utf8")),t=["HTTP/1.1 400 Bad Request",t.toString(),e.message],this._write(n.from(t.join("\r\n"),"utf8")),this._fail("protocol_error",e.message),!1},text:function(e){return this.frame(e)},binary:function(e){return!1},ping:function(){return!1},pong:function(){return!1},close:function(e,t){return 1===this.readyState&&(this.readyState=3,this.emit("close",new h.CloseEvent(null,null)),!0)},_open:function(){this.readyState=1,this.__queue.forEach(function(e){this.frame.apply(this,e)},this),this.__queue=[],this.emit("open",new h.OpenEvent)},_queue:function(e){return this.__queue.push(e),!0},_write:function(e){var t=this.io;t.readable&&t.emit("data",e)},_fail:function(e,t){this.readyState=2,this.emit("error",Error(t)),this.close()}};for(var u in c)h.prototype[u]=c[u];h.ConnectEvent=function(){},h.OpenEvent=function(){},h.CloseEvent=function(e,t){this.code=e,this.reason=t},h.MessageEvent=function(e){this.data=e},h.PingEvent=function(e){this.data=e},h.PongEvent=function(e){this.data=e},e.exports=h},40083:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},41312:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},43082:(e,t,i)=>{"use strict";var n=i(7984).Buffer,r=i(37196),s=i(28354),o=function(e,t,i){r.apply(this,arguments),this._stage=0,this.version="hixie-75",this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("WebSocket-Origin",this._request.headers.origin),this._headers.set("WebSocket-Location",this.url)};s.inherits(o,r);var a={close:function(){return 3!==this.readyState&&(this.readyState=3,this.emit("close",new r.CloseEvent(null,null)),!0)},parse:function(e){this.readyState>1||(this._reader.put(e),this._reader.eachByte(function(e){var t;switch(this._stage){case -1:this._body.push(e),this._sendHandshakeBody();break;case 0:this._parseLeadingByte(e);break;case 1:if(this._length=(127&e)+128*this._length,this._closing&&0===this._length)return this.close();(128&e)!=128&&(0===this._length?this._stage=0:(this._skipped=0,this._stage=2));break;case 2:if(255===e)this._stage=0,t=n.from(this._buffer).toString("utf8",0,this._buffer.length),this.emit("message",new r.MessageEvent(t));else if(this._length)this._skipped+=1,this._skipped===this._length&&(this._stage=0);else if(this._buffer.push(e),this._buffer.length>this._maxLength)return this.close()}},this))},frame:function(e){if(0===this.readyState)return this._queue([e]);if(this.readyState>1)return!1;"string"!=typeof e&&(e=e.toString());var t=n.byteLength(e),i=n.allocUnsafe(t+2);return i[0]=0,i.write(e,1),i[i.length-1]=255,this._write(i),!0},_handshakeResponse:function(){var e=["HTTP/1.1 101 Web Socket Protocol Handshake",this._headers.toString(),""];return n.from(e.join("\r\n"),"utf8")},_parseLeadingByte:function(e){(128&e)==128?(this._length=0,this._stage=1):(delete this._length,delete this._skipped,this._buffer=[],this._stage=2)}};for(var l in a)o.prototype[l]=a[l];e.exports=o},47033:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},47413:e=>{"use strict";var t=function(){},i={final:!1,rsv1:!1,rsv2:!1,rsv3:!1,opcode:null,masked:!1,maskingKey:null,lengthBytes:1,length:0,payload:null};for(var n in i)t.prototype[n]=i[n];e.exports=t},49625:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},52122:(e,t,i)=>{"use strict";i.d(t,{cY:()=>w,FA:()=>U,g:()=>F,gz:()=>X,vA:()=>s,Hk:()=>o,K3:()=>h,u:()=>p,KA:()=>u,Uj:()=>d,gR:()=>z,Fy:()=>S,tD:()=>ee,A4:()=>f,bD:()=>function e(t,i){if(t===i)return!0;let n=Object.keys(t),r=Object.keys(i);for(let s of n){if(!r.includes(s))return!1;let n=t[s],o=i[s];if(Y(n)&&Y(o)){if(!e(n,o))return!1}else if(n!==o)return!1}for(let e of r)if(!n.includes(e))return!1;return!0},dI:()=>en,hp:()=>Z,T9:()=>C,Tj:()=>y,yU:()=>E,Ku:()=>eo,ZQ:()=>R,qc:()=>V,sr:()=>P,zJ:()=>b,c1:()=>A,Im:()=>$,zW:()=>L,jZ:()=>O,$g:()=>D,lV:()=>x,Cv:()=>j,$L:()=>q,kH:()=>G,gE:()=>I,Am:()=>Q,I9:()=>J,yw:()=>K,OE:()=>es,kj:()=>er,As:()=>B,P1:()=>N,eX:()=>M});let n=()=>void 0,r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},s=function(e,t){if(!e)throw o(t)},o=function(e){return Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},a=function(e){let t=[],i=0;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:((64512&r)==55296&&n+1<e.length&&(64512&e.charCodeAt(n+1))==56320?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++n)),t[i++]=r>>18|240,t[i++]=r>>12&63|128):t[i++]=r>>12|224,t[i++]=r>>6&63|128),t[i++]=63&r|128)}return t},l=function(e){let t=[],i=0,n=0;for(;i<e.length;){let r=e[i++];if(r<128)t[n++]=String.fromCharCode(r);else if(r>191&&r<224){let s=e[i++];t[n++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){let s=e[i++],o=((7&r)<<18|(63&s)<<12|(63&e[i++])<<6|63&e[i++])-65536;t[n++]=String.fromCharCode(55296+(o>>10)),t[n++]=String.fromCharCode(56320+(1023&o))}else{let s=e[i++],o=e[i++];t[n++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")},h={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let i=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let t=0;t<e.length;t+=3){let r=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,h=r>>2,c=(3&r)<<4|o>>4,u=(15&o)<<2|l>>6,d=63&l;!a&&(d=64,s||(u=64)),n.push(i[h],i[c],i[u],i[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):l(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let i=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let t=0;t<e.length;){let r=i[e.charAt(t++)],s=t<e.length?i[e.charAt(t)]:0,o=++t<e.length?i[e.charAt(t)]:64,a=++t<e.length?i[e.charAt(t)]:64;if(++t,null==r||null==s||null==o||null==a)throw new c;let l=r<<2|s>>4;if(n.push(l),64!==o){let e=s<<4&240|o>>2;if(n.push(e),64!==a){let e=o<<6&192|a;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let u=function(e){let t=a(e);return h.encodeByteArray(t,!0)},d=function(e){return u(e).replace(/\./g,"")},p=function(e){try{return h.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function f(e){return function e(t,i){if(!(i instanceof Object))return i;switch(i.constructor){case Date:return new Date(i.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return i}for(let n in i)i.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=e(t[n],i[n]));return t}(void 0,e)}let _=()=>(function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")})().__FIREBASE_DEFAULTS__,g=()=>{if("undefined"==typeof process||void 0===process.env)return;let e=process.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},m=()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&p(e[1]);return t&&JSON.parse(t)},v=()=>{try{return n()||_()||g()||m()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},y=e=>{var t,i;return null==(i=null==(t=v())?void 0:t.emulatorHosts)?void 0:i[e]},E=e=>{let t=y(e);if(!t)return;let i=t.lastIndexOf(":");if(i<=0||i+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let n=parseInt(t.substring(i+1),10);return"["===t[0]?[t.substring(1,i-1),n]:[t.substring(0,i),n]},C=()=>{var e;return null==(e=v())?void 0:e.config};class w{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,i))}}}function b(e){return e.endsWith(".cloudworkstations.dev")}async function I(e){return(await fetch(e,{credentials:"include"})).ok}function S(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let i=t||"demo-project",n=e.iat||0,r=e.sub||e.user_id;if(!r)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:n,exp:n+3600,auth_time:n,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(s)),""].join(".")}let T={},k=!1;function N(e,t){if("undefined"==typeof window||"undefined"==typeof document||!b(window.location.host)||T[e]===t||T[e]||k)return;function i(e){return`__firebase__banner__${e}`}T[e]=t;let n="__firebase__banner",r=function(){let e={prod:[],emulator:[]};for(let t of Object.keys(T))T[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){let e,t,s=(e=document.getElementById(n),t=!1,e||((e=document.createElement("div")).setAttribute("id",n),t=!0),{created:t,element:e}),o=i("text"),a=document.getElementById(o)||document.createElement("span"),l=i("learnmore"),h=document.getElementById(l)||document.createElement("a"),c=i("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(s.created){let e=s.element;e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center",h.setAttribute("id",l),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline";let t=function(){let e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{k=!0;let e=document.getElementById(n);e&&e.remove()},e}();u.setAttribute("width","24"),u.setAttribute("id",c),u.setAttribute("height","24"),u.setAttribute("viewBox","0 0 24 24"),u.setAttribute("fill","none"),u.style.marginLeft="-6px",e.append(u,a,h,t),document.body.appendChild(e)}r?(a.innerText="Preview backend disconnected.",u.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(u.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,a.innerText="Preview backend running in this workspace."),a.setAttribute("id",o)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function R(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function O(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(R())}function A(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function P(){let e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function x(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function D(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN}function L(){try{return"object"==typeof indexedDB}catch(e){return!1}}function M(){return new Promise((e,t)=>{try{let i=!0,n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),i||self.indexedDB.deleteDatabase(n),e(!0)},r.onupgradeneeded=()=>{i=!1},r.onerror=()=>{var e;t((null==(e=r.error)?void 0:e.message)||"")}}catch(e){t(e)}})}class F extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name="FirebaseError",Object.setPrototypeOf(this,F.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,U.prototype.create)}}class U{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){var i,n;let r=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],a=o?(i=o,n=r,i.replace(H,(e,t)=>{let i=n[t];return null!=i?String(i):`<${t}?>`})):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new F(s,l,r)}}let H=/\{\$([^}]+)}/g;function q(e){return JSON.parse(e)}function B(e){return JSON.stringify(e)}let W=function(e){let t={},i={},n={},r="";try{let s=e.split(".");t=q(p(s[0])||""),i=q(p(s[1])||""),r=s[2],n=i.d||{},delete i.d}catch(e){}return{header:t,claims:i,data:n,signature:r}},j=function(e){let t=W(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},V=function(e){let t=W(e).claims;return"object"==typeof t&&!0===t.admin};function z(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function K(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function $(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function G(e,t,i){let n={};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=t.call(i,e[r],r,e));return n}function Y(e){return null!==e&&"object"==typeof e}function Q(e){let t=[];for(let[i,n]of Object.entries(e))Array.isArray(n)?n.forEach(e=>{t.push(encodeURIComponent(i)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(i)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function J(e){let t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){let[i,n]=e.split("=");t[decodeURIComponent(i)]=decodeURIComponent(n)}}),t}function Z(e){let t=e.indexOf("?");if(!t)return"";let i=e.indexOf("#",t);return e.substring(t,i>0?i:void 0)}class X{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=0x67452301,this.chain_[1]=0xefcdab89,this.chain_[2]=0x98badcfe,this.chain_[3]=0x10325476,this.chain_[4]=0xc3d2e1f0,this.inbuf_=0,this.total_=0}compress_(e,t){let i,n;t||(t=0);let r=this.W_;if("string"==typeof e)for(let i=0;i<16;i++)r[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let i=0;i<16;i++)r[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){let t=r[e-3]^r[e-8]^r[e-14]^r[e-16];r[e]=t<<1|t>>>31}let s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(i=l^o&(a^l),n=0x5a827999):(i=o^a^l,n=0x6ed9eba1):e<60?(i=o&a|l&(o|a),n=0x8f1bbcdc):(i=o^a^l,n=0xca62c1d6);let t=(s<<5|s>>>27)+i+h+n+r[e]|0;h=l,l=a,a=o<<30|o>>>2,o=s,s=t}this.chain_[0]=this.chain_[0]+s|0,this.chain_[1]=this.chain_[1]+o|0,this.chain_[2]=this.chain_[2]+a|0,this.chain_[3]=this.chain_[3]+l|0,this.chain_[4]=this.chain_[4]+h|0}update(e,t){if(null==e)return;void 0===t&&(t=e.length);let i=t-this.blockSize,n=0,r=this.buf_,s=this.inbuf_;for(;n<t;){if(0===s)for(;n<=i;)this.compress_(e,n),n+=this.blockSize;if("string"==typeof e){for(;n<t;)if(r[s]=e.charCodeAt(n),++s,++n,s===this.blockSize){this.compress_(r),s=0;break}}else for(;n<t;)if(r[s]=e[n],++s,++n,s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){let e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let i=0;for(let t=0;t<5;t++)for(let n=24;n>=0;n-=8)e[i]=this.chain_[t]>>n&255,++i;return e}}function ee(e,t){let i=new et(e,t);return i.subscribe.bind(i)}class et{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let n;if(void 0===e&&void 0===t&&void 0===i)throw Error("Missing Observer.");void 0===(n=!function(e,t){if("object"!=typeof e||null===e)return!1;for(let i of t)if(i in e&&"function"==typeof e[i])return!0;return!1}(e,["next","error","complete"])?{next:e,error:t,complete:i}:e).next&&(n.next=ei),void 0===n.error&&(n.error=ei),void 0===n.complete&&(n.complete=ei);let r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(e){}}),this.observers.push(n),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ei(){}function en(e,t){return`${e} failed: ${t} argument `}let er=function(e){let t=[],i=0;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r>=55296&&r<=56319){let t=r-55296;s(++n<e.length,"Surrogate pair missing trail surrogate."),r=65536+(t<<10)+(e.charCodeAt(n)-56320)}r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128)}return t},es=function(e){let t=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);n<128?t++:n<2048?t+=2:n>=55296&&n<=56319?(t+=4,i++):t+=3}return t};function eo(e){return e&&e._delegate?e._delegate:e}r.NODE_CLIENT=!0},54482:(e,t,i)=>{"use strict";var n=i(28354),r=i(71392),s=i(37196),o=i(43082),a=i(83991),l=i(4015),h=function(e){s.call(this,null,null,e),this._http=new r("request")};n.inherits(h,s);var c={EVENTS:["open","message","error","close","ping","pong"],_bindEventListeners:function(){this.messages.on("error",function(){}),this.on("error",function(){})},parse:function(e){if(this._delegate)return this._delegate.parse(e);if(this._http.parse(e),this._http.isComplete()){this.method=this._http.method,this.url=this._http.url,this.headers=this._http.headers,this.body=this._http.body;var t=this;this._delegate=h.http(this,this._options),this._delegate.messages=this.messages,this._delegate.io=this.io,this._open(),this.EVENTS.forEach(function(e){this._delegate.on(e,function(i){t.emit(e,i)})},this),this.protocol=this._delegate.protocol,this.version=this._delegate.version,this.parse(this._http.body),this.emit("connect",new s.ConnectEvent)}},_open:function(){this.__queue.forEach(function(e){this._delegate[e[0]].apply(this._delegate,e[1])},this),this.__queue=[]}};for(var u in["addExtension","setHeader","start","frame","text","binary","ping","close"].forEach(function(e){c[e]=function(){return this._delegate?this._delegate[e].apply(this._delegate,arguments):(this.__queue.push([e,arguments]),!0)}}),c)h.prototype[u]=c[u];h.isSecureRequest=function(e){if(e.connection&&void 0!==e.connection.authorized||e.socket&&e.socket.secure)return!0;var t=e.headers;return!!t&&("on"===t.https||"on"===t["x-forwarded-ssl"]||"https"===t["x-forwarded-scheme"]||"https"===t["x-forwarded-proto"])},h.determineUrl=function(e){return(this.isSecureRequest(e)?"wss:":"ws:")+"//"+e.headers.host+e.url},h.http=function(e,t){void 0===(t=t||{}).requireMasking&&(t.requireMasking=!0);var i=e.headers,n=i["sec-websocket-version"],r=i["sec-websocket-key"],s=i["sec-websocket-key1"],h=i["sec-websocket-key2"],c=this.determineUrl(e);return n||r?new l(e,c,t):s||h?new a(e,c,t):new o(e,c,t)},e.exports=h},56858:(e,t,i)=>{"use strict";var n=i(27910).Stream,r=i(28354),s=i(74366),o=i(2163),a=i(92139),l=i(37030),h=i(64492),c=function(e,t,i){this.writable=!0,i=i||{},this._stream=t.socket,this._ping=i.ping||this.DEFAULT_PING,this._retry=i.retry||this.DEFAULT_RETRY;var n=s.isSecureRequest(e)?"https:":"http:";this.url=n+"//"+e.headers.host+e.url,this.lastEventId=e.headers["last-event-id"]||"",this.readyState=a.CONNECTING;var r=new o,l=this;if(i.headers)for(var h in i.headers)r.set(h,i.headers[h]);if(this._stream&&this._stream.writable){process.nextTick(function(){l._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var c="HTTP/1.1 200 OK\r\nContent-Type: text/event-stream\r\nCache-Control: no-cache, no-store\r\nConnection: close\r\n"+r.toString()+"\r\nretry: "+Math.floor(1e3*this._retry)+"\r\n\r\n";this._write(c),this._stream.on("drain",function(){l.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){l.ping()},1e3*this._ping)),["error","end"].forEach(function(e){l._stream.on(e,function(){l.close()})})}};r.inherits(c,n),c.isEventSource=function(e){return"GET"===e.method&&(e.headers.accept||"").split(/\s*,\s*/).indexOf("text/event-stream")>=0};var u={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(e){if(!this.writable)return!1;try{return this._stream.write(e,"utf8")}catch(e){return!1}},_open:function(){if(this.readyState===a.CONNECTING){this.readyState=a.OPEN;var e=new h("open");e.initEvent("open",!1,!1),this.dispatchEvent(e)}},write:function(e){return this.send(e)},end:function(e){void 0!==e&&this.write(e),this.close()},send:function(e,t){if(this.readyState>a.OPEN)return!1;e=String(e).replace(/(\r\n|\r|\n)/g,"$1data: ");var i="";return(t=t||{}).event&&(i+="event: "+t.event+"\r\n"),t.id&&(i+="id: "+t.id+"\r\n"),i+="data: "+e+"\r\n\r\n",this._write(i)},ping:function(){return this._write(":\r\n\r\n")},close:function(){if(this.readyState>a.OPEN)return!1;this.readyState=a.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var e=new h("close");return e.initEvent("close",!1,!1),this.dispatchEvent(e),!0}};for(var d in u)c.prototype[d]=u[d];for(var p in l)c.prototype[p]=l[p];e.exports=c},57155:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]])},57427:(e,t,i)=>{"use strict";var n=i(27910).Stream,r=i(28354),s=function(e){this.readable=this.writable=!0,this._paused=!1,this._driver=e};r.inherits(s,n),s.prototype.pause=function(){this._paused=!0,this._driver.messages._paused=!0},s.prototype.resume=function(){this._paused=!1,this.emit("drain");var e=this._driver.messages;e._paused=!1,e.emit("drain")},s.prototype.write=function(e){return!!this.writable&&(this._driver.parse(e),!this._paused)},s.prototype.end=function(e){if(this.writable){void 0!==e&&this.write(e),this.writable=!1;var t=this._driver.messages;t.readable&&(t.readable=t.writable=!1,t.emit("end"))}},s.prototype.destroy=function(){this.end()};var o=function(e){this.readable=this.writable=!0,this._paused=!1,this._driver=e};r.inherits(o,n),o.prototype.pause=function(){this._driver.io._paused=!0},o.prototype.resume=function(){this._driver.io._paused=!1,this._driver.io.emit("drain")},o.prototype.write=function(e){return!!this.writable&&("string"==typeof e?this._driver.text(e):this._driver.binary(e),!this._paused)},o.prototype.end=function(e){void 0!==e&&this.write(e)},o.prototype.destroy=function(){},t.IO=s,t.Messages=o},58869:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},62688:(e,t,i)=>{"use strict";i.d(t,{A:()=>u});var n=i(43210);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),o=e=>{let t=s(e);return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,i)=>!!e&&""!==e.trim()&&i.indexOf(e)===t).join(" ").trim(),l=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var h={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,n.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:r,className:s="",children:o,iconNode:c,...u},d)=>(0,n.createElement)("svg",{ref:d,...h,width:t,height:t,stroke:e,strokeWidth:r?24*Number(i)/Number(t):i,className:a("lucide",s),...!o&&!l(u)&&{"aria-hidden":"true"},...u},[...c.map(([e,t])=>(0,n.createElement)(e,t)),...Array.isArray(o)?o:[o]])),u=(e,t)=>{let i=(0,n.forwardRef)(({className:i,...s},l)=>(0,n.createElement)(c,{ref:l,iconNode:t,className:a(`lucide-${r(o(e))}`,`lucide-${e}`,i),...s}));return i.displayName=o(e),i}},63206:(e,t,i)=>{"use strict";var n=i(7984).Buffer,r=i(55511),s=i(79551),o=i(28354),a=i(71392),l=i(37196),h=i(4015),c=i(70513),u=function(e,t){this.version="hybi-"+h.VERSION,h.call(this,null,e,t),this.readyState=-1,this._key=u.generateKey(),this._accept=h.generateAccept(this._key),this._http=new a("response");var i=s.parse(this.url),r=i.auth&&n.from(i.auth,"utf8").toString("base64");if(0>this.VALID_PROTOCOLS.indexOf(i.protocol))throw Error(this.url+" is not a valid WebSocket URL");this._pathname=(i.pathname||"/")+(i.search||""),this._headers.set("Host",i.host),this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Key",this._key),this._headers.set("Sec-WebSocket-Version",h.VERSION),this._protocols.length>0&&this._headers.set("Sec-WebSocket-Protocol",this._protocols.join(", ")),r&&this._headers.set("Authorization","Basic "+r)};o.inherits(u,h),u.generateKey=function(){return r.randomBytes(16).toString("base64")};var d={VALID_PROTOCOLS:["ws:","wss:"],proxy:function(e,t){return new c(this,e,t)},start:function(){return -1===this.readyState&&(this._write(this._handshakeRequest()),this.readyState=0,!0)},parse:function(e){if(3!==this.readyState){if(this.readyState>0)return h.prototype.parse.call(this,e);this._http.parse(e),this._http.isComplete()&&(this._validateHandshake(),3!==this.readyState&&(this._open(),this.parse(this._http.body)))}},_handshakeRequest:function(){var e=this._extensions.generateOffer();e&&this._headers.set("Sec-WebSocket-Extensions",e);var t=["GET "+this._pathname+" HTTP/1.1",this._headers.toString(),""];return n.from(t.join("\r\n"),"utf8")},_failHandshake:function(e){e="Error during WebSocket handshake: "+e,this.readyState=3,this.emit("error",Error(e)),this.emit("close",new l.CloseEvent(this.ERRORS.protocol_error,e))},_validateHandshake:function(){if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this._http.error)return this._failHandshake(this._http.error.message);if(101!==this._http.statusCode)return this._failHandshake("Unexpected response code: "+this._http.statusCode);var e=this._http.headers,t=e.upgrade||"",i=e.connection||"",n=e["sec-websocket-accept"]||"",r=e["sec-websocket-protocol"]||"";if(""===t)return this._failHandshake("'Upgrade' header is missing");if("websocket"!==t.toLowerCase())return this._failHandshake("'Upgrade' header value is not 'WebSocket'");if(""===i)return this._failHandshake("'Connection' header is missing");if("upgrade"!==i.toLowerCase())return this._failHandshake("'Connection' header value is not 'Upgrade'");if(n!==this._accept)return this._failHandshake("Sec-WebSocket-Accept mismatch");if(this.protocol=null,""!==r)if(0>this._protocols.indexOf(r))return this._failHandshake("Sec-WebSocket-Protocol mismatch");else this.protocol=r;try{this._extensions.activate(this.headers["sec-websocket-extensions"])}catch(e){return this._failHandshake(e.message)}}};for(var p in d)u.prototype[p]=d[p];e.exports=u},63630:(e,t,i)=>{"use strict";var n=i(74279),r=i(19621),s=function(){this._rsv1=this._rsv2=this._rsv3=null,this._byName={},this._inOrder=[],this._sessions=[],this._index={}};s.MESSAGE_OPCODES=[1,2];var o={add:function(e){if("string"!=typeof e.name)throw TypeError("extension.name must be a string");if("permessage"!==e.type)throw TypeError('extension.type must be "permessage"');if("boolean"!=typeof e.rsv1)throw TypeError("extension.rsv1 must be true or false");if("boolean"!=typeof e.rsv2)throw TypeError("extension.rsv2 must be true or false");if("boolean"!=typeof e.rsv3)throw TypeError("extension.rsv3 must be true or false");if(this._byName.hasOwnProperty(e.name))throw TypeError('An extension with name "'+e.name+'" is already registered');this._byName[e.name]=e,this._inOrder.push(e)},generateOffer:function(){var e=[],t=[],i={};return this._inOrder.forEach(function(r){var s=r.createClientSession();if(s){var o=[r,s];e.push(o),i[r.name]=o;var a=s.generateOffer();(a=a?[].concat(a):[]).forEach(function(e){t.push(n.serializeParams(r.name,e))},this)}},this),this._sessions=e,this._index=i,t.length>0?t.join(", "):null},activate:function(e){var t=n.parseHeader(e),i=[];t.eachOffer(function(e,t){var r=this._index[e];if(!r)throw Error('Server sent an extension response for unknown extension "'+e+'"');var s=r[0],o=r[1],a=this._reserved(s);if(a)throw Error("Server sent two extension responses that use the RSV"+a[0]+' bit: "'+a[1]+'" and "'+s.name+'"');if(!0!==o.activate(t))throw Error("Server sent unacceptable extension parameters: "+n.serializeParams(e,t));this._reserve(s),i.push(r)},this),this._sessions=i,this._pipeline=new r(i)},generateResponse:function(e){var t=[],i=[],s=n.parseHeader(e);return this._inOrder.forEach(function(e){var r=s.byName(e.name);if(!(0===r.length||this._reserved(e))){var o=e.createServerSession(r);o&&(this._reserve(e),t.push([e,o]),i.push(n.serializeParams(e.name,o.generateResponse())))}},this),this._sessions=t,this._pipeline=new r(t),i.length>0?i.join(", "):null},validFrameRsv:function(e){var t,i={rsv1:!1,rsv2:!1,rsv3:!1};if(s.MESSAGE_OPCODES.indexOf(e.opcode)>=0)for(var n=0,r=this._sessions.length;n<r;n++)t=this._sessions[n][0],i.rsv1=i.rsv1||t.rsv1,i.rsv2=i.rsv2||t.rsv2,i.rsv3=i.rsv3||t.rsv3;return(i.rsv1||!e.rsv1)&&(i.rsv2||!e.rsv2)&&(i.rsv3||!e.rsv3)},processIncomingMessage:function(e,t,i){this._pipeline.processIncomingMessage(e,t,i)},processOutgoingMessage:function(e,t,i){this._pipeline.processOutgoingMessage(e,t,i)},close:function(e,t){if(!this._pipeline)return e.call(t);this._pipeline.close(e,t)},_reserve:function(e){this._rsv1=this._rsv1||e.rsv1&&e.name,this._rsv2=this._rsv2||e.rsv2&&e.name,this._rsv3=this._rsv3||e.rsv3&&e.name},_reserved:function(e){return this._rsv1&&e.rsv1?[1,this._rsv1]:this._rsv2&&e.rsv2?[2,this._rsv2]:!!this._rsv3&&!!e.rsv3&&[3,this._rsv3]}};for(var a in o)s.prototype[a]=o[a];e.exports=s},64492:e=>{"use strict";var t=function(e,t){for(var i in this.type=e,t)this[i]=t[i]};t.prototype.initEvent=function(e,t,i){this.type=e,this.bubbles=t,this.cancelable=i},t.prototype.stopPropagation=function(){},t.prototype.preventDefault=function(){},t.CAPTURING_PHASE=1,t.AT_TARGET=2,t.BUBBLING_PHASE=3,e.exports=t},67989:(e,t,i)=>{"use strict";i.d(t,{Dk:()=>n.Dk,Wp:()=>n.Wp});var n=i(27728);(0,n.KO)("firebase","11.9.1","app")},70092:(e,t,i)=>{"use strict";var n=i(28354),r=i(74366),s=i(92139),o=function(e,t,i,n,o){o=o||{},this._stream=t,this._driver=r.http(e,{maxLength:o.maxLength,protocols:n});var a=this;if(this._stream&&this._stream.writable){if(!this._stream.readable)return this._stream.end();var l=function(){a._stream.removeListener("data",l)};this._stream.on("data",l),s.call(this,o),process.nextTick(function(){a._driver.start(),a._driver.io.write(i)})}};n.inherits(o,s),o.isWebSocket=function(e){return r.isWebSocket(e)},o.validateOptions=function(e,t){r.validateOptions(e,t)},o.WebSocket=o,o.Client=i(34364),o.EventSource=i(56858),e.exports=o},70376:(e,t,i)=>{"use strict";var n=i(90380),r=function(){this._complete=!1,this._callbacks=new n(r.QUEUE_SIZE)};r.QUEUE_SIZE=4,r.all=function(e){var t=new r,i=e.length,n=i;for(0===i&&t.done();n--;)e[n].then(function(){0==(i-=1)&&t.done()});return t},r.prototype.then=function(e){this._complete?e():this._callbacks.push(e)},r.prototype.done=function(){this._complete=!0;for(var e,t=this._callbacks;e=t.shift();)e()},e.exports=r},70513:(e,t,i)=>{"use strict";var n=i(7984).Buffer,r=i(27910).Stream,s=i(79551),o=i(28354),a=i(37196),l=i(2163),h=i(71392),c={"ws:":80,"wss:":443},u=function(e,t,i){this._client=e,this._http=new h("response"),this._origin="object"==typeof e.url?e.url:s.parse(e.url),this._url="object"==typeof t?t:s.parse(t),this._options=i||{},this._state=0,this.readable=this.writable=!0,this._paused=!1,this._headers=new l,this._headers.set("Host",this._origin.host),this._headers.set("Connection","keep-alive"),this._headers.set("Proxy-Connection","keep-alive");var r=this._url.auth&&n.from(this._url.auth,"utf8").toString("base64");r&&this._headers.set("Proxy-Authorization","Basic "+r)};o.inherits(u,r);var d={setHeader:function(e,t){return 0===this._state&&(this._headers.set(e,t),!0)},start:function(){if(0!==this._state)return!1;this._state=1;var e=this._origin,t=e.port||c[e.protocol],i=["CONNECT "+e.hostname+":"+t+" HTTP/1.1",this._headers.toString(),""];return this.emit("data",n.from(i.join("\r\n"),"utf8")),!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.emit("drain")},write:function(e){if(!this.writable)return!1;if(this._http.parse(e),!this._http.isComplete())return!this._paused;if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,200===this.statusCode)this.emit("connect",new a.ConnectEvent);else{var t="Can't establish a connection to the server at "+this._origin.href;this.emit("error",Error(t))}return this.end(),!this._paused},end:function(e){this.writable&&(void 0!==e&&this.write(e),this.readable=this.writable=!1,this.emit("close"),this.emit("end"))},destroy:function(){this.end()}};for(var p in d)u.prototype[p]=d[p];e.exports=u},71392:(e,t,i)=>{"use strict";var n=i(23518).e,r=i(7984).Buffer,s={request:n.REQUEST||"request",response:n.RESPONSE||"response"},o=function(e){this._type=e,this._parser=new n(s[e]),this._complete=!1,this.headers={};var t=null,i=this;this._parser.onHeaderField=function(e,i,n){t=e.toString("utf8",i,i+n).toLowerCase()},this._parser.onHeaderValue=function(e,n,r){var s=e.toString("utf8",n,n+r);i.headers.hasOwnProperty(t)?i.headers[t]+=", "+s:i.headers[t]=s},this._parser.onHeadersComplete=this._parser[n.kOnHeadersComplete]=function(e,t,n,r,s,a){var l=arguments[0];if("object"==typeof l&&(r=l.method,s=l.url,a=l.statusCode,n=l.headers),i.method="number"==typeof r?o.METHODS[r]:r,i.statusCode=a,i.url=s,n){for(var h,c,u=0,d=n.length;u<d;u+=2)h=n[u].toLowerCase(),c=n[u+1],i.headers.hasOwnProperty(h)?i.headers[h]+=", "+c:i.headers[h]=c;i._complete=!0}}};o.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"BIND",17:"REBIND",18:"UNBIND",19:"ACL",20:"REPORT",21:"MKACTIVITY",22:"CHECKOUT",23:"MERGE",24:"M-SEARCH",25:"NOTIFY",26:"SUBSCRIBE",27:"UNSUBSCRIBE",28:"PATCH",29:"PURGE",30:"MKCALENDAR",31:"LINK",32:"UNLINK"};var a=process.version?process.version.match(/[0-9]+/g).map(function(e){return parseInt(e,10)}):[];0===a[0]&&12===a[1]&&(o.METHODS[16]="REPORT",o.METHODS[17]="MKACTIVITY",o.METHODS[18]="CHECKOUT",o.METHODS[19]="MERGE",o.METHODS[20]="M-SEARCH",o.METHODS[21]="NOTIFY",o.METHODS[22]="SUBSCRIBE",o.METHODS[23]="UNSUBSCRIBE",o.METHODS[24]="PATCH",o.METHODS[25]="PURGE"),o.prototype.isComplete=function(){return this._complete},o.prototype.parse=function(e){var t=this._parser.execute(e,0,e.length);if("number"!=typeof t){this.error=t,this._complete=!0;return}this._complete&&(this.body=t<e.length?e.slice(t):r.alloc(0))},e.exports=o},74279:e=>{"use strict";var t=/([!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+)/,i=/([^!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z])/g,n=RegExp(t.source+"(?:=(?:"+t.source+"|"+/"((?:\\[\x00-\x7f]|[^\x00-\x08\x0a-\x1f\x7f"\\])*)"/.source+"))?"),r=RegExp(t.source+"(?: *; *"+n.source+")*","g"),s=RegExp("^"+r.source+"(?: *, *"+r.source+")*$"),o=/^-?(0|[1-9][0-9]*)(\.[0-9]+)?$/,a=Object.prototype.hasOwnProperty,l=function(){this._byName={},this._inOrder=[]};l.prototype.push=function(e,t){a.call(this._byName,e)||(this._byName[e]=[]),this._byName[e].push(t),this._inOrder.push({name:e,params:t})},l.prototype.eachOffer=function(e,t){for(var i=this._inOrder,n=0,r=i.length;n<r;n++)e.call(t,i[n].name,i[n].params)},l.prototype.byName=function(e){return this._byName[e]||[]},l.prototype.toArray=function(){return this._inOrder.slice()},e.exports={parseHeader:function(e){var t=new l;if(""===e||void 0===e)return t;if(!s.test(e))throw SyntaxError("Invalid Sec-WebSocket-Extensions header: "+e);return e.match(r).forEach(function(e){var i=e.match(RegExp(n.source,"g")),r=i.shift(),s={};i.forEach(function(e){var t,i=e.match(n),r=i[1];t=void 0!==i[2]?i[2]:void 0===i[3]||i[3].replace(/\\/g,""),o.test(t)&&(t=parseFloat(t)),a.call(s,r)?(s[r]=[].concat(s[r]),s[r].push(t)):s[r]=t},this),t.push(r,s)},this),t},serializeParams:function(e,t){var n=[],r=function(e,t){t instanceof Array?t.forEach(function(t){r(e,t)}):!0===t?n.push(e):"number"==typeof t?n.push(e+"="+t):i.test(t)?n.push(e+'="'+t.replace(/"/g,'\\"')+'"'):n.push(e+"="+t)};for(var s in t)r(s,t[s]);return[e].concat(n).join("; ")}}},74366:(e,t,i)=>{"use strict";var n=i(37196),r=i(63206),s=i(54482);e.exports={client:function(e,t){return void 0===(t=t||{}).masking&&(t.masking=!0),new r(e,t)},server:function(e){return void 0===(e=e||{}).requireMasking&&(e.requireMasking=!0),new s(e)},http:function(){return s.http.apply(s,arguments)},isSecureRequest:function(e){return s.isSecureRequest(e)},isWebSocket:function(e){return n.isWebSocket(e)},validateOptions:function(e,t){n.validateOptions(e,t)}}},78272:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},78403:(e,t,i)=>{"use strict";i.d(t,{xI:()=>e2});var n=i(27728),r=i(52122);function s(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i}Object.create;Object.create;var o=("function"==typeof SuppressedError&&SuppressedError,i(35545)),a=i(88060);function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let h=new r.FA("auth","Firebase",l()),c=new a.Vy("@firebase/auth");function u(e,...t){c.logLevel<=a.$b.ERROR&&c.error(`Auth (${n.MF}): ${e}`,...t)}function d(e,...t){throw g(e,...t)}function p(e,...t){return g(e,...t)}function f(e,t,i){let n=Object.assign(Object.assign({},l()),{[t]:i});return new r.FA("auth","Firebase",n).create(t,{appName:e.name})}function _(e){return f(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function g(e,...t){if("string"!=typeof e){let i=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(i,...n)}return h.create(e,...t)}function m(e,t,...i){if(!e)throw g(t,...i)}function v(e){let t="INTERNAL ASSERTION FAILED: "+e;throw u(t),Error(t)}function y(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.protocol)||null}class E{constructor(e,t){this.shortDelay=e,this.longDelay=t,t>e||v("Short delay should be less than long delay!"),this.isMobile=(0,r.jZ)()||(0,r.lV)()}get(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===y()||"https:"===y()||(0,r.sr)()||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}class C{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void v("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void v("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void v("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let w={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},b=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],I=new E(3e4,6e4);function S(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function T(e,t,i,n,s={}){return k(e,s,async()=>{let s={},o={};n&&("GET"===t?o=n:s={body:JSON.stringify(n)});let a=(0,r.Am)(Object.assign({key:e.config.apiKey},o)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);let h=Object.assign({method:t,headers:l},s);return(0,r.c1)()||(h.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,r.zJ)(e.emulatorConfig.host)&&(h.credentials="include"),C.fetch()(await R(e,e.config.apiHost,i,a),h)})}async function k(e,t,i){e._canInitEmulator=!1;let n=Object.assign(Object.assign({},w),t);try{let t=new O(e),r=await Promise.race([i(),t.promise]);t.clearNetworkTimeout();let s=await r.json();if("needConfirmation"in s)throw A(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{let[t,i]=(r.ok?s.errorMessage:s.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw A(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw A(e,"email-already-in-use",s);if("USER_DISABLED"===t)throw A(e,"user-disabled",s);let o=n[t]||t.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw f(e,o,i);d(e,o)}}catch(t){if(t instanceof r.g)throw t;d(e,"network-request-failed",{message:String(t)})}}async function N(e,t,i,n,r={}){let s=await T(e,t,i,n,r);return"mfaPendingCredential"in s&&d(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function R(e,t,i,n){let r=`${t}${i}?${n}`,s=e.config.emulator?function(e,t){var i;i=e.emulator,i||v("Emulator should always be set here");let{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}(e.config,r):`${e.config.apiScheme}://${r}`;return b.includes(i)&&(await e._persistenceManagerAvailable,"COOKIE"===e._getPersistenceType())?e._getPersistence()._getFinalTarget(s).toString():s}class O{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(p(this.auth,"network-request-failed")),I.get())})}}function A(e,t,i){let n={appName:e.name};i.email&&(n.email=i.email),i.phoneNumber&&(n.phoneNumber=i.phoneNumber);let r=p(e,t,n);return r.customData._tokenResponse=i,r}function P(e){return void 0!==e&&void 0!==e.enterprise}class x{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)switch(t.enforcementState){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function D(e,t){return T(e,"GET","/v2/recaptchaConfig",S(e,t))}async function L(e,t){return T(e,"POST","/v1/accounts:delete",t)}async function M(e,t){return T(e,"POST","/v1/accounts:lookup",t)}function F(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function U(e,t=!1){let i=(0,r.Ku)(e),n=await i.getIdToken(t),s=q(n);m(s&&s.exp&&s.auth_time&&s.iat,i.auth,"internal-error");let o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:n,authTime:F(H(s.auth_time)),issuedAtTime:F(H(s.iat)),expirationTime:F(H(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function H(e){return 1e3*Number(e)}function q(e){let[t,i,n]=e.split(".");if(void 0===t||void 0===i||void 0===n)return u("JWT malformed, contained fewer than 3 sections"),null;try{let e=(0,r.u)(i);if(!e)return u("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return u("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function B(e){let t=q(e);return m(t,"internal-error"),m(void 0!==t.exp,"internal-error"),m(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function W(e,t,i=!1){if(i)return t;try{return await t}catch(t){throw t instanceof r.g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class j{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(!e)return this.errorBackoff=3e4,Math.max(0,(null!=(t=this.user.stsTokenManager.expirationTime)?t:0)-Date.now()-3e5);{let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(null==e?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class V{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=F(this.lastLoginAt),this.creationTime=F(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function z(e){var t,i,n;let r=e.auth,s=await e.getIdToken(),o=await W(e,M(r,{idToken:s}));m(null==o?void 0:o.users.length,r,"internal-error");let a=o.users[0];e._notifyReloadListener(a);let l=(null==(t=a.providerUserInfo)?void 0:t.length)?$(a.providerUserInfo):[],h=(i=e.providerData,n=l,[...i.filter(e=>!n.some(t=>t.providerId===e.providerId)),...n]),c=e.isAnonymous,u=!(e.email&&a.passwordHash)&&!(null==h?void 0:h.length);Object.assign(e,{uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:h,metadata:new V(a.createdAt,a.lastLoginAt),isAnonymous:!!c&&u})}async function K(e){let t=(0,r.Ku)(e);await z(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function $(e){return e.map(e=>{var{providerId:t}=e,i=s(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}async function G(e,t){let i=await k(e,{},async()=>{let i=(0,r.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:s}=e.config,o=await R(e,n,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:a,body:i};return e.emulatorConfig&&(0,r.zJ)(e.emulatorConfig.host)&&(l.credentials="include"),C.fetch()(o,l)});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}async function Y(e,t){return T(e,"POST","/v2/accounts:revokeToken",S(e,t))}class Q{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){m(e.idToken,"internal-error"),m(void 0!==e.idToken,"internal-error"),m(void 0!==e.refreshToken,"internal-error");let t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):B(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){m(0!==e.length,"internal-error");let t=B(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(m(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:i,refreshToken:n,expiresIn:r}=await G(e,t);this.updateTokensAndExpiration(i,n,Number(r))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*i}static fromJSON(e,t){let{refreshToken:i,accessToken:n,expirationTime:r}=t,s=new Q;return i&&(m("string"==typeof i,"internal-error",{appName:e}),s.refreshToken=i),n&&(m("string"==typeof n,"internal-error",{appName:e}),s.accessToken=n),r&&(m("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Q,this.toJSON())}_performRefresh(){return v("not implemented")}}function J(e,t){m("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Z{constructor(e){var{uid:t,auth:i,stsTokenManager:n}=e,r=s(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new j(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new V(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await W(this,this.stsTokenManager.getToken(this.auth,e));return m(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return U(this,e)}reload(){return K(this)}_assign(e){this!==e&&(m(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new Z(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){m(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await z(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,n.xZ)(this.auth.app))return Promise.reject(_(this.auth));let e=await this.getIdToken();return await W(this,L(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,n,r,s,o,a,l,h;let c=null!=(i=t.displayName)?i:void 0,u=null!=(n=t.email)?n:void 0,d=null!=(r=t.phoneNumber)?r:void 0,p=null!=(s=t.photoURL)?s:void 0,f=null!=(o=t.tenantId)?o:void 0,_=null!=(a=t._redirectEventId)?a:void 0,g=null!=(l=t.createdAt)?l:void 0,v=null!=(h=t.lastLoginAt)?h:void 0,{uid:y,emailVerified:E,isAnonymous:C,providerData:w,stsTokenManager:b}=t;m(y&&b,e,"internal-error");let I=Q.fromJSON(this.name,b);m("string"==typeof y,e,"internal-error"),J(c,e.name),J(u,e.name),m("boolean"==typeof E,e,"internal-error"),m("boolean"==typeof C,e,"internal-error"),J(d,e.name),J(p,e.name),J(f,e.name),J(_,e.name),J(g,e.name),J(v,e.name);let S=new Z({uid:y,auth:e,email:u,emailVerified:E,displayName:c,isAnonymous:C,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:I,createdAt:g,lastLoginAt:v});return w&&Array.isArray(w)&&(S.providerData=w.map(e=>Object.assign({},e))),_&&(S._redirectEventId=_),S}static async _fromIdTokenResponse(e,t,i=!1){let n=new Q;n.updateFromServerResponse(t);let r=new Z({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:i});return await z(r),r}static async _fromGetAccountInfoResponse(e,t,i){let n=t.users[0];m(void 0!==n.localId,"internal-error");let r=void 0!==n.providerUserInfo?$(n.providerUserInfo):[],s=!(n.email&&n.passwordHash)&&!(null==r?void 0:r.length),o=new Q;o.updateFromIdToken(i);let a=new Z({uid:n.localId,auth:e,stsTokenManager:o,isAnonymous:s});return Object.assign(a,{uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:r,metadata:new V(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!(null==r?void 0:r.length)}),a}}let X=new Map;function ee(e){var t;e instanceof Function||v("Expected a class definition");let i=X.get(e);return i?(t="Instance stored in cache mismatched with class",i instanceof e||v(t),i):(i=new e,X.set(e,i),i)}class et{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}function ei(e,t,i){return`firebase:${e}:${t}:${i}`}et.type="NONE";class en{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:n,name:r}=this.auth;this.fullUserKey=ei(this.userKey,n.apiKey,r),this.fullPersistenceKey=ei("persistence",n.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let t=await M(this.auth,{idToken:e}).catch(()=>void 0);return t?Z._fromGetAccountInfoResponse(this.auth,t,e):null}return Z._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new en(ee(et),e,i);let n=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),r=n[0]||ee(et),s=ei(i,e.config.apiKey,e.name),o=null;for(let i of t)try{let t=await i._get(s);if(t){let n;if("string"==typeof t){let i=await M(e,{idToken:t}).catch(()=>void 0);if(!i)break;n=await Z._fromGetAccountInfoResponse(e,i,t)}else n=Z._fromJSON(e,t);i!==r&&(o=n),r=i;break}}catch(e){}let a=n.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&a.length&&(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new en(r,e,i)}}function er(e){let t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";{if(function(e=(0,r.ZQ)()){return/iemobile/i.test(e)}(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(function(e=(0,r.ZQ)()){return/firefox\//i.test(e)}(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(function(e=(0,r.ZQ)()){return/blackberry/i.test(e)}(t))return"Blackberry";if(function(e=(0,r.ZQ)()){return/webos/i.test(e)}(t))return"Webos";if(function(e=(0,r.ZQ)()){let t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}(t))return"Safari";if((t.includes("chrome/")||function(e=(0,r.ZQ)()){return/crios\//i.test(e)}(t))&&!t.includes("edge/"))return"Chrome";if(function(e=(0,r.ZQ)()){return/android/i.test(e)}(t))return"Android";let i=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if((null==i?void 0:i.length)===2)return i[1]}return"Other"}function es(e,t=[]){let i;switch(e){case"Browser":i=er((0,r.ZQ)());break;case"Worker":i=`${er((0,r.ZQ)())}-${e}`;break;default:i=e}let s=t.length?t.join(","):"FirebaseCore-web";return`${i}/JsCore/${n.MF}/${s}`}class eo{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=t=>new Promise((i,n)=>{try{let n=e(t);i(n)}catch(e){n(e)}});i.onAbort=t,this.queue.push(i);let n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(e){for(let e of(t.reverse(),t))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}async function ea(e,t={}){return T(e,"GET","/v2/passwordPolicy",S(e,t))}class el{constructor(e){var t,i,n,r;let s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!=(t=s.minPasswordLength)?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!=(n=null==(i=e.allowedNonAlphanumericCharacters)?void 0:i.join(""))?n:"",this.forceUpgradeOnSignin=null!=(r=e.forceUpgradeOnSignin)&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,n,r,s,o;let a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null==(t=a.meetsMinPasswordLength)||t),a.isValid&&(a.isValid=null==(i=a.meetsMaxPasswordLength)||i),a.isValid&&(a.isValid=null==(n=a.containsLowercaseLetter)||n),a.isValid&&(a.isValid=null==(r=a.containsUppercaseLetter)||r),a.isValid&&(a.isValid=null==(s=a.containsNumericCharacter)||s),a.isValid&&(a.isValid=null==(o=a.containsNonAlphanumericCharacter)||o),a}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){let i;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let n=0;n<e.length;n++)i=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,n,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class eh{constructor(e,t,i,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eu(this),this.idTokenSubscription=new eu(this),this.beforeStateQueue=new eo(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=h,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ee(t)),this._initializationPromise=this.queue(async()=>{var i,n,r;if(!this._deleted){if(this.persistenceManager=await en.create(this,e),null==(i=this._resolvePersistenceManagerAvailable)||i.call(this),!this._deleted){if(null==(n=this._popupRedirectResolver)?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null==(r=this.currentUser)?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await M(this,{idToken:e}),i=await Z._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if((0,n.xZ)(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}let i=await this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let i=null==(t=this.redirectUser)?void 0:t._redirectEventId,n=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);(!i||i===n)&&(null==o?void 0:o.user)&&(r=o.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return(m(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId)?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await z(e)}catch(e){if((null==e?void 0:e.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,n.xZ)(this.app))return Promise.reject(_(this));let t=e?(0,r.Ku)(e):null;return t&&m(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&m(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,n.xZ)(this.app)?Promise.reject(_(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,n.xZ)(this.app)?Promise.reject(_(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ee(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=new el(await ea(this));null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new r.FA("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await Y(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null==(e=this._currentUser)?void 0:e.toJSON()}}async _setRedirectUser(e,t){let i=await this.getOrInitRedirectPersistenceManager(t);return null===e?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&ee(e)||this._popupRedirectResolver;m(t,this,"argument-error"),this.redirectPersistenceManager=await en.create(this,[ee(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return(this._isInitialized&&await this.queue(async()=>{}),(null==(t=this._currentUser)?void 0:t._redirectEventId)===e)?this._currentUser:(null==(i=this.redirectUser)?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=null!=(t=null==(e=this.currentUser)?void 0:e.uid)?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,n){if(this._deleted)return()=>{};let r="function"==typeof t?t:t.next.bind(t),s=!1,o=this._isInitialized?Promise.resolve():this._initializationPromise;if(m(o,this,"internal-error"),o.then(()=>{s||r(this.currentUser)}),"function"==typeof t){let r=e.addObserver(t,i,n);return()=>{s=!0,r()}}{let i=e.addObserver(t);return()=>{s=!0,i()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return m(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=es(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let i=await (null==(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);let n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){var e;if((0,n.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=await (null==(e=this.appCheckServiceProvider.getImmediate({optional:!0}))?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){c.logLevel<=a.$b.WARN&&c.warn(`Auth (${n.MF}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function ec(e){return(0,r.Ku)(e)}class eu{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,r.tD)(e=>this.observer=e)}get next(){return m(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ed={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};class ep{constructor(){this.enterprise=new ef}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class ef{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}let e_="NO_RECAPTCHA";class eg{constructor(e){this.type="recaptcha-enterprise",this.auth=ec(e)}async verify(e="verify",t=!1){async function i(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,i)=>{D(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(n=>{if(void 0===n.recaptchaKey)i(Error("recaptcha Enterprise site key undefined"));else{let i=new x(n);return null==e.tenantId?e._agentRecaptchaConfig=i:e._tenantRecaptchaConfigs[e.tenantId]=i,t(i.siteKey)}}).catch(e=>{i(e)})})}function n(t,i,n){let r=window.grecaptcha;P(r)?r.enterprise.ready(()=>{r.enterprise.execute(t,{action:e}).then(e=>{i(e)}).catch(()=>{i(e_)})}):n(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ep().execute("siteKey",{action:"verify"}):new Promise((e,r)=>{i(this.auth).then(i=>{if(!t&&P(window.grecaptcha))n(i,e,r);else{var s;if("undefined"==typeof window)return void r(Error("RecaptchaVerifier is only supported in browser"));let t=ed.recaptchaEnterpriseScript;0!==t.length&&(t+=i),(s=t,ed.loadJS(s)).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function em(e,t,i,n=!1,r=!1){let s,o=new eg(e);if(r)s=e_;else try{s=await o.verify(i)}catch(e){s=await o.verify(i,!0)}let a=Object.assign({},t);if("mfaSmsEnrollment"===i||"mfaSmsSignIn"===i){if("phoneEnrollmentInfo"in a){let e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){let e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function ev(e,t,i,n,r){var s,o;if("EMAIL_PASSWORD_PROVIDER"===r)if(null==(s=e._getRecaptchaConfig())||!s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return n(e,t).catch(async r=>{if("auth/missing-recaptcha-token"!==r.code)return Promise.reject(r);{console.log(`${i} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let r=await em(e,t,i,"getOobCode"===i);return n(e,r)}});else{let r=await em(e,t,i,"getOobCode"===i);return n(e,r)}if("PHONE_PROVIDER"!==r)return Promise.reject(r+" provider is not supported.");if(null==(o=e._getRecaptchaConfig())?void 0:o.isProviderEnabled("PHONE_PROVIDER")){let r=await em(e,t,i);return n(e,r).catch(async r=>{var s;if((null==(s=e._getRecaptchaConfig())?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&("auth/missing-recaptcha-token"===r.code||"auth/invalid-app-credential"===r.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${i} flow.`);let r=await em(e,t,i,!1,!0);return n(e,r)}return Promise.reject(r)})}{let r=await em(e,t,i,!1,!0);return n(e,r)}}function ey(e){let t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function eE(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}class eC{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return v("not implemented")}_getIdTokenResponse(e){return v("not implemented")}_linkToIdToken(e,t){return v("not implemented")}_getReauthenticationResolver(e){return v("not implemented")}}async function ew(e,t){return T(e,"POST","/v1/accounts:resetPassword",S(e,t))}async function eb(e,t){return T(e,"POST","/v1/accounts:update",t)}async function eI(e,t){return T(e,"POST","/v1/accounts:signUp",t)}async function eS(e,t){return N(e,"POST","/v1/accounts:signInWithPassword",S(e,t))}async function eT(e,t){return T(e,"POST","/v1/accounts:sendOobCode",S(e,t))}async function ek(e,t){return N(e,"POST","/v1/accounts:signInWithEmailLink",S(e,t))}async function eN(e,t){return N(e,"POST","/v1/accounts:signInWithEmailLink",S(e,t))}class eR extends eC{constructor(e,t,i,n=null){super("password",i),this._email=e,this._password=t,this._tenantId=n}static _fromEmailAndPassword(e,t){return new eR(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new eR(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);else if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return ev(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",eS,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return ek(e,{email:this._email,oobCode:this._password});default:d(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ev(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eI,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return eN(e,{idToken:t,email:this._email,oobCode:this._password});default:d(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function eO(e,t){return N(e,"POST","/v1/accounts:signInWithIdp",S(e,t))}class eA extends eC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new eA(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):d("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e,{providerId:i,signInMethod:n}=t,r=s(t,["providerId","signInMethod"]);if(!i||!n)return null;let o=new eA(i,n);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){return eO(e,this.buildRequest())}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,eO(e,i)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,eO(e,t)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,r.Am)(t)}return e}}class eP{constructor(e){var t,i,n,s,o,a;let l=(0,r.I9)((0,r.hp)(e)),h=null!=(t=l.apiKey)?t:null,c=null!=(i=l.oobCode)?i:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!=(n=l.mode)?n:null);m(h&&c&&u,"argument-error"),this.apiKey=h,this.operation=u,this.code=c,this.continueUrl=null!=(s=l.continueUrl)?s:null,this.languageCode=null!=(o=l.lang)?o:null,this.tenantId=null!=(a=l.tenantId)?a:null}static parseLink(e){let t=function(e){let t=(0,r.I9)((0,r.hp)(e)).link,i=t?(0,r.I9)((0,r.hp)(t)).deep_link_id:null,n=(0,r.I9)((0,r.hp)(e)).deep_link_id;return(n?(0,r.I9)((0,r.hp)(n)).link:null)||n||i||t||e}(e);try{return new eP(t)}catch(e){return null}}}class ex{constructor(){this.providerId=ex.PROVIDER_ID}static credential(e,t){return eR._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let i=eP.parseLink(t);return m(i,"argument-error"),eR._fromEmailAndCode(e,i.code,i.tenantId)}}ex.PROVIDER_ID="password",ex.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ex.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class eD{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class eL extends eD{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class eM extends eL{constructor(){super("facebook.com")}static credential(e){return eA._fromParams({providerId:eM.PROVIDER_ID,signInMethod:eM.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return eM.credentialFromTaggedObject(e)}static credentialFromError(e){return eM.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return eM.credential(e.oauthAccessToken)}catch(e){return null}}}eM.FACEBOOK_SIGN_IN_METHOD="facebook.com",eM.PROVIDER_ID="facebook.com";class eF extends eL{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return eA._fromParams({providerId:eF.PROVIDER_ID,signInMethod:eF.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return eF.credentialFromTaggedObject(e)}static credentialFromError(e){return eF.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return eF.credential(t,i)}catch(e){return null}}}eF.GOOGLE_SIGN_IN_METHOD="google.com",eF.PROVIDER_ID="google.com";class eU extends eL{constructor(){super("github.com")}static credential(e){return eA._fromParams({providerId:eU.PROVIDER_ID,signInMethod:eU.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return eU.credentialFromTaggedObject(e)}static credentialFromError(e){return eU.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return eU.credential(e.oauthAccessToken)}catch(e){return null}}}eU.GITHUB_SIGN_IN_METHOD="github.com",eU.PROVIDER_ID="github.com";class eH extends eL{constructor(){super("twitter.com")}static credential(e,t){return eA._fromParams({providerId:eH.PROVIDER_ID,signInMethod:eH.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return eH.credentialFromTaggedObject(e)}static credentialFromError(e){return eH.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return eH.credential(t,i)}catch(e){return null}}}eH.TWITTER_SIGN_IN_METHOD="twitter.com",eH.PROVIDER_ID="twitter.com";class eq{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,n=!1){return new eq({user:await Z._fromIdTokenResponse(e,i,n),providerId:eB(i),_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){return await e._updateTokensIfNecessary(i,!0),new eq({user:e,providerId:eB(i),_tokenResponse:i,operationType:t})}}function eB(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class eW extends r.g{constructor(e,t,i,n){var r;super(t.code,t.message),this.operationType=i,this.user=n,Object.setPrototypeOf(this,eW.prototype),this.customData={appName:e.name,tenantId:null!=(r=e.tenantId)?r:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,n){return new eW(e,t,i,n)}}function ej(e,t,i,n){return("reauthenticate"===t?i._getReauthenticationResolver(e):i._getIdTokenResponse(e)).catch(i=>{if("auth/multi-factor-auth-required"===i.code)throw eW._fromErrorAndOperation(e,i,t,n);throw i})}async function eV(e,t,i=!1){if(_isFirebaseServerApp(e.app))return Promise.reject(_(e));let n="signIn",r=await ej(e,n,t),s=await eq._fromIdTokenResponse(e,n,r);return i||await e._updateCurrentUser(s.user),s}class ez{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?eK._fromServerResponse(e,t):"totpInfo"in t?e$._fromServerResponse(e,t):d(e,"internal-error")}}class eK extends ez{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new eK(t)}}class e$ extends ez{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new e$(t)}}class eG{constructor(e,t,i={}){this.isNewUser=e,this.providerId=t,this.profile=i}}class eY extends eG{constructor(e,t,i,n){super(e,t,i),this.username=n}}class eQ{constructor(e,t,i){this.type=e,this.credential=t,this.user=i}static _fromIdtoken(e,t){return new eQ("enroll",e,t)}static _fromMfaPendingCredential(e){return new eQ("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,i;if(null==e?void 0:e.multiFactorSession){if(null==(t=e.multiFactorSession)?void 0:t.pendingCredential)return eQ._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);else if(null==(i=e.multiFactorSession)?void 0:i.idToken)return eQ._fromIdtoken(e.multiFactorSession.idToken)}return null}}class eJ{constructor(e,t,i){this.session=e,this.hints=t,this.signInResolver=i}static _fromError(e,t){let i=ec(e),n=t.customData._serverResponse,r=(n.mfaInfo||[]).map(e=>ez._fromServerResponse(i,e));m(n.mfaPendingCredential,i,"internal-error");let s=eQ._fromMfaPendingCredential(n.mfaPendingCredential);return new eJ(s,r,async e=>{let r=await e._process(i,s);delete n.mfaInfo,delete n.mfaPendingCredential;let o=Object.assign(Object.assign({},n),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":let a=await eq._fromIdTokenResponse(i,t.operationType,o);return await i._updateCurrentUser(a.user),a;case"reauthenticate":return m(t.user,i,"internal-error"),eq._forOperation(t.user,t.operationType,o);default:d(i,"internal-error")}})}async resolveSignIn(e){return this.signInResolver(e)}}class eZ{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>ez._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new eZ(e)}async getSession(){return eQ._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){let i=await this.getSession(),n=await W(this.user,e._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(n),this.user.reload()}async unenroll(e){let t="string"==typeof e?e:e.uid,i=await this.user.getIdToken();try{var n,r;let e=await W(this.user,(n=this.user.auth,r={idToken:i,mfaEnrollmentId:t},T(n,"POST","/v2/accounts/mfaEnrollment:withdraw",S(n,r))));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(e){throw e}}}new WeakMap;var eX="@firebase/auth",e0="1.10.7";class e1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null==(e=this.auth.currentUser)?void 0:e.uid)||null}async getToken(e){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){m(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function e2(e=(0,n.Sx)()){let t=(0,n.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();let i=function(e,t){let i=(0,n.j6)(e,"auth");if(i.isInitialized()){let e=i.getImmediate(),t=i.getOptions();if((0,r.bD)(t,{}))return e;d(e,"already-initialized")}return i.initialize({options:void 0})}(e),s=(0,r.Tj)("auth");return s&&function(e,t,i){let n=ec(e);m(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");let s=ey(t),{host:o,port:a}=function(e){let t=ey(e),i=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!i)return{host:"",port:null};let n=i[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(n);if(r){let e=r[1];return{host:e,port:eE(n.substr(e.length+1))}}{let[e,t]=n.split(":");return{host:e,port:eE(t)}}}(t),l=null===a?"":`:${a}`,h={url:`${s}//${o}${l}/`},c=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!n._canInitEmulator){m(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),m((0,r.bD)(h,n.config.emulator)&&(0,r.bD)(c,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=c,n.settings.appVerificationDisabledForTesting=!0,(0,r.zJ)(o)?((0,r.gE)(`${s}//${o}${l}`),(0,r.P1)("Auth",!0)):function(){function e(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(i,`http://${s}`),i}C.initialize(fetch,Headers,Response),function(e){(0,n.om)(new o.uA("auth",(t,{options:i})=>{let n=t.getProvider("app").getImmediate(),r=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;m(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});let l=new eh(n,r,s,{apiKey:o,authDomain:a,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:es(e)}),h=(null==i?void 0:i.persistence)||[],c=(Array.isArray(h)?h:[h]).map(ee);return(null==i?void 0:i.errorMap)&&l._updateErrorMap(i.errorMap),l._initializeWithPersistence(c,null==i?void 0:i.popupRedirectResolver),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),(0,n.om)(new o.uA("auth-internal",e=>new e1(ec(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,n.KO)(eX,e0,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(e)),(0,n.KO)(eX,e0,"esm2017")}("Node"),p("operation-not-supported-in-this-environment"),eh.prototype.setPersistence=async()=>{};class e3{constructor(e){this.factorId=e}_process(e,t,i){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,i);case"signin":return this._finalizeSignIn(e,t.credential);default:return v("unexpected MultiFactorSessionType")}}}class e4{static assertionForEnrollment(e,t){return e6._fromSecret(e,t)}static assertionForSignIn(e,t){return e6._fromEnrollmentId(e,t)}static async generateSecret(e){var t,i;m(void 0!==(null==(t=e.user)?void 0:t.auth),"internal-error");let n=await T(i=e.user.auth,"POST","/v2/accounts/mfaEnrollment:start",S(i,{idToken:e.credential,totpEnrollmentInfo:{}}));return e8._fromStartTotpMfaEnrollmentResponse(n,e.user.auth)}}e4.FACTOR_ID="totp";class e6 extends e3{constructor(e,t,i){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=i}static _fromSecret(e,t){return new e6(t,void 0,e)}static _fromEnrollmentId(e,t){return new e6(t,e)}async _finalizeEnroll(e,t,i){return m(void 0!==this.secret,e,"argument-error"),T(e,"POST","/v2/accounts/mfaEnrollment:finalize",S(e,{idToken:t,displayName:i,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}))}async _finalizeSignIn(e,t){m(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");let i={verificationCode:this.otp};return T(e,"POST","/v2/accounts/mfaSignIn:finalize",S(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:i}))}}class e8{constructor(e,t,i,n,r,s,o){this.sessionInfo=s,this.auth=o,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=i,this.codeIntervalSeconds=n,this.enrollmentCompletionDeadline=r}static _fromStartTotpMfaEnrollmentResponse(e,t){return new e8(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var i;let n=!1;return(e5(e)||e5(t))&&(n=!0),n&&(e5(e)&&(e=(null==(i=this.auth.currentUser)?void 0:i.email)||"unknownuser"),e5(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function e5(e){return void 0===e||(null==e?void 0:e.length)===0}},83991:(e,t,i)=>{"use strict";var n=i(7984).Buffer,r=i(37196),s=i(43082),o=i(55511),a=i(28354),l=function(e){return parseInt((e.match(/[0-9]/g)||[]).join(""),10)},h=function(e){return(e.match(/ /g)||[]).length},c=function(e,t,i){s.apply(this,arguments),this._stage=-1,this._body=[],this.version="hixie-76",this._headers.clear(),this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Origin",this._request.headers.origin),this._headers.set("Sec-WebSocket-Location",this.url)};a.inherits(c,s);var u={BODY_SIZE:8,start:function(){return!!s.prototype.start.call(this)&&(this._started=!0,this._sendHandshakeBody(),!0)},close:function(){return 3!==this.readyState&&(1===this.readyState&&this._write(n.from([255,0])),this.readyState=3,this.emit("close",new r.CloseEvent(null,null)),!0)},_handshakeResponse:function(){var e=this._request.headers,t=e["sec-websocket-key1"],i=e["sec-websocket-key2"];if(!t)throw Error("Missing required header: Sec-WebSocket-Key1");if(!i)throw Error("Missing required header: Sec-WebSocket-Key2");var r=l(t),s=h(t),o=l(i),a=h(i);if(r%s!=0||o%a!=0)throw Error("Client sent invalid Sec-WebSocket-Key headers");this._keyValues=[r/s,o/a];var e=["HTTP/1.1 101 WebSocket Protocol Handshake",this._headers.toString(),""];return n.from(e.join("\r\n"),"binary")},_handshakeSignature:function(){if(this._body.length<this.BODY_SIZE)return null;var e=o.createHash("md5"),t=n.allocUnsafe(8+this.BODY_SIZE);return t.writeUInt32BE(this._keyValues[0],0),t.writeUInt32BE(this._keyValues[1],4),n.from(this._body).copy(t,8,0,this.BODY_SIZE),e.update(t),n.from(e.digest("binary"),"binary")},_sendHandshakeBody:function(){if(this._started){var e=this._handshakeSignature();e&&(this._write(e),this._stage=0,this._open(),this._body.length>this.BODY_SIZE&&this.parse(this._body.slice(this.BODY_SIZE)))}},_parseLeadingByte:function(e){if(255!==e)return s.prototype._parseLeadingByte.call(this,e);this._closing=!0,this._length=0,this._stage=1}};for(var d in u)c.prototype[d]=u[d];e.exports=c},84027:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(62688).A)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},88060:(e,t,i)=>{"use strict";var n;i.d(t,{$b:()=>n,Vy:()=>h});let r=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(n||(n={}));let s={debug:n.DEBUG,verbose:n.VERBOSE,info:n.INFO,warn:n.WARN,error:n.ERROR,silent:n.SILENT},o=n.INFO,a={[n.DEBUG]:"log",[n.VERBOSE]:"log",[n.INFO]:"info",[n.WARN]:"warn",[n.ERROR]:"error"},l=(e,t,...i)=>{if(t<e.logLevel)return;let n=new Date().toISOString(),r=a[t];if(r)console[r](`[${n}]  ${e.name}:`,...i);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class h{constructor(e){this.name=e,this._logLevel=o,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in n))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,n.DEBUG,...e),this._logHandler(this,n.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,n.VERBOSE,...e),this._logHandler(this,n.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,n.INFO,...e),this._logHandler(this,n.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,n.WARN,...e),this._logHandler(this,n.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,n.ERROR,...e),this._logHandler(this,n.ERROR,...e)}}},90380:e=>{"use strict";var t=function(e){this._bufferSize=e,this.clear()};t.prototype.clear=function(){this._buffer=Array(this._bufferSize),this._ringOffset=0,this._ringSize=this._bufferSize,this._head=0,this._tail=0,this.length=0},t.prototype.push=function(e){var t=!1,i=!1;this._ringSize<this._bufferSize?t=0===this._tail:this._ringOffset===this._ringSize&&(t=!0,i=0===this._tail),t&&(this._tail=this._bufferSize,this._buffer=this._buffer.concat(Array(this._bufferSize)),this._bufferSize=this._buffer.length,i&&(this._ringSize=this._bufferSize)),this._buffer[this._tail]=e,this.length+=1,this._tail<this._ringSize&&(this._ringOffset+=1),this._tail=(this._tail+1)%this._bufferSize},t.prototype.peek=function(){if(0!==this.length)return this._buffer[this._head]},t.prototype.shift=function(){if(0!==this.length){var e=this._buffer[this._head];return this._buffer[this._head]=void 0,this.length-=1,this._ringOffset-=1,0===this._ringOffset&&this.length>0?(this._head=this._ringSize,this._ringOffset=this.length,this._ringSize=this._bufferSize):this._head=(this._head+1)%this._ringSize,e}},e.exports=t},90555:(e,t,i)=>{"use strict";let n,r,s,o,a,l,h,c,u,d;i.d(t,{Jt:()=>nV,C3:()=>nX,Zy:()=>n$,KR:()=>nq,hZ:()=>nW,yo:()=>nj});var p,f=i(70092),_=i(52122),g=i(88060),m=i(27728),v=i(35545);let y=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,E="websocket",C="long_polling";class w{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,_.As)(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,_.$L)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class b{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,_.gR)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}let I=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){let t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new w(t)}}catch(e){}return new b},S=I("localStorage"),T=I("sessionStorage"),k=new g.Vy("@firebase/database"),N=function(){let e=1;return function(){return e++}}(),R=function(e){let t=(0,_.kj)(e),i=new _.gz;i.update(t);let n=i.digest();return _.K3.encodeByteArray(n)},O=function(...e){let t="";for(let i=0;i<e.length;i++){let n=e[i];Array.isArray(n)||n&&"object"==typeof n&&"number"==typeof n.length?t+=O.apply(null,n):"object"==typeof n?t+=(0,_.As)(n):t+=n,t+=" "}return t},A=null,P=!0,x=function(e,t){(0,_.vA)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(k.logLevel=g.$b.VERBOSE,A=k.log.bind(k),t&&T.set("logging_enabled",!0)):"function"==typeof e?A=e:(A=null,T.remove("logging_enabled"))},D=function(...e){if(!0===P&&(P=!1,null===A&&!0===T.get("logging_enabled")&&x(!0)),A){let t=O.apply(null,e);A(t)}},L=function(e){return function(...t){D(e,...t)}},M=function(...e){let t="FIREBASE INTERNAL ERROR: "+O(...e);k.error(t)},F=function(...e){let t=`FIREBASE FATAL ERROR: ${O(...e)}`;throw k.error(t),Error(t)},U=function(...e){let t="FIREBASE WARNING: "+O(...e);k.warn(t)},H=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&U("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},q=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},B=function(e){if((0,_.$g)()||"complete"===document.readyState)e();else{let t=!1,i=function(){if(!document.body)return void setTimeout(i,Math.floor(10));t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&i()}),window.attachEvent("onload",i))}},W="[MIN_NAME]",j="[MAX_NAME]",V=function(e,t){if(e===t)return 0;{if(e===W||t===j)return -1;if(t===W||e===j)return 1;let i=Z(e),n=Z(t);if(null!==i)if(null!==n)return i-n==0?e.length-t.length:i-n;else return -1;return null!==n?1:e<t?-1:1}},z=function(e,t){return e===t?0:e<t?-1:1},K=function(e,t){if(t&&e in t)return t[e];throw Error("Missing required key ("+e+") in object: "+(0,_.As)(t))},$=function(e){if("object"!=typeof e||null===e)return(0,_.As)(e);let t=[];for(let i in e)t.push(i);t.sort();let i="{";for(let n=0;n<t.length;n++)0!==n&&(i+=","),i+=(0,_.As)(t[n]),i+=":",i+=$(e[t[n]]);return i+"}"},G=function(e,t){let i=e.length;if(i<=t)return[e];let n=[];for(let r=0;r<i;r+=t)r+t>i?n.push(e.substring(r,i)):n.push(e.substring(r,r+t));return n};function Y(e,t){for(let i in e)e.hasOwnProperty(i)&&t(i,e[i])}let Q=function(e){let t,i,n,r,s;(0,_.vA)(!q(e),"Invalid JSON number");0===e?(i=0,n=0,t=+(1/e==-1/0)):(t=e<0,(e=Math.abs(e))>=22250738585072014e-324?(i=(r=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,n=Math.round(e*Math.pow(2,52-r)-0x10000000000000)):(i=0,n=Math.round(e/5e-324)));let o=[];for(s=52;s;s-=1)o.push(n%2?1:0),n=Math.floor(n/2);for(s=11;s;s-=1)o.push(i%2?1:0),i=Math.floor(i/2);o.push(+!!t),o.reverse();let a=o.join(""),l="";for(s=0;s<64;s+=8){let e=parseInt(a.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),l+=e}return l.toLowerCase()},J=RegExp("^-?(0*)\\d{1,10}$"),Z=function(e){if(J.test(e)){let t=Number(e);if(t>=-0x80000000&&t<=0x7fffffff)return t}return null},X=function(e){try{e()}catch(e){setTimeout(()=>{throw U("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},ee=function(e,t){let i=setTimeout(e,t);return"number"==typeof i&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(i):"object"==typeof i&&i.unref&&i.unref(),i};class et{constructor(e,t,i,n,r=!1,s="",o=!1,a=!1,l=null){this.secure=t,this.namespace=i,this.webSocketOnly=n,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this.emulatorOptions=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=S.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&S.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function ei(e,t,i){let n;if((0,_.vA)("string"==typeof t,"typeof type must == string"),(0,_.vA)("object"==typeof i,"typeof params must == object"),t===E)n=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(t===C)n=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw Error("Unknown connection type: "+t);(e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams)&&(i.ns=e.namespace);let r=[];return Y(i,(e,t)=>{r.push(e+"="+t)}),n+r.join("&")}class en{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,_.gR)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,_.A4)(this.counters_)}}let er={},es={};function eo(e){let t=e.toString();return er[t]||(er[t]=new en),er[t]}let ea="",el=null;"undefined"!=typeof MozWebSocket?el=MozWebSocket:"undefined"!=typeof WebSocket&&(el=WebSocket);class eh{constructor(e,t,i,n,r,s,o){this.connId=e,this.applicationId=i,this.appCheckToken=n,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=L(this.connId),this.stats_=eo(t),this.connURL=eh.connectionURL_(t,s,o,n,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,n,r){let s={};return s.v="5",!(0,_.$g)()&&"undefined"!=typeof location&&location.hostname&&y.test(location.hostname)&&(s.r="f"),t&&(s.s=t),i&&(s.ls=i),n&&(s.ac=n),r&&(s.p=r),ei(e,E,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,S.set("previous_websocket_failure",!0);try{let e;if((0,_.$g)()){let t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":`Firebase/5/${ea}/${process.platform}/${t}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);let i=process.env,n=0===this.connURL.indexOf("wss://")?i.HTTPS_PROXY||i.https_proxy:i.HTTP_PROXY||i.http_proxy;n&&(e.proxy={origin:n})}this.mySock=new el(this.connURL,[],e)}catch(t){this.log_("Error instantiating WebSocket.");let e=t.message||t.data;e&&this.log_(e),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");let t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){eh.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){let t=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);t&&t.length>1&&4.4>parseFloat(t[1])&&(e=!0)}return!e&&null!==el&&!eh.forceDisallow_}static previouslyFailed(){return S.isInMemoryStorage||!0===S.get("previous_websocket_failure")}markConnectionHealthy(){S.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){let e=this.frames.join("");this.frames=null;let t=(0,_.$L)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,_.vA)(null===this.frames,"We already have a frame buffer"),e.length<=6){let t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;let t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{let e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();let t=(0,_.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let i=G(t,16384);i.length>1&&this.sendString_(String(i.length));for(let e=0;e<i.length;e++)this.sendString_(i[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){!this.isClosed_&&(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}eh.responsesRequiredToBeHealthy=2,eh.healthyTimeout=3e4;let ec="@firebase/database",eu="1.0.19";class ed{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,(0,m.xZ)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(e=>this.appCheck=e)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;null==(t=this.appCheckProvider)||t.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){U(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class ep{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(e=>this.auth_=e)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(e=>e&&"auth/token-not-initialized"===e.code?(D("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',U(e)}}class ef{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ef.OWNER="owner";class e_{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&X(()=>{this.onMessage_(e[t])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}let eg="start";class em{constructor(e,t,i,n,r,s,o){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=n,this.authToken=r,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=L(e),this.stats_=eo(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),ei(t,C,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new e_(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),B(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ev((...e)=>{let[t,i,n,r,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===eg)this.id=i,this.password=n;else if("close"===t)i?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(i,()=>{this.onClosed_()})):this.onClosed_();else throw Error("Unrecognized command received: "+t)},(...e)=>{let[t,i]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,i)},()=>{this.onClosed_()},this.urlFn);let e={};e[eg]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&y.test(location.hostname)&&(e.r="f");let t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){em.forceAllow_=!0}static forceDisallow(){em.forceDisallow_=!0}static isAvailable(){return!(0,_.$g)()&&(!!em.forceAllow_||!em.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&("object"!=typeof Windows||"object"!=typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){!this.isClosed_&&(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=(0,_.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let i=G((0,_.KA)(t),1840);for(let e=0;e<i.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,_.$g)())return;this.myDisconnFrame=document.createElement("iframe");let i={};i.dframe="t",i.id=e,i.pw=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=(0,_.As)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ev{constructor(e,t,i,n){if(this.onDisconnect=i,this.urlFn=n,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,_.$g)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=N(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=ev.createIFrame_();let i="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(i='<script>document.domain="'+document.domain+'";<\/script>');let n="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(n),this.myIFrame.doc.close()}catch(e){D("frame writing exception"),e.stack&&D(e.stack),D(e)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||D("No IE domain setting required")}catch(t){e.src="javascript:void((function(){document.open();document.domain='"+document.domain+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(!this.alive||!this.sendNewPolls||!(this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)))return!1;{this.currentSerial++;let e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),i="",n=0;for(;this.pendingSegs.length>0;)if(this.pendingSegs[0].d.length+30+i.length<=1870){let e=this.pendingSegs.shift();i=i+"&seg"+n+"="+e.seg+"&ts"+n+"="+e.ts+"&d"+n+"="+e.d,n++}else break;return t+=i,this.addLongPollTag_(t,this.currentSerial),!0}}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},n=setTimeout(i,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(n),i()})}addTag(e,t){(0,_.$g)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let e=i.readyState;e&&"loaded"!==e&&"complete"!==e||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{D("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch(e){}},Math.floor(1))}}class ey{static get ALL_TRANSPORTS(){return[em,eh]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){let t=eh&&eh.isAvailable(),i=t&&!eh.previouslyFailed();if(e.webSocketOnly&&(t||U("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[eh];else{let e=this.transports_=[];for(let t of ey.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);ey.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ey.globalTransportInitialized_=!1;class eE{constructor(e,t,i,n,r,s,o,a,l,h){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=n,this.authToken_=r,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=L("c:"+this.id+":"),this.transportManager_=new ey(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));let n=e.healthyTimeout||0;n>0&&(this.healthyTimeout_=ee(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(n)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){let t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=K("t",e),i=K("d",e);if("c"===t)this.onSecondaryControl_(i);else if("d"===t)this.pendingDataMessages.push(i);else throw Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=K("t",e),i=K("d",e);"c"===t?this.onControl_(i):"d"===t&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){!this.isHealthy_&&(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=K("t",e);if("d"in e){let i=e.d;if("h"===t){let e=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(i):"r"===t?this.onReset_(i):"e"===t?M("Server Error: "+i):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):M("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,i=e.v,n=e.h;this.sessionId=e.s,this.repoInfo_.host=n,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==i&&U("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),ee(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ee(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(S.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class eC{put(e,t,i,n){}merge(e,t,i,n){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}class ew{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,_.vA)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let e=0;e<i.length;e++)i[e].callback.apply(i[e].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});let n=this.getInitialEvent(e);n&&t.apply(i,n)}off(e,t,i){this.validateEventType_(e);let n=this.listeners_[e]||[];for(let e=0;e<n.length;e++)if(n[e].callback===t&&(!i||i===n[e].context))return void n.splice(e,1)}validateEventType_(e){(0,_.vA)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class eb extends ew{static getInstance(){return new eb}constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,_.jZ)()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return(0,_.vA)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class eI{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function eS(){return new eI("")}function eT(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ek(e){return e.pieces_.length-e.pieceNum_}function eN(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new eI(e.pieces_,t)}function eR(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function eO(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function eA(e){if(e.pieceNum_>=e.pieces_.length)return null;let t=[];for(let i=e.pieceNum_;i<e.pieces_.length-1;i++)t.push(e.pieces_[i]);return new eI(t,0)}function eP(e,t){let i=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)i.push(e.pieces_[t]);if(t instanceof eI)for(let e=t.pieceNum_;e<t.pieces_.length;e++)i.push(t.pieces_[e]);else{let e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&i.push(e[t])}return new eI(i,0)}function ex(e){return e.pieceNum_>=e.pieces_.length}function eD(e,t){let i=eT(e),n=eT(t);if(null===i)return t;if(i===n)return eD(eN(e),eN(t));throw Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function eL(e,t){let i=eO(e,0),n=eO(t,0);for(let e=0;e<i.length&&e<n.length;e++){let t=V(i[e],n[e]);if(0!==t)return t}return i.length===n.length?0:i.length<n.length?-1:1}function eM(e,t){if(ek(e)!==ek(t))return!1;for(let i=e.pieceNum_,n=t.pieceNum_;i<=e.pieces_.length;i++,n++)if(e.pieces_[i]!==t.pieces_[n])return!1;return!0}function eF(e,t){let i=e.pieceNum_,n=t.pieceNum_;if(ek(e)>ek(t))return!1;for(;i<e.pieces_.length;){if(e.pieces_[i]!==t.pieces_[n])return!1;++i,++n}return!0}class eU{constructor(e,t){this.errorPrefix_=t,this.parts_=eO(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=(0,_.OE)(this.parts_[e]);eH(this)}}function eH(e){if(e.byteLength_>768)throw Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+eq(e))}function eq(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class eB extends ew{static getInstance(){return new eB}constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))},!1)}getInitialEvent(e){return(0,_.vA)("visible"===e,"Unknown event type: "+e),[this.visible_]}}class eW extends eC{constructor(e,t,i,n,r,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=n,this.onServerInfoUpdate_=r,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=eW.nextPersistentConnectionId_++,this.log_=L("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=1e3,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!(0,_.$g)())throw Error("Auth override specified in options, but not supported on non Node.js platforms");eB.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&eb.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){let n=++this.requestNumber_,r={r:n,a:e,b:t};this.log_((0,_.As)(r)),(0,_.vA)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),i&&(this.requestCBHash_[n]=i)}get(e){this.initConnection_();let t=new _.cY,i={p:e._path.toString(),q:e._queryObject};this.outstandingGets_.push({action:"g",request:i,onComplete:e=>{let i=e.d;"ok"===e.s?t.resolve(i):t.reject(i)}}),this.outstandingGetCount_++;let n=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(n),t.promise}listen(e,t,i,n){this.initConnection_();let r=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+r),this.listens.has(s)||this.listens.set(s,new Map),(0,_.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,_.vA)(!this.listens.get(s).has(r),"listen() called twice for same path/queryId.");let o={onComplete:n,hashFn:t,query:e,tag:i};this.listens.get(s).set(r,o),this.connected_&&this.sendListen_(o)}sendGet_(e){let t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){let t=e.query,i=t._path.toString(),n=t._queryIdentifier;this.log_("Listen on "+i+" for "+n);let r={p:i};e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest("q",r,r=>{let s=r.d,o=r.s;eW.warnOnListenWarnings_(s,t),(this.listens.get(i)&&this.listens.get(i).get(n))===e&&(this.log_("listen response",r),"ok"!==o&&this.removeListen_(i,n),e.onComplete&&e.onComplete(o,s))})}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&(0,_.gR)(e,"w")){let i=(0,_.yw)(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();U(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,_.qc)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let e=this.authToken_,t=(0,_.Cv)(e)?"auth":"gauth",i={cred:e};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(t,i,t=>{let i=t.s,n=t.d||"error";this.authToken_===e&&("ok"===i?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,n))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{let t=e.s,i=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){let i=e._path.toString(),n=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+n),(0,_.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,n)&&this.connected_&&this.sendUnlisten_(i,n,e._queryObject,t)}sendUnlisten_(e,t,i,n){this.log_("Unlisten on "+e+" for "+t);let r={p:e};n&&(r.q=i,r.t=n),this.sendRequest("n",r)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,n){let r={p:t,d:i};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,e=>{n&&setTimeout(()=>{n(e.s,e.d)},Math.floor(0))})}put(e,t,i,n){this.putInternal("p",e,t,i,n)}merge(e,t,i,n){this.putInternal("m",e,t,i,n)}putInternal(e,t,i,n,r){this.initConnection_();let s={p:t,d:i};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:e,request:s,onComplete:n}),this.outstandingPutCount_++;let o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){let t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,n=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,i=>{this.log_(t+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),n&&n(i.s,i.d)})}reportStats(e){if(this.connected_){let t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,e=>{if("ok"!==e.s){let t=e.d;this.log_("reportStats","Error sending stats: "+t)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,_.As)(e));let t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else if("error"in e)throw"A server-side error has occurred: "+e.error;else"a"in e&&this.onDataPush_(e.a,e.b)}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):M("Unrecognized action received from server: "+(0,_.As)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,_.vA)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_),t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),n=this.id+":"+eW.nextConnectionId_++,r=this.lastSessionId,s=!1,o=null,a=function(){o?o.close():(s=!0,i())};this.realtime_={close:a,sendRequest:function(e){(0,_.vA)(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)}};let l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[a,h]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);s?D("getToken() completed but was canceled"):(D("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=h&&h.token,o=new eE(n,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,e=>{U(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")},r))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&U(e),a())}}}interrupt(e){D("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){D("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,_.Im)(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){let t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){let t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;i=t?t.map(e=>$(e)).join("$"):"default";let n=this.removeListen_(e,i);n&&n.onComplete&&n.onComplete("permission_denied")}removeListen_(e,t){let i,n=new eI(e).toString();if(this.listens.has(n)){let e=this.listens.get(n);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,t){D("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){D("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){for(let e of(this.tryAuth(),this.tryAppCheck(),this.listens.values()))for(let t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){let e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){let e={},t="js";(0,_.$g)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+ea.replace(/\./g,"-")]=1,(0,_.jZ)()?e["framework.cordova"]=1:(0,_.lV)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){let e=eb.getInstance().currentlyOnline();return(0,_.Im)(this.interruptReasons_)&&e}}eW.nextPersistentConnectionId_=0,eW.nextConnectionId_=0;class ej{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ej(e,t)}}class eV{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let i=new ej(W,e),n=new ej(W,t);return 0!==this.compare(i,n)}minPost(){return ej.MIN}}class ez extends eV{static get __EMPTY_NODE(){return n}static set __EMPTY_NODE(e){n=e}compare(e,t){return V(e.name,t.name)}isDefinedOn(e){throw(0,_.Hk)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ej.MIN}maxPost(){return new ej(j,n)}makePost(e,t){return(0,_.vA)("string"==typeof e,"KeyIndex indexValue must always be a string."),new ej(e,n)}toString(){return".key"}}let eK=new ez;class e${constructor(e,t,i,n,r=null){this.isReverse_=n,this.resultGenerator_=r,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,n&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else if(0===s){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}getNext(){let e;if(0===this.nodeStack_.length)return null;let t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class eG{constructor(e,t,i,n,r){this.key=e,this.value=t,this.color=null!=i?i:eG.RED,this.left=null!=n?n:eQ.EMPTY_NODE,this.right=null!=r?r:eQ.EMPTY_NODE}copy(e,t,i,n,r){return new eG(null!=e?e:this.key,null!=t?t:this.value,null!=i?i:this.color,null!=n?n:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let n=this,r=i(e,n.key);return(n=r<0?n.copy(null,null,null,n.left.insert(e,t,i),null):0===r?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,i))).fixUp_()}removeMin_(){if(this.left.isEmpty())return eQ.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}remove(e,t){let i,n;if(i=this,0>t(e,i.key))i.left.isEmpty()||i.left.isRed_()||i.left.left.isRed_()||(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),i.right.isEmpty()||i.right.isRed_()||i.right.left.isRed_()||(i=i.moveRedRight_()),0===t(e,i.key))if(i.right.isEmpty())return eQ.EMPTY_NODE;else n=i.right.min_(),i=i.copy(n.key,n.value,null,null,i.right.removeMin_());i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}rotateLeft_(){let e=this.copy(null,null,eG.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){let e=this.copy(null,null,eG.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){return Math.pow(2,this.check_())<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw Error("Right child of ("+this.key+","+this.value+") is red");let e=this.left.check_();if(e===this.right.check_())return e+ +!this.isRed_();throw Error("Black depths differ")}}eG.RED=!0,eG.BLACK=!1;class eY{copy(e,t,i,n,r){return this}insert(e,t,i){return new eG(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class eQ{constructor(e,t=eQ.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new eQ(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,eG.BLACK,null,null))}remove(e){return new eQ(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,eG.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(0===(t=this.comparator_(e,i.key)))return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,n=null;for(;!i.isEmpty();){if(0===(t=this.comparator_(e,i.key)))if(i.left.isEmpty())if(n)return n.key;else return null;else{for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}t<0?i=i.left:t>0&&(n=i,i=i.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new e$(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new e$(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new e$(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new e$(this.root_,null,this.comparator_,!0,e)}}function eJ(e,t){return V(e.name,t.name)}function eZ(e,t){return V(e,t)}eQ.EMPTY_NODE=new eY;let eX=function(e){return"number"==typeof e?"number:"+Q(e):"string:"+e},e0=function(e){if(e.isLeafNode()){let t=e.val();(0,_.vA)("string"==typeof t||"number"==typeof t||"object"==typeof t&&(0,_.gR)(t,".sv"),"Priority must be a string or number.")}else(0,_.vA)(e===r||e.isEmpty(),"priority of unexpected type.");(0,_.vA)(e===r||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};class e1{static set __childrenNodeConstructor(e){s=e}static get __childrenNodeConstructor(){return s}constructor(e,t=e1.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,(0,_.vA)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),e0(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new e1(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:e1.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ex(e)?this:".priority"===eT(e)?this.priorityNode_:e1.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:e1.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){let i=eT(e);return null===i?t:t.isEmpty()&&".priority"!==i?this:((0,_.vA)(".priority"!==i||1===ek(e),".priority must be the last token in a path"),this.updateImmediateChild(i,e1.__childrenNodeConstructor.EMPTY_NODE.updateChild(eN(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+eX(this.priorityNode_.val())+":");let t=typeof this.value_;e+=t+":","number"===t?e+=Q(this.value_):e+=this.value_,this.lazyHash_=R(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===e1.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof e1.__childrenNodeConstructor?-1:((0,_.vA)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){let t=typeof e.value_,i=typeof this.value_,n=e1.VALUE_TYPE_ORDER.indexOf(t),r=e1.VALUE_TYPE_ORDER.indexOf(i);return((0,_.vA)(n>=0,"Unknown leaf type: "+t),(0,_.vA)(r>=0,"Unknown leaf type: "+i),n!==r)?r-n:"object"===i?0:this.value_<e.value_?-1:1*(this.value_!==e.value_)}withIndex(){return this}isIndexed(){return!0}equals(e){return e===this||!!e.isLeafNode()&&this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}}e1.VALUE_TYPE_ORDER=["object","boolean","number","string"];class e2 extends eV{compare(e,t){let i=e.node.getPriority(),n=t.node.getPriority(),r=i.compareTo(n);return 0===r?V(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ej.MIN}maxPost(){return new ej(j,new e1("[PRIORITY-POST]",a))}makePost(e,t){return new ej(t,new e1("[PRIORITY-POST]",o(e)))}toString(){return".priority"}}let e3=new e2,e4=Math.log(2);class e6{constructor(e){this.count=parseInt(Math.log(e+1)/e4,10),this.current_=this.count-1;let t=parseInt(Array(this.count+1).join("1"),2);this.bits_=e+1&t}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}}let e8=function(e,t,i,n){e.sort(t);let r=function(t,n){let s,o,a=n-t;if(0===a)return null;if(1===a)return s=e[t],new eG(i?i(s):s,s.node,eG.BLACK,null,null);{let o=parseInt(a/2,10)+t,l=r(t,o),h=r(o+1,n);return s=e[o],new eG(i?i(s):s,s.node,eG.BLACK,l,h)}};return new eQ(n||t,function(t){let n=null,s=null,o=e.length,a=function(t,n){let s=o-t,a=o;o-=t;let h=r(s+1,a),c=e[s];l(new eG(i?i(c):c,c.node,n,null,h))},l=function(e){n?n.left=e:s=e,n=e};for(let e=0;e<t.count;++e){let i=t.nextBitIsOne(),n=Math.pow(2,t.count-(e+1));i?a(n,eG.BLACK):(a(n,eG.BLACK),a(n,eG.RED))}return s}(new e6(e.length)))},e5={};class e7{static get Default(){return(0,_.vA)(e5&&e3,"ChildrenNode.ts has not been loaded"),l=l||new e7({".priority":e5},{".priority":e3})}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=(0,_.yw)(this.indexes_,e);if(!t)throw Error("No index defined for "+e);return t instanceof eQ?t:null}hasIndex(e){return(0,_.gR)(this.indexSet_,e.toString())}addIndex(e,t){let i;(0,_.vA)(e!==eK,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let n=[],r=!1,s=t.getIterator(ej.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=s.getNext();i=r?e8(n,e.getCompare()):e5;let a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;let h=Object.assign({},this.indexes_);return h[a]=i,new e7(h,l)}addToIndexes(e,t){return new e7((0,_.kH)(this.indexes_,(i,n)=>{let r=(0,_.yw)(this.indexSet_,n);if((0,_.vA)(r,"Missing index implementation for "+n),i===e5)if(!r.isDefinedOn(e.node))return e5;else{let i=[],n=t.getIterator(ej.Wrap),s=n.getNext();for(;s;)s.name!==e.name&&i.push(s),s=n.getNext();return i.push(e),e8(i,r.getCompare())}{let n=t.get(e.name),r=i;return n&&(r=r.remove(new ej(e.name,n))),r.insert(e,e.node)}}),this.indexSet_)}removeFromIndexes(e,t){return new e7((0,_.kH)(this.indexes_,i=>{if(i===e5)return i;{let n=t.get(e.name);return n?i.remove(new ej(e.name,n)):i}}),this.indexSet_)}}class e9{static get EMPTY_NODE(){return h||(h=new e9(new eQ(eZ),null,e7.Default))}constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&e0(this.priorityNode_),this.children_.isEmpty()&&(0,_.vA)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||h}updatePriority(e){return this.children_.isEmpty()?this:new e9(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{let t=this.children_.get(e);return null===t?h:t}}getChild(e){let t=eT(e);return null===t?this:this.getImmediateChild(t).getChild(eN(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if((0,_.vA)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{let i,n,r=new ej(e,t);t.isEmpty()?(i=this.children_.remove(e),n=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),n=this.indexMap_.addToIndexes(r,this.children_));let s=i.isEmpty()?h:this.priorityNode_;return new e9(i,s,n)}}updateChild(e,t){let i=eT(e);if(null===i)return t;{(0,_.vA)(".priority"!==eT(e)||1===ek(e),".priority must be the last token in a path");let n=this.getImmediateChild(i).updateChild(eN(e),t);return this.updateImmediateChild(i,n)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;let t={},i=0,n=0,r=!0;if(this.forEachChild(e3,(s,o)=>{t[s]=o.val(e),i++,r&&e9.INTEGER_REGEXP_.test(s)?n=Math.max(n,Number(s)):r=!1}),e||!r||!(n<2*i))return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t;{let e=[];for(let i in t)e[i]=t[i];return e}}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+eX(this.getPriority().val())+":"),this.forEachChild(e3,(t,i)=>{let n=i.hash();""!==n&&(e+=":"+t+":"+n)}),this.lazyHash_=""===e?"":R(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){let n=this.resolveIndex_(i);if(!n)return this.children_.getPredecessorKey(e);{let i=n.getPredecessorKey(new ej(e,t));return i?i.name:null}}getFirstChildName(e){let t=this.resolveIndex_(e);if(!t)return this.children_.minKey();{let e=t.minKey();return e&&e.name}}getFirstChild(e){let t=this.getFirstChildName(e);return t?new ej(t,this.children_.get(t)):null}getLastChildName(e){let t=this.resolveIndex_(e);if(!t)return this.children_.maxKey();{let e=t.maxKey();return e&&e.name}}getLastChild(e){let t=this.getLastChildName(e);return t?new ej(t,this.children_.get(t)):null}forEachChild(e,t){let i=this.resolveIndex_(e);return i?i.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){let i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,e=>e);{let i=this.children_.getIteratorFrom(e.name,ej.Wrap),n=i.peek();for(;null!=n&&0>t.compare(n,e);)i.getNext(),n=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){let i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,e=>e);{let i=this.children_.getReverseIteratorFrom(e.name,ej.Wrap),n=i.peek();for(;null!=n&&t.compare(n,e)>0;)i.getNext(),n=i.peek();return i}}compareTo(e){if(this.isEmpty())if(e.isEmpty())return 0;else return -1;return e.isLeafNode()||e.isEmpty()?1:e===tt?-1:0}withIndex(e){if(e===eK||this.indexMap_.hasIndex(e))return this;{let t=this.indexMap_.addIndex(e,this.children_);return new e9(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===eK||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode()||!this.getPriority().equals(e.getPriority()))return!1;if(this.children_.count()!==e.children_.count())return!1;{let t=this.getIterator(e3),i=e.getIterator(e3),n=t.getNext(),r=i.getNext();for(;n&&r;){if(n.name!==r.name||!n.node.equals(r.node))return!1;n=t.getNext(),r=i.getNext()}return null===n&&null===r}}resolveIndex_(e){return e===eK?null:this.indexMap_.get(e.toString())}}e9.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class te extends e9{constructor(){super(new eQ(eZ),e9.EMPTY_NODE,e7.Default)}compareTo(e){return+(e!==this)}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return e9.EMPTY_NODE}isEmpty(){return!1}}let tt=new te;function ti(e,t=null){if(null===e)return e9.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),(0,_.vA)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new e1(e,ti(t));if(e instanceof Array){let i=e9.EMPTY_NODE;return Y(e,(t,n)=>{if((0,_.gR)(e,t)&&"."!==t.substring(0,1)){let e=ti(n);(e.isLeafNode()||!e.isEmpty())&&(i=i.updateImmediateChild(t,e))}}),i.updatePriority(ti(t))}{let i=[],n=!1;if(Y(e,(e,t)=>{if("."!==e.substring(0,1)){let r=ti(t);r.isEmpty()||(n=n||!r.getPriority().isEmpty(),i.push(new ej(e,r)))}}),0===i.length)return e9.EMPTY_NODE;let r=e8(i,eJ,e=>e.name,eZ);if(!n)return new e9(r,ti(t),e7.Default);{let e=e8(i,e3.getCompare());return new e9(r,ti(t),new e7({".priority":e},{".priority":e3}))}}}Object.defineProperties(ej,{MIN:{value:new ej(W,e9.EMPTY_NODE)},MAX:{value:new ej(j,tt)}}),ez.__EMPTY_NODE=e9.EMPTY_NODE,e1.__childrenNodeConstructor=e9,r=tt,a=tt,o=ti;class tn extends eV{constructor(e){super(),this.indexPath_=e,(0,_.vA)(!ex(e)&&".priority"!==eT(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let i=this.extractChild(e.node),n=this.extractChild(t.node),r=i.compareTo(n);return 0===r?V(e.name,t.name):r}makePost(e,t){let i=ti(e);return new ej(t,e9.EMPTY_NODE.updateChild(this.indexPath_,i))}maxPost(){return new ej(j,e9.EMPTY_NODE.updateChild(this.indexPath_,tt))}toString(){return eO(this.indexPath_,0).join("/")}}class tr extends eV{compare(e,t){let i=e.node.compareTo(t.node);return 0===i?V(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ej.MIN}maxPost(){return ej.MAX}makePost(e,t){return new ej(t,ti(e))}toString(){return".value"}}let ts=new tr;function to(e){return{type:"value",snapshotNode:e}}function ta(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function tl(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function th(e,t,i){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:i}}class tc{constructor(e){this.index_=e}updateChild(e,t,i,n,r,s){(0,_.vA)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let o=e.getImmediateChild(t);return o.getChild(n).equals(i.getChild(n))&&o.isEmpty()===i.isEmpty()||(null!=s&&(i.isEmpty()?e.hasChild(t)?s.trackChildChange(tl(t,o)):(0,_.vA)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(ta(t,i)):s.trackChildChange(th(t,i,o))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return null!=i&&(e.isLeafNode()||e.forEachChild(e3,(e,n)=>{t.hasChild(e)||i.trackChildChange(tl(e,n))}),t.isLeafNode()||t.forEachChild(e3,(t,n)=>{if(e.hasChild(t)){let r=e.getImmediateChild(t);r.equals(n)||i.trackChildChange(th(t,n,r))}else i.trackChildChange(ta(t,n))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?e9.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class tu{constructor(e){this.indexedFilter_=new tc(e.getIndex()),this.index_=e.getIndex(),this.startPost_=tu.getStartPost_(e),this.endPost_=tu.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?0>=this.index_.compare(this.getStartPost(),e):0>this.index_.compare(this.getStartPost(),e),i=this.endIsInclusive_?0>=this.index_.compare(e,this.getEndPost()):0>this.index_.compare(e,this.getEndPost());return t&&i}updateChild(e,t,i,n,r,s){return this.matches(new ej(t,i))||(i=e9.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,n,r,s)}updateFullNode(e,t,i){t.isLeafNode()&&(t=e9.EMPTY_NODE);let n=t.withIndex(this.index_);n=n.updatePriority(e9.EMPTY_NODE);let r=this;return t.forEachChild(e3,(e,t)=>{r.matches(new ej(e,t))||(n=n.updateImmediateChild(e,e9.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,n,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(!e.hasStart())return e.getIndex().minPost();{let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}}static getEndPost_(e){if(!e.hasEnd())return e.getIndex().maxPost();{let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}}}class td{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{let t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{let t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new tu(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,n,r,s){return(this.rangedFilter_.matches(new ej(t,i))||(i=e9.EMPTY_NODE),e.getImmediateChild(t).equals(i))?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,n,r,s):this.fullLimitUpdateChild_(e,t,i,r,s)}updateFullNode(e,t,i){let n;if(t.isLeafNode()||t.isEmpty())n=e9.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;n=e9.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let i=0;for(;e.hasNext()&&i<this.limit_;){let t=e.getNext();if(this.withinDirectionalStart(t))if(this.withinDirectionalEnd(t))n=n.updateImmediateChild(t.name,t.node),i++;else break}}else{let e;n=(n=t.withIndex(this.index_)).updatePriority(e9.EMPTY_NODE),e=this.reverse_?n.getReverseIterator(this.index_):n.getIterator(this.index_);let i=0;for(;e.hasNext();){let t=e.getNext();i<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?i++:n=n.updateImmediateChild(t.name,e9.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,n,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,n,r){let s;if(this.reverse_){let e=this.index_.getCompare();s=(t,i)=>e(i,t)}else s=this.index_.getCompare();(0,_.vA)(e.numChildren()===this.limit_,"");let o=new ej(t,i),a=this.reverse_?e.getFirstChild(this.index_):e.getLastChild(this.index_),l=this.rangedFilter_.matches(o);if(e.hasChild(t)){let h=e.getImmediateChild(t),c=n.getChildAfterChild(this.index_,a,this.reverse_);for(;null!=c&&(c.name===t||e.hasChild(c.name));)c=n.getChildAfterChild(this.index_,c,this.reverse_);let u=null==c?1:s(c,o);if(l&&!i.isEmpty()&&u>=0)return null!=r&&r.trackChildChange(th(t,i,h)),e.updateImmediateChild(t,i);{null!=r&&r.trackChildChange(tl(t,h));let i=e.updateImmediateChild(t,e9.EMPTY_NODE);return null!=c&&this.rangedFilter_.matches(c)?(null!=r&&r.trackChildChange(ta(c.name,c.node)),i.updateImmediateChild(c.name,c.node)):i}}return i.isEmpty()?e:l?s(a,o)>=0?(null!=r&&(r.trackChildChange(tl(a.name,a.node)),r.trackChildChange(ta(t,i))),e.updateImmediateChild(t,i).updateImmediateChild(a.name,e9.EMPTY_NODE)):e:e}}class tp{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=e3}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,_.vA)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return((0,_.vA)(this.startSet_,"Only valid if start has been set"),this.startNameSet_)?this.indexStartName_:W}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,_.vA)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return((0,_.vA)(this.endSet_,"Only valid if end has been set"),this.endNameSet_)?this.indexEndName_:j}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,_.vA)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===e3}copy(){let e=new tp;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function tf(e,t,i){let n=e.copy();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=i?(n.startNameSet_=!0,n.indexStartName_=i):(n.startNameSet_=!1,n.indexStartName_=""),n}function t_(e,t,i){let n=e.copy();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==i?(n.endNameSet_=!0,n.indexEndName_=i):(n.endNameSet_=!1,n.indexEndName_=""),n}function tg(e,t){let i=e.copy();return i.index_=t,i}function tm(e){let t,i={};if(e.isDefault())return i;if(e.index_===e3?t="$priority":e.index_===ts?t="$value":e.index_===eK?t="$key":((0,_.vA)(e.index_ instanceof tn,"Unrecognized index type!"),t=e.index_.toString()),i.orderBy=(0,_.As)(t),e.startSet_){let t=e.startAfterSet_?"startAfter":"startAt";i[t]=(0,_.As)(e.indexStartValue_),e.startNameSet_&&(i[t]+=","+(0,_.As)(e.indexStartName_))}if(e.endSet_){let t=e.endBeforeSet_?"endBefore":"endAt";i[t]=(0,_.As)(e.indexEndValue_),e.endNameSet_&&(i[t]+=","+(0,_.As)(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?i.limitToFirst=e.limit_:i.limitToLast=e.limit_),i}function tv(e){let t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let i=e.viewFrom_;""===i&&(i=e.isViewFromLeft()?"l":"r"),t.vf=i}return e.index_!==e3&&(t.i=e.index_.toString()),t}class ty extends eC{reportStats(e){throw Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,_.vA)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,n){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=n,this.log_=L("p:rest:"),this.listens_={}}listen(e,t,i,n){let r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);let s=ty.getListenId_(e,i),o={};this.listens_[s]=o;let a=tm(e._queryParams);this.restRequest_(r+".json",a,(e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(r,a,!1,i),(0,_.yw)(this.listens_,s)===o){let t;n(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}})}unlisten(e,t){let i=ty.getListenId_(e,t);delete this.listens_[i]}get(e){let t=tm(e._queryParams),i=e._path.toString(),n=new _.cY;return this.restRequest_(i+".json",t,(e,t)=>{let r=t;404===e&&(r=null,e=null),null===e?(this.onDataUpdate_(i,r,!1,null),n.resolve(r)):n.reject(Error(r))}),n.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([n,r])=>{n&&n.accessToken&&(t.auth=n.accessToken),r&&r.token&&(t.ac=r.token);let s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,_.Am)(t);this.log_("Sending REST request for "+s);let o=new XMLHttpRequest;o.onreadystatechange=()=>{if(i&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=(0,_.$L)(o.responseText)}catch(e){U("Failed to parse JSON response for "+s+": "+o.responseText)}i(null,e)}else 401!==o.status&&404!==o.status&&U("Got unsuccessful REST response for "+s+" Status: "+o.status),i(o.status);i=null}},o.open("GET",s,!0),o.send()})}}class tE{constructor(){this.rootNode_=e9.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function tC(){return{value:null,children:new Map}}function tw(e,t,i){if(ex(t))e.value=i,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,i);else{let n=eT(t);e.children.has(n)||e.children.set(n,tC()),tw(e.children.get(n),t=eN(t),i)}}function tb(e,t,i){var n,r;null!==e.value?i(t,e.value):(n=e,r=(e,n)=>{tb(n,new eI(t.toString()+"/"+e),i)},n.children.forEach((e,t)=>{r(t,e)}))}class tI{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Y(this.last_,(e,i)=>{t[e]=t[e]-i}),this.last_=e,t}}class tS{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new tI(e);let i=1e4+2e4*Math.random();ee(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),t={},i=!1;Y(e,(e,n)=>{n>0&&(0,_.gR)(this.statsToReport_,e)&&(t[e]=n,i=!0)}),i&&this.server_.reportStats(t),ee(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}function tT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function tk(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function tN(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(p||(p={}));class tR{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=p.ACK_USER_WRITE,this.source=tT()}operationForChild(e){if(!ex(this.path))return(0,_.vA)(eT(this.path)===e,"operationForChild called for unrelated child."),new tR(eN(this.path),this.affectedTree,this.revert);if(null!=this.affectedTree.value)return(0,_.vA)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new eI(e));return new tR(eS(),t,this.revert)}}}class tO{constructor(e,t){this.source=e,this.path=t,this.type=p.LISTEN_COMPLETE}operationForChild(e){return ex(this.path)?new tO(this.source,eS()):new tO(this.source,eN(this.path))}}class tA{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=p.OVERWRITE}operationForChild(e){return ex(this.path)?new tA(this.source,eS(),this.snap.getImmediateChild(e)):new tA(this.source,eN(this.path),this.snap)}}class tP{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=p.MERGE}operationForChild(e){if(!ex(this.path))return(0,_.vA)(eT(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new tP(this.source,eN(this.path),this.children);{let t=this.children.subtree(new eI(e));return t.isEmpty()?null:t.value?new tA(this.source,eS(),t.value):new tP(this.source,eS(),t)}}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class tx{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ex(e))return this.isFullyInitialized()&&!this.filtered_;let t=eT(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class tD{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function tL(e,t,i,n,r,s){let o=n.filter(e=>e.type===i);o.sort((t,i)=>(function(e,t,i){if(null==t.childName||null==i.childName)throw(0,_.Hk)("Should only compare child_ events.");let n=new ej(t.childName,t.snapshotNode),r=new ej(i.childName,i.snapshotNode);return e.index_.compare(n,r)})(e,t,i)),o.forEach(i=>{var n,o,a;let l=(n=e,o=i,a=s,"value"===o.type||"child_removed"===o.type||(o.prevName=a.getPredecessorChildName(o.childName,o.snapshotNode,n.index_)),o);r.forEach(n=>{n.respondsTo(i.type)&&t.push(n.createEvent(l,e.query_))})})}function tM(e,t){return{eventCache:e,serverCache:t}}function tF(e,t,i,n){return tM(new tx(t,i,n),e.serverCache)}function tU(e,t,i,n){return tM(e.eventCache,new tx(t,i,n))}function tH(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function tq(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let tB=()=>(c||(c=new eQ(z)),c);class tW{static fromObject(e){let t=new tW(null);return Y(e,(e,i)=>{t=t.set(new eI(e),i)}),t}constructor(e,t=tB()){this.value=e,this.children=t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:eS(),value:this.value};{if(ex(e))return null;let i=eT(e),n=this.children.get(i);if(null===n)return null;{let r=n.findRootMostMatchingPathAndValue(eN(e),t);return null!=r?{path:eP(new eI(i),r.path),value:r.value}:null}}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ex(e))return this;{let t=eT(e),i=this.children.get(t);return null!==i?i.subtree(eN(e)):new tW(null)}}set(e,t){if(ex(e))return new tW(t,this.children);{let i=eT(e),n=(this.children.get(i)||new tW(null)).set(eN(e),t),r=this.children.insert(i,n);return new tW(this.value,r)}}remove(e){if(ex(e))if(this.children.isEmpty())return new tW(null);else return new tW(null,this.children);{let t=eT(e),i=this.children.get(t);if(!i)return this;{let n,r=i.remove(eN(e));return(n=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&n.isEmpty())?new tW(null):new tW(this.value,n)}}}get(e){if(ex(e))return this.value;{let t=eT(e),i=this.children.get(t);return i?i.get(eN(e)):null}}setTree(e,t){if(ex(e))return t;{let i,n=eT(e),r=(this.children.get(n)||new tW(null)).setTree(eN(e),t);return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new tW(this.value,i)}}fold(e){return this.fold_(eS(),e)}fold_(e,t){let i={};return this.children.inorderTraversal((n,r)=>{i[n]=r.fold_(eP(e,n),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,eS(),t)}findOnPath_(e,t,i){let n=!!this.value&&i(t,this.value);if(n)return n;{if(ex(e))return null;let n=eT(e),r=this.children.get(n);return r?r.findOnPath_(eN(e),eP(t,n),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,eS(),t)}foreachOnPath_(e,t,i){if(ex(e))return this;{this.value&&i(t,this.value);let n=eT(e),r=this.children.get(n);return r?r.foreachOnPath_(eN(e),eP(t,n),i):new tW(null)}}foreach(e){this.foreach_(eS(),e)}foreach_(e,t){this.children.inorderTraversal((i,n)=>{n.foreach_(eP(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}class tj{constructor(e){this.writeTree_=e}static empty(){return new tj(new tW(null))}}function tV(e,t,i){if(ex(t))return new tj(new tW(i));{let n=e.writeTree_.findRootMostValueAndPath(t);if(null!=n){let r=n.path,s=n.value,o=eD(r,t);return s=s.updateChild(o,i),new tj(e.writeTree_.set(r,s))}{let n=new tW(i);return new tj(e.writeTree_.setTree(t,n))}}}function tz(e,t,i){let n=e;return Y(i,(e,i)=>{n=tV(n,eP(t,e),i)}),n}function tK(e,t){return ex(t)?tj.empty():new tj(e.writeTree_.setTree(t,new tW(null)))}function t$(e,t){return null!=tG(e,t)}function tG(e,t){let i=e.writeTree_.findRootMostValueAndPath(t);return null!=i?e.writeTree_.get(i.path).getChild(eD(i.path,t)):null}function tY(e){let t=[],i=e.writeTree_.value;return null!=i?i.isLeafNode()||i.forEachChild(e3,(e,i)=>{t.push(new ej(e,i))}):e.writeTree_.children.inorderTraversal((e,i)=>{null!=i.value&&t.push(new ej(e,i.value))}),t}function tQ(e,t){if(ex(t))return e;{let i=tG(e,t);return new tj(null!=i?new tW(i):e.writeTree_.subtree(t))}}function tJ(e){return e.writeTree_.isEmpty()}function tZ(e,t){return function e(t,i,n){if(null!=i.value)return n.updateChild(t,i.value);{let r=null;return i.children.inorderTraversal((i,s)=>{".priority"===i?((0,_.vA)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):n=e(eP(t,i),s,n)}),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(eP(t,".priority"),r)),n}}(eS(),e.writeTree_,t)}function tX(e){return e.visible}function t0(e,t,i){let n=tj.empty();for(let r=0;r<e.length;++r){let s=e[r];if(t(s)){let e,t=s.path;if(s.snap)eF(i,t)?n=tV(n,e=eD(i,t),s.snap):eF(t,i)&&(e=eD(t,i),n=tV(n,eS(),s.snap.getChild(e)));else if(s.children){if(eF(i,t))n=tz(n,e=eD(i,t),s.children);else if(eF(t,i))if(ex(e=eD(t,i)))n=tz(n,eS(),s.children);else{let t=(0,_.yw)(s.children,eT(e));if(t){let i=t.getChild(eN(e));n=tV(n,eS(),i)}}}else throw(0,_.Hk)("WriteRecord should have .snap or .children")}}return n}function t1(e,t,i,n,r){if(n||r){let s=tQ(e.visibleWrites,t);return!r&&tJ(s)?i:r||null!=i||t$(s,eS())?tZ(t0(e.allWrites,function(e){return(e.visible||r)&&(!n||!~n.indexOf(e.writeId))&&(eF(e.path,t)||eF(t,e.path))},t),i||e9.EMPTY_NODE):null}{let n=tG(e.visibleWrites,t);if(null!=n)return n;{let n=tQ(e.visibleWrites,t);return tJ(n)?i:null!=i||t$(n,eS())?tZ(n,i||e9.EMPTY_NODE):null}}}function t2(e,t,i,n){return t1(e.writeTree,e.treePath,t,i,n)}function t3(e,t){return function(e,t,i){let n=e9.EMPTY_NODE,r=tG(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(e3,(e,t)=>{n=n.updateImmediateChild(e,t)}),n;if(!i)return tY(tQ(e.visibleWrites,t)).forEach(e=>{n=n.updateImmediateChild(e.name,e.node)}),n;{let r=tQ(e.visibleWrites,t);return i.forEachChild(e3,(e,t)=>{let i=tZ(tQ(r,new eI(e)),t);n=n.updateImmediateChild(e,i)}),tY(r).forEach(e=>{n=n.updateImmediateChild(e.name,e.node)}),n}}(e.writeTree,e.treePath,t)}function t4(e,t,i,n){return function(e,t,i,n,r){(0,_.vA)(n||r,"Either existingEventSnap or existingServerSnap must exist");let s=eP(t,i);if(t$(e.visibleWrites,s))return null;{let t=tQ(e.visibleWrites,s);return tJ(t)?r.getChild(i):tZ(t,r.getChild(i))}}(e.writeTree,e.treePath,t,i,n)}function t6(e,t){var i,n;return i=e.writeTree,n=eP(e.treePath,t),tG(i.visibleWrites,n)}function t8(e,t,i){return function(e,t,i,n){let r=eP(t,i),s=tG(e.visibleWrites,r);return null!=s?s:n.isCompleteForChild(i)?tZ(tQ(e.visibleWrites,r),n.getNode().getImmediateChild(i)):null}(e.writeTree,e.treePath,t,i)}function t5(e,t){return t7(eP(e.treePath,t),e.writeTree)}function t7(e,t){return{treePath:e,writeTree:t}}class t9{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,i=e.childName;(0,_.vA)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,_.vA)(".priority"!==i,"Only non-priority child changes can be tracked.");let n=this.changeMap.get(i);if(n){let r=n.type;if("child_added"===t&&"child_removed"===r)this.changeMap.set(i,th(i,e.snapshotNode,n.snapshotNode));else if("child_removed"===t&&"child_added"===r)this.changeMap.delete(i);else if("child_removed"===t&&"child_changed"===r)this.changeMap.set(i,tl(i,n.oldSnap));else if("child_changed"===t&&"child_added"===r)this.changeMap.set(i,ta(i,e.snapshotNode));else if("child_changed"===t&&"child_changed"===r)this.changeMap.set(i,th(i,e.snapshotNode,n.oldSnap));else throw(0,_.Hk)("Illegal combination of changes: "+e+" occurred after "+n)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}class ie{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}let it=new ie;class ii{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let t=null!=this.optCompleteServerCache_?new tx(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return t8(this.writes_,e,t)}}getChildAfterChild(e,t,i){var n;let r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:tq(this.viewCache_),s=(n=this.writes_,function(e,t,i,n,r,s,o){let a,l=tQ(e.visibleWrites,t),h=tG(l,eS());if(null!=h)a=h;else{if(null==i)return[];a=tZ(l,i)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];{let e=[],t=o.getCompare(),i=s?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),r=i.getNext();for(;r&&e.length<1;)0!==t(r,n)&&e.push(r),r=i.getNext();return e}}(n.writeTree,n.treePath,r,t,1,i,e));return 0===s.length?null:s[0]}}function ir(e,t,i,n,r,s){let o=t.eventCache;if(null!=t6(n,i))return t;{let a,l;if(ex(i))if((0,_.vA)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){let i=tq(t),r=t3(n,i instanceof e9?i:e9.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),r,s)}else{let i=t2(n,tq(t));a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{let h=eT(i);if(".priority"===h){(0,_.vA)(1===ek(i),"Can't have a priority with additional path components");let r=o.getNode(),s=t4(n,i,r,l=t.serverCache.getNode());a=null!=s?e.filter.updatePriority(r,s):o.getNode()}else{let c,u=eN(i);if(o.isCompleteForChild(h)){l=t.serverCache.getNode();let e=t4(n,i,o.getNode(),l);c=null!=e?o.getNode().getImmediateChild(h).updateChild(u,e):o.getNode().getImmediateChild(h)}else c=t8(n,h,t.serverCache);a=null!=c?e.filter.updateChild(o.getNode(),h,c,u,r,s):o.getNode()}}return tF(t,a,o.isFullyInitialized()||ex(i),e.filter.filtersNodes())}}function is(e,t,i,n,r,s,o,a){let l,h=t.serverCache,c=o?e.filter:e.filter.getIndexedFilter();if(ex(i))l=c.updateFullNode(h.getNode(),n,null);else if(c.filtersNodes()&&!h.isFiltered()){let e=h.getNode().updateChild(i,n);l=c.updateFullNode(h.getNode(),e,null)}else{let e=eT(i);if(!h.isCompleteForPath(i)&&ek(i)>1)return t;let r=eN(i),s=h.getNode().getImmediateChild(e).updateChild(r,n);l=".priority"===e?c.updatePriority(h.getNode(),s):c.updateChild(h.getNode(),e,s,r,it,null)}let u=tU(t,l,h.isFullyInitialized()||ex(i),c.filtersNodes()),d=new ii(r,u,s);return ir(e,u,i,r,d,a)}function io(e,t,i,n,r,s,o){let a,l,h=t.eventCache,c=new ii(r,t,s);if(ex(i))l=e.filter.updateFullNode(t.eventCache.getNode(),n,o),a=tF(t,l,!0,e.filter.filtersNodes());else{let r=eT(i);if(".priority"===r)l=e.filter.updatePriority(t.eventCache.getNode(),n),a=tF(t,l,h.isFullyInitialized(),h.isFiltered());else{let s,l=eN(i),u=h.getNode().getImmediateChild(r);if(ex(l))s=n;else{let e=c.getCompleteChild(r);s=null!=e?".priority"===eR(l)&&e.getChild(eA(l)).isEmpty()?e:e.updateChild(l,n):e9.EMPTY_NODE}a=u.equals(s)?t:tF(t,e.filter.updateChild(h.getNode(),r,s,l,c,o),h.isFullyInitialized(),e.filter.filtersNodes())}}return a}function ia(e,t){return e.eventCache.isCompleteForChild(t)}function il(e,t,i){return i.foreach((e,i)=>{t=t.updateChild(e,i)}),t}function ih(e,t,i,n,r,s,o,a){let l;if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let h=t;l=ex(i)?n:new tW(null).setTree(i,n);let c=t.serverCache.getNode();return l.children.inorderTraversal((i,n)=>{if(c.hasChild(i)){let l=il(e,t.serverCache.getNode().getImmediateChild(i),n);h=is(e,h,new eI(i),l,r,s,o,a)}}),l.children.inorderTraversal((i,n)=>{let l=!t.serverCache.isCompleteForChild(i)&&null===n.value;if(!c.hasChild(i)&&!l){let l=il(e,t.serverCache.getNode().getImmediateChild(i),n);h=is(e,h,new eI(i),l,r,s,o,a)}}),h}class ic{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,n=new tc(i.getIndex()),r=function(e){return e.loadsAllData()?new tc(e.getIndex()):e.hasLimit()?new td(e):new tu(e)}(i);this.processor_={filter:r};let s=t.serverCache,o=t.eventCache,a=n.updateFullNode(e9.EMPTY_NODE,s.getNode(),null),l=r.updateFullNode(e9.EMPTY_NODE,o.getNode(),null),h=new tx(a,s.isFullyInitialized(),n.filtersNodes()),c=new tx(l,o.isFullyInitialized(),r.filtersNodes());this.viewCache_=tM(c,h),this.eventGenerator_=new tD(this.query_)}get query(){return this.query_}}function iu(e){return 0===e.eventRegistrations_.length}function id(e,t,i){let n=[];if(i){(0,_.vA)(null==t,"A cancel should cancel all event registrations.");let r=e.query._path;e.eventRegistrations_.forEach(e=>{let t=e.createCancelEvent(i,r);t&&n.push(t)})}if(t){let i=[];for(let n=0;n<e.eventRegistrations_.length;++n){let r=e.eventRegistrations_[n];if(r.matches(t)){if(t.hasAnyCallback()){i=i.concat(e.eventRegistrations_.slice(n+1));break}}else i.push(r)}e.eventRegistrations_=i}else e.eventRegistrations_=[];return n}function ip(e,t,i,n){var r,s;t.type===p.MERGE&&null!==t.source.queryId&&((0,_.vA)(tq(e.viewCache_),"We should always have a full cache before handling merges"),(0,_.vA)(tH(e.viewCache_),"Missing event cache, even though we have a server cache"));let o=e.viewCache_,a=function(e,t,i,n,r){let s,o,a=new t9;if(i.type===p.OVERWRITE)i.source.fromUser?s=io(e,t,i.path,i.snap,n,r,a):((0,_.vA)(i.source.fromServer,"Unknown source."),o=i.source.tagged||t.serverCache.isFiltered()&&!ex(i.path),s=is(e,t,i.path,i.snap,n,r,o,a));else if(i.type===p.MERGE){var l,h,c,u,d,f,g;let p;i.source.fromUser?(l=e,h=t,c=i.path,u=i.children,d=n,f=r,g=a,p=h,u.foreach((e,t)=>{let i=eP(c,e);ia(h,eT(i))&&(p=io(l,p,i,t,d,f,g))}),u.foreach((e,t)=>{let i=eP(c,e);ia(h,eT(i))||(p=io(l,p,i,t,d,f,g))}),s=p):((0,_.vA)(i.source.fromServer,"Unknown source."),o=i.source.tagged||t.serverCache.isFiltered(),s=ih(e,t,i.path,i.children,n,r,o,a))}else if(i.type===p.ACK_USER_WRITE)s=i.revert?function(e,t,i,n,r,s){let o;if(null!=t6(n,i))return t;{let a,l=new ii(n,t,r),h=t.eventCache.getNode();if(ex(i)||".priority"===eT(i)){let i;if(t.serverCache.isFullyInitialized())i=t2(n,tq(t));else{let e=t.serverCache.getNode();(0,_.vA)(e instanceof e9,"serverChildren would be complete if leaf node"),i=t3(n,e)}a=e.filter.updateFullNode(h,i,s)}else{let r=eT(i),c=t8(n,r,t.serverCache);null==c&&t.serverCache.isCompleteForChild(r)&&(c=h.getImmediateChild(r)),(a=null!=c?e.filter.updateChild(h,r,c,eN(i),l,s):t.eventCache.getNode().hasChild(r)?e.filter.updateChild(h,r,e9.EMPTY_NODE,eN(i),l,s):h).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=t2(n,tq(t))).isLeafNode()&&(a=e.filter.updateFullNode(a,o,s))}return o=t.serverCache.isFullyInitialized()||null!=t6(n,eS()),tF(t,a,o,e.filter.filtersNodes())}}(e,t,i.path,n,r,a):function(e,t,i,n,r,s,o){if(null!=t6(r,i))return t;let a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=n.value)if(ex(i)&&l.isFullyInitialized()||l.isCompleteForPath(i))return is(e,t,i,l.getNode().getChild(i),r,s,a,o);else{if(!ex(i))return t;let n=new tW(null);return l.getNode().forEachChild(eK,(e,t)=>{n=n.set(new eI(e),t)}),ih(e,t,i,n,r,s,a,o)}{let h=new tW(null);return n.foreach((e,t)=>{let n=eP(i,e);l.isCompleteForPath(n)&&(h=h.set(e,l.getNode().getChild(n)))}),ih(e,t,i,h,r,s,a,o)}}(e,t,i.path,i.affectedTree,n,r,a);else if(i.type===p.LISTEN_COMPLETE)s=function(e,t,i,n,r){let s=t.serverCache;return ir(e,tU(t,s.getNode(),s.isFullyInitialized()||ex(i),s.isFiltered()),i,n,it,r)}(e,t,i.path,n,a);else throw(0,_.Hk)("Unknown operation type: "+i.type);let m=a.getChanges();return function(e,t,i){let n=t.eventCache;if(n.isFullyInitialized()){let r=n.getNode().isLeafNode()||n.getNode().isEmpty(),s=tH(e);!(i.length>0)&&e.eventCache.isFullyInitialized()&&(!r||n.getNode().equals(s))&&n.getNode().getPriority().equals(s.getPriority())||i.push(to(tH(t)))}}(t,s,m),{viewCache:s,changes:m}}(e.processor_,o,t,i,n);return r=e.processor_,s=a.viewCache,(0,_.vA)(s.eventCache.getNode().isIndexed(r.filter.getIndex()),"Event snap not indexed"),(0,_.vA)(s.serverCache.getNode().isIndexed(r.filter.getIndex()),"Server snap not indexed"),(0,_.vA)(a.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,i_(e,a.changes,a.viewCache.eventCache.getNode(),null)}function i_(e,t,i,n){let r=n?[n]:e.eventRegistrations_;var s=e.eventGenerator_;let o=[],a=[];return t.forEach(e=>{var t;"child_changed"===e.type&&s.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&a.push((t=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:t}))}),tL(s,o,"child_removed",t,r,i),tL(s,o,"child_added",t,r,i),tL(s,o,"child_moved",a,r,i),tL(s,o,"child_changed",t,r,i),tL(s,o,"value",t,r,i),o}class ig{constructor(){this.views=new Map}}function im(e,t,i,n){let r=t.source.queryId;if(null!==r){let s=e.views.get(r);return(0,_.vA)(null!=s,"SyncTree gave us an op for an invalid query."),ip(s,t,i,n)}{let r=[];for(let s of e.views.values())r=r.concat(ip(s,t,i,n));return r}}function iv(e,t,i,n,r){let s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=t2(i,r?n:null),s=!1;return e?s=!0:(e=n instanceof e9?t3(i,n):e9.EMPTY_NODE,s=!1),new ic(t,tM(new tx(e,s,!1),new tx(n,r,!1)))}return o}function iy(e){let t=[];for(let i of e.views.values())i.query._queryParams.loadsAllData()||t.push(i);return t}function iE(e,t){let i=null;for(let n of e.views.values())i=i||function(e,t){let i=tq(e.viewCache_);return i&&(e.query._queryParams.loadsAllData()||!ex(t)&&!i.getImmediateChild(eT(t)).isEmpty())?i.getChild(t):null}(n,t);return i}function iC(e,t){if(t._queryParams.loadsAllData())return ib(e);{let i=t._queryIdentifier;return e.views.get(i)}}function iw(e){return null!=ib(e)}function ib(e){for(let t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let iI=1;class iS{constructor(e){this.listenProvider_=e,this.syncPointTree_=new tW(null),this.pendingWriteTree_={visibleWrites:tj.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function iT(e,t,i,n,r){var s,o;return(s=e.pendingWriteTree_,o=r,(0,_.vA)(n>s.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),s.allWrites.push({path:t,snap:i,writeId:n,visible:o}),o&&(s.visibleWrites=tV(s.visibleWrites,t,i)),s.lastWriteId=n,r)?ix(e,new tA(tT(),t,i)):[]}function ik(e,t,i=!1){let n=function(e,t){for(let i=0;i<e.allWrites.length;i++){let n=e.allWrites[i];if(n.writeId===t)return n}return null}(e.pendingWriteTree_,t);if(!function(e,t){var i;let n=e.allWrites.findIndex(e=>e.writeId===t);(0,_.vA)(n>=0,"removeWrite called with nonexistent writeId.");let r=e.allWrites[n];e.allWrites.splice(n,1);let s=r.visible,o=!1,a=e.allWrites.length-1;for(;s&&a>=0;){let t=e.allWrites[a];t.visible&&(a>=n&&function(e,t){if(e.snap)return eF(e.path,t);for(let i in e.children)if(e.children.hasOwnProperty(i)&&eF(eP(e.path,i),t))return!0;return!1}(t,r.path)?s=!1:eF(r.path,t.path)&&(o=!0)),a--}return!!s&&(o?((i=e).visibleWrites=t0(i.allWrites,tX,eS()),i.allWrites.length>0?i.lastWriteId=i.allWrites[i.allWrites.length-1].writeId:i.lastWriteId=-1):r.snap?e.visibleWrites=tK(e.visibleWrites,r.path):Y(r.children,t=>{e.visibleWrites=tK(e.visibleWrites,eP(r.path,t))}),!0)}(e.pendingWriteTree_,t))return[];{let t=new tW(null);return null!=n.snap?t=t.set(eS(),!0):Y(n.children,e=>{t=t.set(new eI(e),!0)}),ix(e,new tR(n.path,t,i))}}function iN(e,t,i){return ix(e,new tA(tk(),t,i))}function iR(e,t,i,n,r=!1){let s=t._path,o=e.syncPointTree_.get(s),a=[];if(o&&("default"===t._queryIdentifier||null!=iC(o,t))){let c=function(e,t,i,n){let r=t._queryIdentifier,s=[],o=[],a=iw(e);if("default"===r)for(let[t,r]of e.views.entries())o=o.concat(id(r,i,n)),iu(r)&&(e.views.delete(t),r.query._queryParams.loadsAllData()||s.push(r.query));else{let t=e.views.get(r);t&&(o=o.concat(id(t,i,n)),iu(t)&&(e.views.delete(r),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!iw(e)&&s.push(new((0,_.vA)(u,"Reference.ts has not been loaded"),u)(t._repo,t._path)),{removed:s,events:o}}(o,t,i,n);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));let d=c.removed;if(a=c.events,!r){let i=-1!==d.findIndex(e=>e._queryParams.loadsAllData()),r=e.syncPointTree_.findOnPath(s,(e,t)=>iw(t));if(i&&!r){let t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){let i=t.fold((e,t,i)=>{if(t&&iw(t))return[ib(t)];{let e=[];return t&&(e=iy(t)),Y(i,(t,i)=>{e=e.concat(i)}),e}});for(let t=0;t<i.length;++t){let n=i[t],r=n.query,s=iD(e,n);e.listenProvider_.startListening(iq(r),iL(e,r),s.hashFn,s.onComplete)}}}r||!(d.length>0)||n||(i?e.listenProvider_.stopListening(iq(t),null):d.forEach(t=>{let i=e.queryToTagMap.get(iM(t));e.listenProvider_.stopListening(iq(t),i)}))}var l=e,h=d;for(let e=0;e<h.length;++e){let t=h[e];if(!t._queryParams.loadsAllData()){let e=iM(t),i=l.queryToTagMap.get(e);l.queryToTagMap.delete(e),l.tagToQueryMap.delete(i)}}}return a}function iO(e,t,i,n){let r=iF(e,n);if(null==r)return[];{let n=iU(r),s=n.path,o=n.queryId,a=eD(s,t);return iH(e,s,new tA(tN(o),a,i))}}function iA(e,t,i,n=!1){let r,s=t._path,o=null,a=!1;e.syncPointTree_.foreachOnPath(s,(e,t)=>{let i=eD(e,s);o=o||iE(t,i),a=a||iw(t)});let l=e.syncPointTree_.get(s);l?(a=a||iw(l),o=o||iE(l,eS())):(l=new ig,e.syncPointTree_=e.syncPointTree_.set(s,l)),null!=o?r=!0:(r=!1,o=e9.EMPTY_NODE,e.syncPointTree_.subtree(s).foreachChild((e,t)=>{let i=iE(t,eS());i&&(o=o.updateImmediateChild(e,i))}));let h=null!=iC(l,t);if(!h&&!t._queryParams.loadsAllData()){let i=iM(t);(0,_.vA)(!e.queryToTagMap.has(i),"View does not exist, but we have a tag");let n=iI++;e.queryToTagMap.set(i,n),e.tagToQueryMap.set(n,i)}let c=function(e,t,i,n,r,s){let o=iv(e,t,n,r,s);e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),o.eventRegistrations_.push(i);let a=o.viewCache_.eventCache,l=[];return a.getNode().isLeafNode()||a.getNode().forEachChild(e3,(e,t)=>{l.push(ta(e,t))}),a.isFullyInitialized()&&l.push(to(a.getNode())),i_(o,l,a.getNode(),i)}(l,t,i,t7(s,e.pendingWriteTree_),o,r);if(!h&&!a&&!n){let i=iC(l,t);c=c.concat(function(e,t,i){let n=t._path,r=iL(e,t),s=iD(e,i),o=e.listenProvider_.startListening(iq(t),r,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(n);if(r)(0,_.vA)(!iw(a.value),"If we're adding a query, it shouldn't be shadowed");else{let t=a.fold((e,t,i)=>{if(!ex(e)&&t&&iw(t))return[ib(t).query];{let e=[];return t&&(e=e.concat(iy(t).map(e=>e.query))),Y(i,(t,i)=>{e=e.concat(i)}),e}});for(let i=0;i<t.length;++i){let n=t[i];e.listenProvider_.stopListening(iq(n),iL(e,n))}}return o}(e,t,i))}return c}function iP(e,t,i){let n=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(t,(e,i)=>{let n=iE(i,eD(e,t));if(n)return n});return t1(n,t,r,i,!0)}function ix(e,t){var i;return function e(t,i,n,r){if(ex(t.path))return function e(t,i,n,r){let s=i.get(eS());null==n&&null!=s&&(n=iE(s,eS()));let o=[];return i.children.inorderTraversal((i,s)=>{let a=n?n.getImmediateChild(i):null,l=t5(r,i),h=t.operationForChild(i);h&&(o=o.concat(e(h,s,a,l)))}),s&&(o=o.concat(im(s,t,r,n))),o}(t,i,n,r);{let s=i.get(eS());null==n&&null!=s&&(n=iE(s,eS()));let o=[],a=eT(t.path),l=t.operationForChild(a),h=i.children.get(a);if(h&&l){let t=n?n.getImmediateChild(a):null,i=t5(r,a);o=o.concat(e(l,h,t,i))}return s&&(o=o.concat(im(s,t,r,n))),o}}(t,e.syncPointTree_,null,(i=e.pendingWriteTree_,t7(eS(),i)))}function iD(e,t){let i=t.query,n=iL(e,i);return{hashFn:()=>(t.viewCache_.serverCache.getNode()||e9.EMPTY_NODE).hash(),onComplete:t=>{if("ok"===t)if(n)return function(e,t,i){let n=iF(e,i);if(!n)return[];{let i=iU(n),r=i.path,s=i.queryId,o=eD(r,t);return iH(e,r,new tO(tN(s),o))}}(e,i._path,n);else{var r;return r=i._path,ix(e,new tO(tk(),r))}{let n=function(e,t){let i="Unknown Error";"too_big"===e?i="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?i="Client doesn't have permission to access the desired data.":"unavailable"===e&&(i="The service is unavailable");let n=Error(e+" at "+t._path.toString()+": "+i);return n.code=e.toUpperCase(),n}(t,i);return iR(e,i,null,n)}}}}function iL(e,t){let i=iM(t);return e.queryToTagMap.get(i)}function iM(e){return e._path.toString()+"$"+e._queryIdentifier}function iF(e,t){return e.tagToQueryMap.get(t)}function iU(e){let t=e.indexOf("$");return(0,_.vA)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new eI(e.substr(0,t))}}function iH(e,t,i){let n=e.syncPointTree_.get(t);return(0,_.vA)(n,"Missing sync point for query tag that we're tracking"),im(n,i,t7(t,e.pendingWriteTree_),null)}function iq(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new((0,_.vA)(d,"Reference.ts has not been loaded"),d)(e._repo,e._path):e}class iB{constructor(e){this.node_=e}getImmediateChild(e){return new iB(this.node_.getImmediateChild(e))}node(){return this.node_}}class iW{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=eP(this.path_,e);return new iW(this.syncTree_,t)}node(){return iP(this.syncTree_,this.path_)}}let ij=function(e,t,i){return e&&"object"==typeof e?((0,_.vA)(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"])?iV(e[".sv"],t,i):"object"==typeof e[".sv"]?iz(e[".sv"],t):void(0,_.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2)):e},iV=function(e,t,i){if("timestamp"===e)return i.timestamp;(0,_.vA)(!1,"Unexpected server value: "+e)},iz=function(e,t,i){e.hasOwnProperty("increment")||(0,_.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));let n=e.increment;"number"!=typeof n&&(0,_.vA)(!1,"Unexpected increment value: "+n);let r=t.node();if((0,_.vA)(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return n;let s=r.getValue();return"number"!=typeof s?n:s+n},iK=function(e,t,i,n){return iG(t,new iW(i,e),n)},i$=function(e,t,i){return iG(e,new iB(t),i)};function iG(e,t,i){let n,r=ij(e.getPriority().val(),t.getImmediateChild(".priority"),i);if(!e.isLeafNode())return n=e,r!==e.getPriority().val()&&(n=n.updatePriority(new e1(r))),e.forEachChild(e3,(e,r)=>{let s=iG(r,t.getImmediateChild(e),i);s!==r&&(n=n.updateImmediateChild(e,s))}),n;{let n=ij(e.getValue(),t,i);return n!==e.getValue()||r!==e.getPriority().val()?new e1(n,ti(r)):e}}class iY{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function iQ(e,t){let i=t instanceof eI?t:new eI(t),n=e,r=eT(i);for(;null!==r;){let e=(0,_.yw)(n.node.children,r)||{children:{},childCount:0};n=new iY(r,n,e),r=eT(i=eN(i))}return n}function iJ(e){return e.node.value}function iZ(e,t){e.node.value=t,function e(t){null!==t.parent&&function(t,i,n){let r=void 0===iJ(n)&&!iX(n),s=(0,_.gR)(t.node.children,i);r&&s?(delete t.node.children[i],t.node.childCount--,e(t)):r||s||(t.node.children[i]=n.node,t.node.childCount++,e(t))}(t.parent,t.name,t)}(e)}function iX(e){return e.node.childCount>0}function i0(e,t){Y(e.node.children,(i,n)=>{t(new iY(i,e,n))})}function i1(e){return new eI(null===e.parent?e.name:i1(e.parent)+"/"+e.name)}let i2=/[\[\].#$\/\u0000-\u001F\u007F]/,i3=/[\[\].#$\u0000-\u001F\u007F]/,i4=function(e){return"string"==typeof e&&0!==e.length&&!i2.test(e)},i6=function(e){return"string"==typeof e&&0!==e.length&&!i3.test(e)},i8=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!q(e)||e&&"object"==typeof e&&(0,_.gR)(e,".sv")},i5=function(e,t,i,n){n&&void 0===t||i7((0,_.dI)(e,"value"),t,i)},i7=function(e,t,i){let n=i instanceof eI?new eU(i,e):i;if(void 0===t)throw Error(e+"contains undefined "+eq(n));if("function"==typeof t)throw Error(e+"contains a function "+eq(n)+" with contents = "+t.toString());if(q(t))throw Error(e+"contains "+t.toString()+" "+eq(n));if("string"==typeof t&&t.length>3495253.3333333335&&(0,_.OE)(t)>0xa00000)throw Error(e+"contains a string greater than 10485760 utf8 bytes "+eq(n)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let i=!1,r=!1;if(Y(t,(t,s)=>{if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(r=!0,!i4(t)))throw Error(e+" contains an invalid key ("+t+") "+eq(n)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(t),n.byteLength_+=(0,_.OE)(t),eH(n),i7(e,s,n);let o=n.parts_.pop();n.byteLength_-=(0,_.OE)(o),n.parts_.length>0&&(n.byteLength_-=1)}),i&&r)throw Error(e+' contains ".value" child '+eq(n)+" in addition to actual children.")}},i9=function(e,t){let i,n;for(i=0;i<t.length;i++){let r=eO(n=t[i]);for(let t=0;t<r.length;t++)if(".priority"===r[t]&&t===r.length-1);else if(!i4(r[t]))throw Error(e+"contains an invalid key ("+r[t]+") in path "+n.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(eL);let r=null;for(i=0;i<t.length;i++){if(n=t[i],null!==r&&eF(r,n))throw Error(e+"contains a path "+r.toString()+" that is ancestor of another path "+n.toString());r=n}},ne=function(e,t,i,n){if(n&&void 0===t)return;let r=(0,_.dI)(e,"values");if(!(t&&"object"==typeof t)||Array.isArray(t))throw Error(r+" must be an object containing the children to replace.");let s=[];Y(t,(e,t)=>{let n=new eI(e);if(i7(r,t,eP(i,n)),".priority"===eR(n)&&!i8(t))throw Error(r+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(n)}),i9(r,s)},nt=function(e,t,i){if(!i||void 0!==t){if(q(t))throw Error(errorPrefix(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!i8(t))throw Error(errorPrefix(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ni=function(e,t,i,n){if((!n||void 0!==i)&&!i6(i))throw Error((0,_.dI)(e,t)+'was an invalid path = "'+i+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},nn=function(e,t,i,n){i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),ni(e,t,i,n)},nr=function(e,t){if(".info"===eT(t))throw Error(e+" failed = Can't modify data under /.info/")},ns=function(e,t){var i;let n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!i4(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&((i=n)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),!i6(i)))throw Error((0,_.dI)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class no{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function na(e,t){let i=null;for(let n=0;n<t.length;n++){let r=t[n],s=r.getPath();null===i||eM(s,i.path)||(e.eventLists_.push(i),i=null),null===i&&(i={events:[],path:s}),i.events.push(r)}i&&e.eventLists_.push(i)}function nl(e,t,i){na(e,i),nc(e,e=>eM(e,t))}function nh(e,t,i){na(e,i),nc(e,e=>eF(e,t)||eF(t,e))}function nc(e,t){e.recursionDepth_++;let i=!0;for(let n=0;n<e.eventLists_.length;n++){let r=e.eventLists_[n];r&&(t(r.path)?(function(e){for(let t=0;t<e.events.length;t++){let i=e.events[t];if(null!==i){e.events[t]=null;let n=i.getEventRunner();A&&D("event: "+i.toString()),X(n)}}}(e.eventLists_[n]),e.eventLists_[n]=null):i=!1)}i&&(e.eventLists_=[]),e.recursionDepth_--}class nu{constructor(e,t,i,n){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new no,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=tC(),this.transactionQueueTree_=new iY,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function nd(e){var t;return(t=t={timestamp:function(e){let t=e.infoData_.getNode(new eI(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}(e)}).timestamp=t.timestamp||new Date().getTime(),t}function np(e,t,i,n,r){e.dataUpdateCount++;let s=new eI(t);i=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,i):i;let o=[];if(r)if(n){let t=(0,_.kH)(i,e=>ti(e));o=function(e,t,i,n){let r=iF(e,n);if(!r)return[];{let n=iU(r),s=n.path,o=n.queryId,a=eD(s,t),l=tW.fromObject(i);return iH(e,s,new tP(tN(o),a,l))}}(e.serverSyncTree_,s,t,r)}else{let t=ti(i);o=iO(e.serverSyncTree_,s,t,r)}else if(n){let t=(0,_.kH)(i,e=>ti(e));o=function(e,t,i){let n=tW.fromObject(i);return ix(e,new tP(tk(),t,n))}(e.serverSyncTree_,s,t)}else{let t=ti(i);o=iN(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=nw(e,s)),nh(e.eventQueue_,a,o)}function nf(e,t){n_(e,"connected",t),!1===t&&function(e){ny(e,"onDisconnectEvents");let t=nd(e),i=tC();tb(e.onDisconnect_,eS(),(n,r)=>{let s=iK(n,r,e.serverSyncTree_,t);tw(i,n,s)});let n=[];tb(i,eS(),(t,i)=>{n=n.concat(iN(e.serverSyncTree_,t,i));let r=nT(e,t);nw(e,r)}),e.onDisconnect_=tC(),nh(e.eventQueue_,eS(),n)}(e)}function n_(e,t,i){let n=new eI("/.info/"+t),r=ti(i);e.infoData_.updateSnapshot(n,r);let s=iN(e.infoSyncTree_,n,r);nh(e.eventQueue_,n,s)}function ng(e){return e.nextWriteId_++}function nm(e,t,i,n){let r=ti(i);e.server_.onDisconnectPut(t.toString(),r.val(!0),(i,s)=>{"ok"===i&&tw(e.onDisconnect_,t,r),nE(e,n,i,s)})}function nv(e,t,i){let n;n=".info"===eT(t._path)?iR(e.infoSyncTree_,t,i):iR(e.serverSyncTree_,t,i),nl(e.eventQueue_,t._path,n)}function ny(e,...t){let i="";e.persistentConnection_&&(i=e.persistentConnection_.id+":"),D(i,...t)}function nE(e,t,i,n){t&&X(()=>{if("ok"===i)t(null);else{let e=(i||"error").toUpperCase(),r=e;n&&(r+=": "+n);let s=Error(r);s.code=e,t(s)}})}function nC(e,t,i){return iP(e.serverSyncTree_,t,i)||e9.EMPTY_NODE}function nw(e,t){let i=nb(e,t),n=i1(i),r=nI(e,i);return function(e,t,i){if(0===t.length)return;let n=[],r=[],s=t.filter(e=>0===e.status).map(e=>e.currentWriteId);for(let o=0;o<t.length;o++){let a=t[o],l=eD(i,a.path),h=!1,c;if((0,_.vA)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===a.status)h=!0,c=a.abortReason,r=r.concat(ik(e.serverSyncTree_,a.currentWriteId,!0));else if(0===a.status)if(a.retryCount>=25)h=!0,c="maxretry",r=r.concat(ik(e.serverSyncTree_,a.currentWriteId,!0));else{let i=nC(e,a.path,s);a.currentInputSnapshot=i;let n=t[o].update(i.val());if(void 0!==n){i7("transaction failed: Data returned ",n,a.path);let t=ti(n);"object"==typeof n&&null!=n&&(0,_.gR)(n,".priority")||(t=t.updatePriority(i.getPriority()));let o=a.currentWriteId,l=i$(t,i,nd(e));a.currentOutputSnapshotRaw=t,a.currentOutputSnapshotResolved=l,a.currentWriteId=ng(e),s.splice(s.indexOf(o),1),r=(r=r.concat(iT(e.serverSyncTree_,a.path,l,a.currentWriteId,a.applyLocally))).concat(ik(e.serverSyncTree_,o,!0))}else h=!0,c="nodata",r=r.concat(ik(e.serverSyncTree_,a.currentWriteId,!0))}nh(e.eventQueue_,i,r),r=[],h&&(t[o].status=2,setTimeout(t[o].unwatcher,Math.floor(0)),t[o].onComplete&&("nodata"===c?n.push(()=>t[o].onComplete(null,!1,t[o].currentInputSnapshot)):n.push(()=>t[o].onComplete(Error(c),!1,null))))}nS(e,e.transactionQueueTree_);for(let e=0;e<n.length;e++)X(n[e]);!function e(t,i=t.transactionQueueTree_){if(i||nS(t,i),iJ(i)){let n=nI(t,i);(0,_.vA)(n.length>0,"Sending zero length transaction queue"),n.every(e=>0===e.status)&&function(t,i,n){let r=nC(t,i,n.map(e=>e.currentWriteId)),s=r,o=r.hash();for(let e=0;e<n.length;e++){let t=n[e];(0,_.vA)(0===t.status,"tryToSendTransactionQueue_: items in queue should all be run."),t.status=1,t.retryCount++;let r=eD(i,t.path);s=s.updateChild(r,t.currentOutputSnapshotRaw)}let a=s.val(!0);t.server_.put(i.toString(),a,r=>{ny(t,"transaction put response",{path:i.toString(),status:r});let s=[];if("ok"===r){let r=[];for(let e=0;e<n.length;e++)n[e].status=2,s=s.concat(ik(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&r.push(()=>n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)),n[e].unwatcher();nS(t,iQ(t.transactionQueueTree_,i)),e(t,t.transactionQueueTree_),nh(t.eventQueue_,i,s);for(let e=0;e<r.length;e++)X(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{U("transaction at "+i.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}nw(t,i)}},o)}(t,i1(i),n)}else iX(i)&&i0(i,i=>{e(t,i)})}(e,e.transactionQueueTree_)}(e,r,n),n}function nb(e,t){let i,n=e.transactionQueueTree_;for(i=eT(t);null!==i&&void 0===iJ(n);)n=iQ(n,i),i=eT(t=eN(t));return n}function nI(e,t){let i=[];return function e(t,i,n){let r=iJ(i);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);i0(i,i=>{e(t,i,n)})}(e,t,i),i.sort((e,t)=>e.order-t.order),i}function nS(e,t){let i=iJ(t);if(i){let e=0;for(let t=0;t<i.length;t++)2!==i[t].status&&(i[e]=i[t],e++);i.length=e,iZ(t,i.length>0?i:void 0)}i0(t,t=>{nS(e,t)})}function nT(e,t){let i=i1(nb(e,t)),n=iQ(e.transactionQueueTree_,t);return!function(e,t,i){let n=e.parent;for(;null!==n;){if(t(n))return!0;n=n.parent}}(n,t=>{nk(e,t)}),nk(e,n),!function e(t,i,n,r){n&&!r&&i(t),i0(t,t=>{e(t,i,!0,r)}),n&&r&&i(t)}(n,t=>{nk(e,t)}),i}function nk(e,t){let i=iJ(t);if(i){let n=[],r=[],s=-1;for(let t=0;t<i.length;t++)3===i[t].status||(1===i[t].status?((0,_.vA)(s===t-1,"All SENT items should be at beginning of queue."),s=t,i[t].status=3,i[t].abortReason="set"):((0,_.vA)(0===i[t].status,"Unexpected transaction status in abort"),i[t].unwatcher(),r=r.concat(ik(e.serverSyncTree_,i[t].currentWriteId,!0)),i[t].onComplete&&n.push(i[t].onComplete.bind(null,Error("set"),!1,null))));-1===s?iZ(t,void 0):i.length=s+1,nh(e.eventQueue_,i1(t),r);for(let e=0;e<n.length;e++)X(n[e])}}let nN=function(e,t){let i=nR(e),n=i.namespace;"firebase.com"===i.domain&&F(i.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!==n||"localhost"===i.domain||F("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),i.secure||H();let r="ws"===i.scheme||"wss"===i.scheme;return{repoInfo:new et(i.host,i.secure,n,r,t,"",n!==i.subdomain),path:new eI(i.pathString)}},nR=function(e){let t="",i="",n="",r="",s="",o=!0,a="https",l=443;if("string"==typeof e){let h=e.indexOf("//");h>=0&&(a=e.substring(0,h-1),e=e.substring(h+2));let c=e.indexOf("/");-1===c&&(c=e.length);let u=e.indexOf("?");-1===u&&(u=e.length),t=e.substring(0,Math.min(c,u)),c<u&&(r=function(e){let t="",i=e.split("/");for(let e=0;e<i.length;e++)if(i[e].length>0){let n=i[e];try{n=decodeURIComponent(n.replace(/\+/g," "))}catch(e){}t+="/"+n}return t}(e.substring(c,u)));let d=function(e){let t={};for(let i of("?"===e.charAt(0)&&(e=e.substring(1)),e.split("&"))){if(0===i.length)continue;let n=i.split("=");2===n.length?t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):U(`Invalid query segment '${i}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,u)));(h=t.indexOf(":"))>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(h+1),10)):h=t.length;let p=t.slice(0,h);if("localhost"===p.toLowerCase())i="localhost";else if(p.split(".").length<=2)i=p;else{let e=t.indexOf(".");n=t.substring(0,e).toLowerCase(),i=t.substring(e+1),s=n}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:i,subdomain:n,secure:o,scheme:a,pathString:r,namespace:s}},nO="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";(function(){let e=0,t=[];})();class nA{constructor(e,t,i,n){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=n}getPath(){let e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,_.As)(this.snapshot.exportVal())}}class nP{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class nx{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,_.vA)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class nD{constructor(e,t,i,n){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=n}get key(){return ex(this._path)?null:eR(this._path)}get ref(){return new nU(this._repo,this._path)}get _queryIdentifier(){let e=$(tv(this._queryParams));return"{}"===e?"default":e}get _queryObject(){return tv(this._queryParams)}isEqual(e){if(!((e=(0,_.Ku)(e))instanceof nD))return!1;let t=this._repo===e._repo,i=eM(this._path,e._path),n=this._queryIdentifier===e._queryIdentifier;return t&&i&&n}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let i=e.pieceNum_;i<e.pieces_.length;i++)""!==e.pieces_[i]&&(t+="/"+encodeURIComponent(String(e.pieces_[i])));return t||"/"}(this._path)}}function nL(e,t){if(!0===e._orderByCalled)throw Error(t+": You can't combine multiple orderBy calls.")}function nM(e){let t=null,i=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(i=e.getIndexEndValue()),e.getIndex()===eK){let n="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==W)throw Error(n);if("string"!=typeof t)throw Error(r)}if(e.hasEnd()){if(e.getIndexEndName()!==j)throw Error(n);if("string"!=typeof i)throw Error(r)}}else if(e.getIndex()===e3){if(null!=t&&!i8(t)||null!=i&&!i8(i))throw Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,_.vA)(e.getIndex()instanceof tn||e.getIndex()===ts,"unknown index type."),null!=t&&"object"==typeof t||null!=i&&"object"==typeof i)throw Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function nF(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class nU extends nD{constructor(e,t){super(e,t,new tp,!1)}get parent(){let e=eA(this._path);return null===e?null:new nU(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class nH{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new eI(e),i=nB(this.ref,e);return new nH(this._node.getChild(t),i,e3)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(t,i)=>e(new nH(i,nB(this.ref,t),e3)))}hasChild(e){let t=new eI(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function nq(e,t){return(e=(0,_.Ku)(e))._checkNotDeleted("ref"),void 0!==t?nB(e._root,t):e._root}function nB(e,t){return null===eT((e=(0,_.Ku)(e))._path)?nn("child","path",t,!1):ni("child","path",t,!1),new nU(e._repo,eP(e._path,t))}function nW(e,t){nr("set",(e=(0,_.Ku)(e))._path),i5("set",t,e._path,!1);let i=new _.cY;return function(e,t,i,n,r){ny(e,"set",{path:t.toString(),value:i,priority:null});let s=nd(e),o=ti(i,n),a=i$(o,iP(e.serverSyncTree_,t),s),l=ng(e),h=iT(e.serverSyncTree_,t,a,l,!0);na(e.eventQueue_,h),e.server_.put(t.toString(),o.val(!0),(i,n)=>{let s="ok"===i;s||U("set at "+t+" failed: "+i);let o=ik(e.serverSyncTree_,l,!s);nh(e.eventQueue_,t,o),nE(e,r,i,n)});let c=nT(e,t);nw(e,c),nh(e.eventQueue_,c,[])}(e._repo,e._path,t,null,i.wrapCallback(()=>{})),i.promise}function nj(e,t){ne("update",t,e._path,!1);let i=new _.cY;return!function(e,t,i,n){ny(e,"update",{path:t.toString(),value:i});let r=!0,s=nd(e),o={};if(Y(i,(i,n)=>{r=!1,o[i]=iK(eP(t,i),ti(n),e.serverSyncTree_,s)}),r)D("update() called with empty data.  Don't do anything."),nE(e,n,"ok",void 0);else{let r=ng(e),s=function(e,t,i,n){var r;r=e.pendingWriteTree_,(0,_.vA)(n>r.lastWriteId,"Stacking an older merge on top of newer ones"),r.allWrites.push({path:t,children:i,writeId:n,visible:!0}),r.visibleWrites=tz(r.visibleWrites,t,i),r.lastWriteId=n;let s=tW.fromObject(i);return ix(e,new tP(tT(),t,s))}(e.serverSyncTree_,t,o,r);na(e.eventQueue_,s),e.server_.merge(t.toString(),i,(i,s)=>{let o="ok"===i;o||U("update at "+t+" failed: "+i);let a=ik(e.serverSyncTree_,r,!o),l=a.length>0?nw(e,t):t;nh(e.eventQueue_,l,a),nE(e,n,i,s)}),Y(i,i=>{let n=nT(e,eP(t,i));nw(e,n)}),nh(e.eventQueue_,t,[])}}(e._repo,e._path,t,i.wrapCallback(()=>{})),i.promise}function nV(e){e=(0,_.Ku)(e);let t=new nz(new nx(()=>{}));return(function(e,t,i){let n=function(e,t){var i;let n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(e,t)=>{let i=eD(e,n);r=r||iE(t,i)});let s=e.syncPointTree_.get(n);s?r=r||iE(s,eS()):(s=new ig,e.syncPointTree_=e.syncPointTree_.set(n,s));let o=null!=r,a=o?new tx(r,!0,!1):null,l=(i=e.pendingWriteTree_,t7(t._path,i));return tH(iv(s,t,l,o?a.getNode():e9.EMPTY_NODE,o).viewCache_)}(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then(n=>{let r,s=ti(n).withIndex(t._queryParams.getIndex());if(iA(e.serverSyncTree_,t,i,!0),t._queryParams.loadsAllData())r=iN(e.serverSyncTree_,t._path,s);else{let i=iL(e.serverSyncTree_,t);r=iO(e.serverSyncTree_,t._path,s,i)}return nh(e.eventQueue_,t._path,r),iR(e.serverSyncTree_,t,i,null,!0),s},i=>(ny(e,"get for query "+(0,_.As)(t)+" failed: "+i),Promise.reject(Error(i))))})(e._repo,e,t).then(t=>new nH(t,new nU(e._repo,e._path),e._queryParams.getIndex()))}class nz{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){let i=t._queryParams.getIndex();return new nA("value",this,new nH(e.snapshotNode,new nU(t._repo,t._path),i))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new nP(this,e,t):null}matches(e){return e instanceof nz&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class nK{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new nP(this,e,t):null}createEvent(e,t){(0,_.vA)(null!=e.childName,"Child events should have a childName.");let i=nB(new nU(t._repo,t._path),e.childName),n=t._queryParams.getIndex();return new nA(e.type,this,new nH(e.snapshotNode,i,n),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof nK&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function n$(e,t,i,n){return function(e,t,i,n,r){var s;let o,a;if("object"==typeof n&&(o=void 0,r=n),"function"==typeof n&&(o=n),r&&r.onlyOnce){let t=i,n=(i,n)=>{nv(e._repo,e,h),t(i,n)};n.userCallback=i.userCallback,n.context=i.context,i=n}let l=new nx(i,o||void 0),h="value"===t?new nz(l):new nK(t,l);return s=e._repo,a=".info"===eT(e._path)?iA(s.infoSyncTree_,e,h):iA(s.serverSyncTree_,e,h),nl(s.eventQueue_,e._path,a),()=>nv(e._repo,e,h)}(e,"value",t,i,n)}class nG{}class nY extends nG{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){i5("endAt",this._value,e._path,!0);let t=t_(e._queryParams,this._value,this._key);if(nF(t),nM(t),e._queryParams.hasEnd())throw Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new nD(e._repo,e._path,t,e._orderByCalled)}}class nQ extends nG{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){i5("startAt",this._value,e._path,!0);let t=tf(e._queryParams,this._value,this._key);if(nF(t),nM(t),e._queryParams.hasStart())throw Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new nD(e._repo,e._path,t,e._orderByCalled)}}(0,_.vA)(!u,"__referenceConstructor has already been defined"),u=nU,(0,_.vA)(!d,"__referenceConstructor has already been defined"),d=nU;let nJ={};class nZ{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(!function(e,t,i){if(e.stats_=eo(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new ty(e.repoInfo_,(t,i,n,r)=>{np(e,t,i,n,r)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>nf(e,!0),0);else{if(null!=i){if("object"!=typeof i)throw Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,_.As)(i)}catch(e){throw Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new eW(e.repoInfo_,t,(t,i,n,r)=>{np(e,t,i,n,r)},t=>{nf(e,t)},t=>{var i;i=e,Y(t,(e,t)=>{n_(i,e,t)})},e.authTokenProvider_,e.appCheckProvider_,i),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(t=>{e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(t=>{e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){let i=e.toString();return es[i]||(es[i]=t()),es[i]}(e.repoInfo_,()=>new tS(e.stats_,e.server_)),e.infoData_=new tE,e.infoSyncTree_=new iS({startListening:(t,i,n,r)=>{let s=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=iN(e.infoSyncTree_,t._path,o),setTimeout(()=>{r("ok")},0)),s},stopListening:()=>{}}),n_(e,"connected",!1),e.serverSyncTree_=new iS({startListening:(t,i,n,r)=>(e.server_.listen(t,n,i,(i,n)=>{let s=r(i,n);nh(e.eventQueue_,t._path,s)}),[]),stopListening:(t,i)=>{e.server_.unlisten(t,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new nU(this._repo,eS())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){var i;let n=nJ[t];n&&n[e.key]===e||F(`Database ${t}(${e.repoInfo_}) has already been deleted.`),(i=e).persistentConnection_&&i.persistentConnection_.interrupt("repo_interrupt"),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&F("Cannot call "+e+" on a deleted database.")}}function nX(e=(0,m.Sx)(),t){let i=(0,m.j6)(e,"database").getImmediate({identifier:t});if(!i._instanceStarted){let e=(0,_.yU)("database");e&&function(e,t,i,n={}){let r;(e=(0,_.Ku)(e))._checkNotDeleted("useEmulator");let s=`${t}:${i}`,o=e._repoInternal;if(e._instanceStarted){if(s===e._repoInternal.repoInfo_.host&&(0,_.bD)(n,o.repoInfo_.emulatorOptions))return;F("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}o.repoInfo_.nodeAdmin?(n.mockUserToken&&F('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new ef(ef.OWNER)):n.mockUserToken&&(r=new ef("string"==typeof n.mockUserToken?n.mockUserToken:(0,_.Fy)(n.mockUserToken,e.app.options.projectId))),(0,_.zJ)(t)&&((0,_.gE)(t),(0,_.P1)("Database",!0));var a=r;let l=s.lastIndexOf(":"),h=s.substring(0,l);o.repoInfo_=new et(s,(0,_.zJ)(h),o.repoInfo_.namespace,o.repoInfo_.webSocketOnly,o.repoInfo_.nodeAdmin,o.repoInfo_.persistenceKey,o.repoInfo_.includeNamespaceInQueryParams,!0,n),a&&(o.authTokenProvider_=a)}(i,...e)}return i}eW.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},eW.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},el=f.Client;ea=m.MF,(0,m.om)(new v.uA("database",(e,{instanceIdentifier:t})=>{let i=e.getProvider("app").getImmediate();return function(e,t,i,n,r){var s,o,a,l;let h,c,u,d,p=n||e.options.databaseURL;void 0===p&&(e.options.projectId||F("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),D("Using default host for project ",e.options.projectId),p=`${e.options.projectId}-default-rtdb.firebaseio.com`);let f=nN(p,void 0),_=f.repoInfo;"undefined"!=typeof process&&process.env&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(d=!0,_=(f=nN(p=`http://${u}?ns=${_.namespace}`,r)).repoInfo):d=!f.repoInfo.secure;let g=r&&d?new ef(ef.OWNER):new ep(e.name,e.options,t);return ns("Invalid Firebase Database URL",f),ex(f.path)||F("Database URL must point to the root of a Firebase Database (not including a child path)."),new nZ((s=_,o=e,a=g,l=new ed(e,i),(h=nJ[o.name])||(h={},nJ[o.name]=h),(c=h[s.toURLString()])&&F("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),c=new nu(s,!1,a,l),h[s.toURLString()]=c,c),e)}(i,e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)},"PUBLIC").setMultipleInstances(!0)),(0,m.KO)(ec,eu,"node"),(0,m.KO)(ec,eu,"esm2017")},90654:(e,t,i)=>{"use strict";var n=i(90380),r=function(e,t){this._session=e,this._method=t,this._queue=new n(r.QUEUE_SIZE),this._stopped=!1,this.pending=0};r.QUEUE_SIZE=8,r.prototype.call=function(e,t,i,n){if(!this._stopped){var r={error:e,message:t,callback:i,context:n,done:!1},s=!1,o=this;if(this._queue.push(r),r.error)return r.done=!0,this._stop(),this._flushQueue();var a=function(e,t){s^(s=!0)&&(e?(o._stop(),r.error=e,r.message=null):r.message=t,r.done=!0,o._flushQueue())};try{this._session[this._method](t,a)}catch(e){a(e)}}},r.prototype._stop=function(){this.pending=this._queue.length,this._stopped=!0},r.prototype._flushQueue=function(){for(var e,t=this._queue;t.length>0&&t.peek().done;)(e=t.shift()).error?(this.pending=0,t.clear()):this.pending-=1,e.callback.call(e.context,e.error,e.message)},e.exports=r},92139:(e,t,i)=>{"use strict";var n=i(27910).Stream,r=i(28354),s=i(74366),o=i(37030),a=i(64492),l=function(e){e=e||{},s.validateOptions(e,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var t=e.headers;if(t)for(var i in t)this._driver.setHeader(i,t[i]);var n=e.extensions;n&&[].concat(n).forEach(this._driver.addExtension,this._driver),this._ping=e.ping,this._pingId=0,this.readyState=l.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var r=this;this._driver.on("open",function(e){r._open()}),this._driver.on("message",function(e){r._receiveMessage(e.data)}),this._driver.on("close",function(e){r._beginClose(e.reason,e.code)}),this._driver.on("error",function(e){r._emitError(e.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){r.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){r._pingId+=1,r.ping(r._pingId.toString())},1e3*this._ping)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};r.inherits(l,n),l.CONNECTING=0,l.OPEN=1,l.CLOSING=2,l.CLOSED=3,l.CLOSE_TIMEOUT=3e4;var h={write:function(e){return this.send(e)},end:function(e){void 0!==e&&this.send(e),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(e){return!(this.readyState>l.OPEN)&&(e instanceof Buffer||(e=String(e)),this._driver.messages.write(e))},ping:function(e,t){return!(this.readyState>l.OPEN)&&this._driver.ping(e,t)},close:function(e,t){if(void 0===e&&(e=1e3),void 0===t&&(t=""),1e3!==e&&(e<3e3||e>4999))throw Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+e+" is neither.");if(this.readyState<l.CLOSING){var i=this;this._closeTimer=setTimeout(function(){i._beginClose("",1006)},l.CLOSE_TIMEOUT)}this.readyState!==l.CLOSED&&(this.readyState=l.CLOSING),this._driver.close(t,e)},_configureStream:function(){var e=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(t){this._stream.on(t,function(){e._finalizeClose()})},this),this._stream.on("error",function(t){e._emitError("Network error: "+e.url+": "+t.message),e._finalizeClose()})},_open:function(){if(this.readyState===l.CONNECTING){this.readyState=l.OPEN,this.protocol=this._driver.protocol||"";var e=new a("open");e.initEvent("open",!1,!1),this.dispatchEvent(e)}},_receiveMessage:function(e){if(this.readyState>l.OPEN)return!1;this.readable&&this.emit("data",e);var t=new a("message",{data:e});t.initEvent("message",!1,!1),this.dispatchEvent(t)},_emitError:function(e){if(!(this.readyState>=l.CLOSING)){var t=new a("error",{message:e});t.initEvent("error",!1,!1),this.dispatchEvent(t)}},_beginClose:function(e,t){this.readyState!==l.CLOSED&&(this.readyState=l.CLOSING,this._closeParams=[e,t],this._stream&&(this._stream.destroy(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==l.CLOSED){this.readyState=l.CLOSED,this._closeTimer&&clearTimeout(this._closeTimer),this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var e=this._closeParams?this._closeParams[0]:"",t=new a("close",{code:this._closeParams?this._closeParams[1]:1006,reason:e});t.initEvent("close",!1,!1),this.dispatchEvent(t)}}};for(var c in h)l.prototype[c]=h[c];for(var u in o)l.prototype[u]=o[u];e.exports=l},93841:(e,t,i)=>{"use strict";var n=i(90654),r=i(70376),s=function(e){this._ext=e[0],this._session=e[1],this._functors={incoming:new n(this._session,"processIncomingMessage"),outgoing:new n(this._session,"processOutgoingMessage")}};s.prototype.pending=function(e){var t=this._functors[e];t._stopped||(t.pending+=1)},s.prototype.incoming=function(e,t,i,n){this._exec("incoming",e,t,i,n)},s.prototype.outgoing=function(e,t,i,n){this._exec("outgoing",e,t,i,n)},s.prototype.close=function(){return this._closed=this._closed||new r,this._doClose(),this._closed},s.prototype._exec=function(e,t,i,n,r){this._functors[e].call(t,i,function(e,t){e&&(e.message=this._ext.name+": "+e.message),n.call(r,e,t),this._doClose()},this)},s.prototype._doClose=function(){var e=this._functors.incoming,t=this._functors.outgoing;this._closed&&e.pending+t.pending===0&&(this._session&&this._session.close(),this._session=null,this._closed.done())},e.exports=s}};