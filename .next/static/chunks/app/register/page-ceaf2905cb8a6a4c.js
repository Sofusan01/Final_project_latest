(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{2099:(e,t,s)=>{"use strict";s.d(t,{ND:()=>a,qc:()=>n});let a=(0,s(4982).UU)("https://filyujdgxtjoqkebvegb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZpbHl1amRneHRqb3FrZWJ2ZWdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTk1NjAsImV4cCI6MjA2NjMzNTU2MH0.2-CROlvK_eQYoIvI9PqRRmLGOfLD2TQnsQfwMAyxJ0k",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),r={ADMIN:"admin"},n=e=>e===r.ADMIN},3460:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(5155),r=s(2115),n=s(6874),i=s.n(n);function l(e){let{type:t,onSubmit:s,loading:n,hideHeader:l=!1,hideLinks:d=!1}=e,[c,o]=(0,r.useState)(""),[m,u]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[p,f]=(0,r.useState)(""),[N,g]=(0,r.useState)(""),[b,j]=(0,r.useState)({}),v=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),w=e=>e.length>=6,y=()=>{let e={};return c.trim()?v(c)||(e.email="รูปแบบอีเมลไม่ถูกต้อง"):e.email="กรุณากรอกอีเมล",m.trim()?w(m)||(e.password="รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร"):e.password="กรุณากรอกรหัสผ่าน","register"===t&&(p.trim()||(e.firstName="กรุณากรอกชื่อ"),N.trim()||(e.lastName="กรุณากรอกนามสกุล"),x.trim()?m!==x&&(e.confirmPassword="รหัสผ่านไม่ตรงกัน"):e.confirmPassword="กรุณายืนยันรหัสผ่าน"),j(e),0===Object.keys(e).length},I=async e=>{e.preventDefault(),y()&&await s(c,m,p,N)};return(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsxs)("form",{onSubmit:I,className:"flex flex-col gap-6 w-full max-w-md card p-8 animate-scale-in",children:[!l&&(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-heading mb-3",children:"login"===t?"Welcome Back":"Create Account"}),(0,a.jsx)("p",{className:"text-body text-base font-medium",children:"login"===t?"Sign in to your account":"Join our plant monitoring system"})]}),"register"===t&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"text",className:"input ".concat(b.firstName?"border-red-500":""),placeholder:"First Name",value:p,onChange:e=>f(e.target.value),required:!0}),b.firstName&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:b.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"text",className:"input ".concat(b.lastName?"border-red-500":""),placeholder:"Last Name",value:N,onChange:e=>g(e.target.value),required:!0}),b.lastName&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:b.lastName})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"email",autoComplete:"username",className:"input ".concat(b.email?"border-red-500":""),placeholder:"Email Address",value:c,onChange:e=>o(e.target.value),disabled:n,required:!0}),b.email&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:b.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"password",autoComplete:"login"===t?"current-password":"new-password",className:"input ".concat(b.password?"border-red-500":""),placeholder:"Password",value:m,onChange:e=>u(e.target.value),disabled:n,required:!0,minLength:6}),b.password&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:b.password})]}),"register"===t&&(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"password",autoComplete:"new-password",className:"input ".concat(b.confirmPassword?"border-red-500":""),placeholder:"Confirm Password",value:x,onChange:e=>h(e.target.value),disabled:n,required:!0}),b.confirmPassword&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:b.confirmPassword})]}),(0,a.jsx)("button",{type:"submit",disabled:n,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:n?"Processing...":"login"===t?"Sign In":"Create Account"})]}),!d&&(0,a.jsx)(a.Fragment,{children:"login"===t?(0,a.jsxs)("div",{className:"text-center mt-8 text-muted",children:["Don't have an account?"," ",(0,a.jsx)(i(),{href:"/register",className:"text-neutral-900 hover:text-neutral-700 underline font-semibold transition-colors duration-200",children:"Sign up"})]}):(0,a.jsxs)("div",{className:"text-center mt-8 text-muted",children:["Already have an account?"," ",(0,a.jsx)(i(),{href:"/login",className:"text-neutral-900 hover:text-neutral-700 underline font-semibold transition-colors duration-200",children:"Sign in"})]})})]})}},4751:(e,t,s)=>{Promise.resolve().then(s.bind(s,6616))},6616:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(5155),r=s(2115),n=s(5695),i=s(2099),l=s(3460);let d=e=>{if(e instanceof Error)return e.message;if("object"==typeof e&&e&&"message"in e){let t=e.message;return"string"==typeof t?t:""}return""};function c(){let[e,t]=(0,r.useState)(!1),[s,c]=(0,r.useState)(null),o=(0,n.useRouter)();(0,r.useEffect)(()=>{(async()=>{let{data:{session:e}}=await i.ND.auth.getSession();e&&o.replace("/dashboard")})()},[o]);let m=async e=>{try{let{data:t,error:s}=await i.ND.from("profiles").select("id").eq("email",e).single();return!s&&null!==t}catch(e){return!1}},u=async(e,s,a,r)=>{try{if(t(!0),c(null),await m(e))return void c("อีเมลนี้มีอยู่ในระบบแล้ว กรุณาใช้อีเมลอื่น");let{data:n,error:l}=await i.ND.auth.signUp({email:e,password:s,options:{data:{first_name:a||"",last_name:r||"",full_name:"".concat(a||""," ").concat(r||"").trim()}}});if(l)throw l;if(n.user){let{error:e}=await i.ND.from("profiles").insert({id:n.user.id,first_name:a||"",last_name:r||"",role:"user"});if(e)return void c("เกิดข้อผิดพลาดในการสร้างโปรไฟล์ กรุณาลองใหม่");c(null),alert("ลงทะเบียนสำเร็จ! กรุณาตรวจสอบอีเมลของคุณเพื่อยืนยันบัญชีก่อนเข้าสู่ระบบ"),o.replace("/login")}}catch(s){let e="เกิดข้อผิดพลาดในการลงทะเบียน",t=d(s);t&&(e=t.includes("User already registered")?"อีเมลนี้มีอยู่ในระบบแล้ว กรุณาใช้อีเมลอื่น":t.includes("Password should be at least")?"รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร":t.includes("Invalid email")?"กรุณากรอกอีเมลที่ถูกต้อง":t.includes("Signup is disabled")?"การลงทะเบียนถูกปิดใช้งานชั่วคราว":"เกิดข้อผิดพลาดในการลงทะเบียน กรุณาลองใหม่"),c(e)}finally{t(!1)}};return(0,a.jsx)("div",{className:"min-h-screen bg-neutral-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-neutral-900 mb-2",children:"Create Account"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Join our plant monitoring system"})]}),s&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:(0,a.jsx)("p",{className:"text-red-700 font-medium",children:s})}),(0,a.jsx)(l.A,{type:"register",onSubmit:u,loading:e,hideHeader:!0,hideLinks:!0}),(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsxs)("p",{className:"text-neutral-600",children:["Already have an account?"," ",(0,a.jsx)("a",{href:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[982,244,441,684,358],()=>t(4751)),_N_E=e.O()}]);