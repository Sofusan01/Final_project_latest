(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[706],{646:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1154:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2099:(e,t,s)=>{"use strict";s.d(t,{ND:()=>r,qc:()=>l});let r=(0,s(4982).UU)("https://filyujdgxtjoqkebvegb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZpbHl1amRneHRqb3FrZWJ2ZWdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTk1NjAsImV4cCI6MjA2NjMzNTU2MH0.2-CROlvK_eQYoIvI9PqRRmLGOfLD2TQnsQfwMAyxJ0k",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),a={ADMIN:"admin"},l=e=>e===a.ADMIN},5339:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},5695:(e,t,s)=>{"use strict";var r=s(8999);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},5888:(e,t,s)=>{Promise.resolve().then(s.bind(s,7528))},7528:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(5155),a=s(2115),l=s(5695),n=s(2099),i=s(7601),c=s(1154),d=s(7580),u=s(5339),o=s(646),m=s(9946);let x=(0,m.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),h=(0,m.A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),p=(e,t)=>{if(e instanceof Error)return e.message||t;if("object"==typeof e&&e&&"message"in e){let s=e.message;return"string"==typeof s?s:t}return t};function f(){let{user:e,userRole:t}=(0,i.s)(),s=(0,l.useRouter)(),[m,f]=(0,a.useState)([]),[y,N]=(0,a.useState)(!0),[j,g]=(0,a.useState)(""),[w,v]=(0,a.useState)(null),[b,k]=(0,a.useState)(null),[A,C]=(0,a.useState)(null);(0,a.useEffect)(()=>{t&&!(0,n.qc)(t)&&s.replace("/setting")},[t,s]),(0,a.useEffect)(()=>{(0,n.qc)(t)&&_()},[t]);let _=async()=>{try{N(!0);let{data:e,error:t}=await n.ND.from("profiles").select("id, first_name, last_name, role, created_at").order("created_at",{ascending:!1});if(t)throw t;f(e||[])}catch(e){k(p(e,"Failed to fetch users"))}finally{N(!1)}},S=async e=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{v(e),k(null);let{error:t}=await n.ND.from("profiles").delete().eq("id",e);if(t)throw t;f(t=>t.filter(t=>t.id!==e)),C("User deleted successfully"),setTimeout(()=>C(null),3e3)}catch(e){k(p(e,"Failed to delete user"))}finally{v(null)}},I=async(e,t)=>{try{k(null);let{error:s}=await n.ND.from("profiles").update({role:t}).eq("id",e);if(s)throw s;f(s=>s.map(s=>s.id===e?{...s,role:t}:s)),C("User role updated successfully"),setTimeout(()=>C(null),3e3)}catch(e){k(p(e,"Failed to update user role"))}},L=m.filter(e=>e.first_name.toLowerCase().includes(j.toLowerCase())||e.last_name.toLowerCase().includes(j.toLowerCase())||e.role.toLowerCase().includes(j.toLowerCase()));return t&&!(0,n.qc)(t)?null:y?(0,r.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,r.jsx)(c.A,{className:"w-8 h-8 animate-spin text-neutral-400"}),(0,r.jsx)("span",{className:"ml-3 text-neutral-500",children:"Loading users..."})]}):(0,r.jsxs)("div",{className:"w-full max-w-6xl mx-auto p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"bg-neutral-100 p-2 rounded-lg",children:(0,r.jsx)(d.A,{className:"w-6 h-6 text-neutral-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-heading",children:"User Management"}),(0,r.jsx)("p",{className:"text-muted",children:"Manage user accounts and roles (Admin Only)"})]})]}),b&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-center gap-2",children:[(0,r.jsx)(u.A,{className:"w-5 h-5 text-red-600"}),(0,r.jsx)("p",{className:"text-red-700 font-medium",children:b})]}),A&&(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-center gap-2",children:[(0,r.jsx)(o.A,{className:"w-5 h-5 text-green-600"}),(0,r.jsx)("span",{className:"text-green-700 font-medium",children:A})]}),(0,r.jsx)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(x,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Search users...",value:j,onChange:e=>g(e.target.value),className:"pl-10 pr-4 py-2 border border-neutral-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsxs)("span",{className:"text-sm text-neutral-500",children:[L.length," of ",m.length," users"]})]})}),(0,r.jsxs)("div",{className:"card overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"User"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Role"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Created"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-neutral-200",children:L.map(t=>(0,r.jsxs)("tr",{className:"hover:bg-neutral-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,r.jsx)("div",{className:"h-10 w-10 rounded-full bg-neutral-100 flex items-center justify-center",children:(0,r.jsxs)("span",{className:"text-sm font-medium text-neutral-600",children:[t.first_name.charAt(0),t.last_name.charAt(0)]})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsxs)("div",{className:"text-sm font-medium text-neutral-900",children:[t.first_name," ",t.last_name]}),(0,r.jsx)("div",{className:"text-sm text-neutral-500",children:t.role})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("select",{value:t.role,onChange:e=>I(t.id,e.target.value),className:"text-sm border border-neutral-200 rounded-md px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:t.id===(null==e?void 0:e.id),children:[(0,r.jsx)("option",{value:"admin",children:"Admin"}),(0,r.jsx)("option",{value:"user",children:"User"})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-neutral-500",children:new Date(t.created_at).toLocaleDateString()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("button",{onClick:()=>S(t.id),disabled:t.id===(null==e?void 0:e.id)||w===t.id,className:"text-red-600 hover:text-red-900 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:t.id===(null==e?void 0:e.id)?"Cannot delete your own account":"Delete user",children:[w===t.id?(0,r.jsx)(c.A,{className:"w-4 h-4 animate-spin"}):(0,r.jsx)(h,{className:"w-4 h-4"}),"Delete"]})})]},t.id))})]})}),0===L.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(d.A,{className:"w-12 h-12 text-neutral-300 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-neutral-900 mb-2",children:"No users found"}),(0,r.jsx)("p",{className:"text-neutral-500",children:j?'No users match "'.concat(j,'"'):"No users have been registered yet"})]})]})]})}},7580:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},7601:(e,t,s)=>{"use strict";s.d(t,{s:()=>n});var r=s(2115),a=s(2099),l=s(5695);function n(){let[e,t]=(0,r.useState)(null),[s,n]=(0,r.useState)(!0),[i,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(null),[o,m]=(0,r.useState)(null),x=(0,l.useRouter)(),h=(0,r.useCallback)(async()=>{try{await a.ND.auth.signOut(),localStorage.clear(),sessionStorage.clear(),x.push("/login")}catch(e){console.error("Logout error:",e)}},[x]),p=(0,r.useCallback)(async e=>{try{let{data:t}=await a.ND.from("profiles").select("role, first_name, last_name").eq("id",e).single();c((null==t?void 0:t.role)||"user"),u((null==t?void 0:t.first_name)||null),m((null==t?void 0:t.last_name)||null)}catch(e){c("user"),u(null),m(null)}},[]);return(0,r.useEffect)(()=>{(async()=>{let{data:{session:e}}=await a.ND.auth.getSession();if(null==e?void 0:e.user){t(e.user),n(!1),p(e.user.id);return}n(!1)})();let{data:{subscription:e}}=a.ND.auth.onAuthStateChange(async(e,s)=>{(null==s?void 0:s.user)?(t(s.user),n(!1),p(s.user.id)):(t(null),c(null),u(null),m(null),n(!1))});return()=>e.unsubscribe()},[p]),{user:e,loading:s,logout:h,userRole:i,firstName:d,lastName:o}}},9946:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var r=s(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),n=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,r.forwardRef)((e,t)=>{let{color:s="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:u="",children:o,iconNode:m,...x}=e;return(0,r.createElement)("svg",{ref:t,...d,width:a,height:a,stroke:s,strokeWidth:n?24*Number(l)/Number(a):l,className:i("lucide",u),...!o&&!c(x)&&{"aria-hidden":"true"},...x},[...m.map(e=>{let[t,s]=e;return(0,r.createElement)(t,s)}),...Array.isArray(o)?o:[o]])}),o=(e,t)=>{let s=(0,r.forwardRef)((s,l)=>{let{className:c,...d}=s;return(0,r.createElement)(u,{ref:l,iconNode:t,className:i("lucide-".concat(a(n(e))),"lucide-".concat(e),c),...d})});return s.displayName=n(e),s}}},e=>{var t=t=>e(e.s=t);e.O(0,[982,441,684,358],()=>t(5888)),_N_E=e.O()}]);